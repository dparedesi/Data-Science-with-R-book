# Individual Work 1 {-}

This individual work will evaluate the knowledge learned in units 1 and 2. Each question has the same score.
The answers are entirely R code. Save your file with the following format: firstname_lastname.R The code will be reviewed without considering comments.

## Unit I: R Fundamentals {-}
The planet's surface temperature increases as greenhouse gas emissions increase. This global warming and the disruption of the carbon cycle are causing havoc on natural systems.

1. Load the "temp_carbon" data frame from the "dslabs" library, which contains annual global temperature anomalies (difference from the 20th-century mean temperature in degrees Celsius), temperature anomalies over land and ocean, and global carbon emissions (in metric tons). Note that the date ranges differ for temperature and carbon emissions. Report the last year for which carbon emissions are reported (carbon_emissions column)

```{r eval=FALSE}
library(dslabs)
library(tidyverse)
data(temp_carbon)
```

```{r eval=TRUE}
# Solution 1:
temp_carbon |> 
  filter(!is.na(carbon_emissions)) |> 
  arrange(desc(year)) |> 
  summarize(max(year))
  
# Solution 2:
resultado <- temp_carbon |> 
  filter(!is.na(carbon_emissions)) |> 
  pull(year)

max(resultado)
```

2. How many records do not have data in the `temp_anomaly` field?

```{r eval=TRUE}
# Solution 1:
sum(is.na(temp_carbon$temp_anomaly))

# Solution 2:
temp_carbon |> 
  filter(is.na(temp_anomaly)) |> 
  summarize(cantidad = n())

# Solution 3:
temp_carbon |> 
  filter(is.na(temp_anomaly)) |> 
  count()

# Solution 4:
resultados <- temp_carbon |> 
  filter(is.na(temp_anomaly))

nrow(resultados)

# Solution 5: unnecessarily long solution
sum((sapply(temp_carbon$temp_anomaly, function(x) sum(is.na(x)))))
```

3. Using the "plot()" function, create a scatter plot with the variables temp_anomaly and carbon_emissions.

```{r eval=TRUE}
plot(temp_carbon$temp_anomaly, temp_carbon$carbon_emissions)
```

## Unit II: Visualization {-}
For this series of exercises, we will use the "stars" data frame from the "dslabs" library which indicates attributes of a series of stars such as their temperature, type, and magnitude. The magnitude column is the absolute magnitude, where a more negative value of a star compared to another means it is more luminous.

Make sure to load the data frame with data(stars) before starting.

1. The temperature is in degrees Kelvin. Add the temp_celsius column using the following formula: C = K - 273.15. Using ggplot(), report a scatter plot of temperature versus magnitude coloring by star type. Also, change the x-axis scale to logarithmic base 10.

```{r eval=FALSE}
data(stars)
```

```{r eval=TRUE}
stars |> 
  mutate(temp_celsius = temp - 273.15) |> 
  ggplot() +
  aes(temp_celsius, magnitude, col = type) +
  geom_point() +
  scale_x_log10()
```

2. Given that positive values indicate less brightness, invert the values of the previous plot using the scale_y_reverse() layer. (see ?scale_y_reverse() )

```{r eval=TRUE}
stars |> 
  mutate(temp_celsius = temp - 273.15) |> 
  ggplot() +
  aes(temp_celsius, magnitude, col = type) +
  geom_point() +
  scale_x_log10() +
  scale_y_reverse()
```

3. The Sun is classified as a G-type star. Are G-type stars the most luminous? Create a box plot to compare magnitude medians and determine which type of stars are the most luminous.

```{r eval=TRUE}
stars |> 
  mutate(type = reorder(type, magnitude, FUN = median)) |> 
  ggplot() +
  aes(type, magnitude) +
  geom_boxplot() +
  scale_y_reverse()
```

We see that "O" type stars are the most luminous.