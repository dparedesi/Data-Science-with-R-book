<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Ggplot and dplyr | Data Science with R</title>
  <meta name="description" content="A comprehensive guide to data science using R, covering fundamentals, visualization, statistics, machine learning with tidymodels, and generative AI integration. Second Edition by Daniel Paredes." />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Ggplot and dplyr | Data Science with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A comprehensive guide to data science using R, covering fundamentals, visualization, statistics, machine learning with tidymodels, and generative AI integration. Second Edition by Daniel Paredes." />
  <meta name="github-repo" content="dparedesi/Data-Science-with-R-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Ggplot and dplyr | Data Science with R" />
  
  <meta name="twitter:description" content="A comprehensive guide to data science using R, covering fundamentals, visualization, statistics, machine learning with tidymodels, and generative AI integration. Second Edition by Daniel Paredes." />
  

<meta name="author" content="Author: Mg. Daniel Paredes Inilupu" />


<meta name="date" content="2025-12-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="advanced-techniques.html"/>
<link rel="next" href="gapminder.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics: Sin Vista -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VJJ963010J"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-VJJ963010J');
</script>

<!-- Global site tag (gtag.js) - Google Analytics: Vista -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-165839710-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-165839710-1');
</script>

<!-- Global site tag (gtag.js) - Google Analytics: Agentedec4mbio -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-17876479-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-17876479-1');
</script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Science with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="acknowledgments.html"><a href="acknowledgments.html"><i class="fa fa-check"></i>Acknowledgments</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#why-r"><i class="fa fa-check"></i>Why R?</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#installing-r"><i class="fa fa-check"></i>Installing R</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#installing-rstudio"><i class="fa fa-check"></i>Installing RStudio</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#rstudio-sections"><i class="fa fa-check"></i>RStudio Sections</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#testing-rstudio"><i class="fa fa-check"></i>Testing RStudio</a></li>
</ul></li>
<li class="part"><span><b>I Fundamentals and Key Tools</b></span></li>
<li class="chapter" data-level="1" data-path="objects.html"><a href="objects.html"><i class="fa fa-check"></i><b>1</b> Objects</a>
<ul>
<li class="chapter" data-level="1.1" data-path="objects.html"><a href="objects.html#what-are-objects-in-r"><i class="fa fa-check"></i><b>1.1</b> What are objects in R?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="objects.html"><a href="objects.html#r-as-an-object-oriented-language"><i class="fa fa-check"></i><b>1.1.1</b> R as an object-oriented language</a></li>
<li class="chapter" data-level="1.1.2" data-path="objects.html"><a href="objects.html#the-power-of-abstraction"><i class="fa fa-check"></i><b>1.1.2</b> The power of abstraction</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="objects.html"><a href="objects.html#variables-the-first-objects-on-your-journey"><i class="fa fa-check"></i><b>1.2</b> Variables: The first objects on your journey</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="objects.html"><a href="objects.html#creating-variables-in-r"><i class="fa fa-check"></i><b>1.2.1</b> Creating variables in R</a></li>
<li class="chapter" data-level="1.2.2" data-path="objects.html"><a href="objects.html#operations-with-variables"><i class="fa fa-check"></i><b>1.2.2</b> Operations with variables</a></li>
<li class="chapter" data-level="1.2.3" data-path="objects.html"><a href="objects.html#best-practices-for-naming-variables"><i class="fa fa-check"></i><b>1.2.3</b> Best practices for naming variables</a></li>
<li class="chapter" data-level="1.2.4" data-path="objects.html"><a href="objects.html#data-types"><i class="fa fa-check"></i><b>1.2.4</b> Data types</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="objects.html"><a href="objects.html#object-types-for-complex-data"><i class="fa fa-check"></i><b>1.3</b> Object types for complex data</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="objects.html"><a href="objects.html#vectors-organizing-information-of-the-same-type"><i class="fa fa-check"></i><b>1.3.1</b> Vectors: organizing information of the same type</a></li>
<li class="chapter" data-level="1.3.2" data-path="objects.html"><a href="objects.html#lists-grouping-objects-of-different-types"><i class="fa fa-check"></i><b>1.3.2</b> Lists: grouping objects of different types</a></li>
<li class="chapter" data-level="1.3.3" data-path="objects.html"><a href="objects.html#matrices-organizing-data-in-rows-and-columns"><i class="fa fa-check"></i><b>1.3.3</b> Matrices: organizing data in rows and columns</a></li>
<li class="chapter" data-level="1.3.4" data-path="objects.html"><a href="objects.html#arrays-multidimensional-matrices"><i class="fa fa-check"></i><b>1.3.4</b> Arrays: multidimensional matrices</a></li>
<li class="chapter" data-level="1.3.5" data-path="objects.html"><a href="objects.html#factors-representing-categorical-data"><i class="fa fa-check"></i><b>1.3.5</b> Factors: representing categorical data</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="objects.html"><a href="objects.html#the-universe-of-objects-in-r"><i class="fa fa-check"></i><b>1.4</b> The Universe of Objects in R</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="objects.html"><a href="objects.html#philosophy-of-objects-in-r"><i class="fa fa-check"></i><b>1.4.1</b> Philosophy of objects in R</a></li>
<li class="chapter" data-level="1.4.2" data-path="objects.html"><a href="objects.html#comparison-with-other-languages"><i class="fa fa-check"></i><b>1.4.2</b> Comparison with other languages</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="objects.html"><a href="objects.html#exercises"><i class="fa fa-check"></i><b>1.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>2</b> Functions</a>
<ul>
<li class="chapter" data-level="2.1" data-path="functions.html"><a href="functions.html#introduction-to-the-world-of-functions"><i class="fa fa-check"></i><b>2.1</b> Introduction to the world of functions</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="functions.html"><a href="functions.html#what-are-functions"><i class="fa fa-check"></i><b>2.1.1</b> What are functions?</a></li>
<li class="chapter" data-level="2.1.2" data-path="functions.html"><a href="functions.html#why-use-functions"><i class="fa fa-check"></i><b>2.1.2</b> Why use functions?</a></li>
<li class="chapter" data-level="2.1.3" data-path="functions.html"><a href="functions.html#first-functions-exploring-basic-r-functions"><i class="fa fa-check"></i><b>2.1.3</b> First functions: exploring basic R functions</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="functions.html"><a href="functions.html#anatomy-of-a-function"><i class="fa fa-check"></i><b>2.2</b> Anatomy of a function</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="functions.html"><a href="functions.html#arguments-the-ingredients-of-the-function"><i class="fa fa-check"></i><b>2.2.1</b> Arguments: the ingredients of the function</a></li>
<li class="chapter" data-level="2.2.2" data-path="functions.html"><a href="functions.html#body-the-instructions-of-the-function"><i class="fa fa-check"></i><b>2.2.2</b> Body: the instructions of the function</a></li>
<li class="chapter" data-level="2.2.3" data-path="functions.html"><a href="functions.html#return-value-the-result-of-the-function"><i class="fa fa-check"></i><b>2.2.3</b> Return value: the result of the function</a></li>
<li class="chapter" data-level="2.2.4" data-path="functions.html"><a href="functions.html#examples-creating-simple-functions-step-by-step"><i class="fa fa-check"></i><b>2.2.4</b> Examples: creating simple functions step by step</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="functions.html"><a href="functions.html#mastering-the-use-of-functions"><i class="fa fa-check"></i><b>2.3</b> Mastering the use of functions</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="functions.html"><a href="functions.html#functions-with-a-variable-number-of-arguments-...-adapting-to-different-situations"><i class="fa fa-check"></i><b>2.3.1</b> Functions with a variable number of arguments (<code>...</code>): Adapting to different situations</a></li>
<li class="chapter" data-level="2.3.2" data-path="functions.html"><a href="functions.html#variable-scope-local-and-global-variables"><i class="fa fa-check"></i><b>2.3.2</b> Variable scope: local and global variables</a></li>
<li class="chapter" data-level="2.3.3" data-path="functions.html"><a href="functions.html#examples-functions-to-calculate-taxes-discounts-etc."><i class="fa fa-check"></i><b>2.3.3</b> Examples: functions to calculate taxes, discounts, etc.</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="functions.html"><a href="functions.html#higher-order-functions"><i class="fa fa-check"></i><b>2.4</b> Higher-order functions</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="functions.html"><a href="functions.html#lapply-and-sapply-applying-a-function-to-each-element"><i class="fa fa-check"></i><b>2.4.1</b> <code>lapply()</code> and <code>sapply()</code>: applying a function to each element</a></li>
<li class="chapter" data-level="2.4.2" data-path="functions.html"><a href="functions.html#apply-applying-a-function-to-rows-or-columns"><i class="fa fa-check"></i><b>2.4.2</b> <code>apply()</code>: applying a function to rows or columns</a></li>
<li class="chapter" data-level="2.4.3" data-path="functions.html"><a href="functions.html#mapply-applying-a-function-to-multiple-arguments"><i class="fa fa-check"></i><b>2.4.3</b> <code>mapply()</code>: applying a function to multiple arguments</a></li>
<li class="chapter" data-level="2.4.4" data-path="functions.html"><a href="functions.html#examples-data-analysis-with-higher-order-functions"><i class="fa fa-check"></i><b>2.4.4</b> Examples: data analysis with higher-order functions</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="functions.html"><a href="functions.html#closures-functions-with-memory"><i class="fa fa-check"></i><b>2.5</b> Closures: functions with memory</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="functions.html"><a href="functions.html#concept-functions-that-remember"><i class="fa fa-check"></i><b>2.5.1</b> Concept: functions that “remember”</a></li>
<li class="chapter" data-level="2.5.2" data-path="functions.html"><a href="functions.html#applications-creating-counters-functions-with-internal-state"><i class="fa fa-check"></i><b>2.5.2</b> Applications: creating counters, functions with internal state</a></li>
<li class="chapter" data-level="2.5.3" data-path="functions.html"><a href="functions.html#examples-simulating-a-game-creating-an-operation-history"><i class="fa fa-check"></i><b>2.5.3</b> Examples: simulating a game, creating an operation history</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="functions.html"><a href="functions.html#debugging-and-error-handling-solving-the-mysteries-of-your-code"><i class="fa fa-check"></i><b>2.6</b> Debugging and error handling: solving the mysteries of your code</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="functions.html"><a href="functions.html#identifying-errors-common-error-messages-in-r"><i class="fa fa-check"></i><b>2.6.1</b> Identifying errors: common error messages in R</a></li>
<li class="chapter" data-level="2.6.2" data-path="functions.html"><a href="functions.html#debugging-tools-debug-traceback"><i class="fa fa-check"></i><b>2.6.2</b> Debugging tools: <code>debug()</code>, <code>traceback()</code></a></li>
<li class="chapter" data-level="2.6.3" data-path="functions.html"><a href="functions.html#error-handling-trycatch"><i class="fa fa-check"></i><b>2.6.3</b> Error handling: <code>tryCatch()</code></a></li>
<li class="chapter" data-level="2.6.4" data-path="functions.html"><a href="functions.html#examples-debugging-functions-with-errors-handling-exceptions"><i class="fa fa-check"></i><b>2.6.4</b> Examples: debugging functions with errors, handling exceptions</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="functions.html"><a href="functions.html#exercises-1"><i class="fa fa-check"></i><b>2.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-frames.html"><a href="data-frames.html"><i class="fa fa-check"></i><b>3</b> Data Frames</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-frames.html"><a href="data-frames.html#introduction-to-data-frames"><i class="fa fa-check"></i><b>3.1</b> Introduction to Data Frames</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-frames.html"><a href="data-frames.html#what-are-data-frames"><i class="fa fa-check"></i><b>3.1.1</b> What are data frames?</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-frames.html"><a href="data-frames.html#why-data-frames"><i class="fa fa-check"></i><b>3.1.2</b> Why data frames?</a></li>
<li class="chapter" data-level="3.1.3" data-path="data-frames.html"><a href="data-frames.html#data-frames-in-action-exploring-information-about-the-united-states"><i class="fa fa-check"></i><b>3.1.3</b> Data Frames in action: exploring information about the United States</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-frames.html"><a href="data-frames.html#creating-data-frames-building-your-database-for-the-move"><i class="fa fa-check"></i><b>3.2</b> Creating Data Frames: Building your database for the move</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-frames.html"><a href="data-frames.html#importing-data-from-files-csv-excel"><i class="fa fa-check"></i><b>3.2.1</b> Importing data from files: CSV, Excel</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-frames.html"><a href="data-frames.html#creating-data-frames-manually"><i class="fa fa-check"></i><b>3.2.2</b> Creating data frames manually</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-frames.html"><a href="data-frames.html#examples"><i class="fa fa-check"></i><b>3.2.3</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-frames.html"><a href="data-frames.html#exploring-data-frames-discovering-the-secrets-of-your-data"><i class="fa fa-check"></i><b>3.3</b> Exploring Data Frames: Discovering the secrets of your data</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-frames.html"><a href="data-frames.html#accessing-rows-columns-and-cells"><i class="fa fa-check"></i><b>3.3.1</b> Accessing rows, columns, and cells</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-frames.html"><a href="data-frames.html#functions-for-exploring-data-frames"><i class="fa fa-check"></i><b>3.3.2</b> Functions for exploring data frames</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-frames.html"><a href="data-frames.html#examples-exploring-data-frames-with-move-information"><i class="fa fa-check"></i><b>3.3.3</b> Examples: exploring data frames with move information</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-frames.html"><a href="data-frames.html#manipulating-data-frames-transforming-your-data"><i class="fa fa-check"></i><b>3.4</b> Manipulating Data Frames: Transforming your data</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-frames.html"><a href="data-frames.html#introduction-to-the-pipeline-operator"><i class="fa fa-check"></i><b>3.4.1</b> Introduction to the pipeline operator (<code>|&gt;</code>)</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-frames.html"><a href="data-frames.html#transforming-a-table-with-mutate"><i class="fa fa-check"></i><b>3.4.2</b> Transforming a table with <code>mutate()</code></a></li>
<li class="chapter" data-level="3.4.3" data-path="data-frames.html"><a href="data-frames.html#filtering-data-selecting-cities-that-interest-you"><i class="fa fa-check"></i><b>3.4.3</b> Filtering data: selecting cities that interest you</a></li>
<li class="chapter" data-level="3.4.4" data-path="data-frames.html"><a href="data-frames.html#sorting-data-finding-the-safest-cities"><i class="fa fa-check"></i><b>3.4.4</b> Sorting data: finding the safest cities</a></li>
<li class="chapter" data-level="3.4.5" data-path="data-frames.html"><a href="data-frames.html#aggregating-and-summarizing-data-obtaining-general-overview"><i class="fa fa-check"></i><b>3.4.5</b> Aggregating and summarizing data: obtaining general overview</a></li>
<li class="chapter" data-level="3.4.6" data-path="data-frames.html"><a href="data-frames.html#joining-data-frames-combining-information"><i class="fa fa-check"></i><b>3.4.6</b> Joining data frames: combining information</a></li>
<li class="chapter" data-level="3.4.7" data-path="data-frames.html"><a href="data-frames.html#examples-1"><i class="fa fa-check"></i><b>3.4.7</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-frames.html"><a href="data-frames.html#exercises-2"><i class="fa fa-check"></i><b>3.5</b> Exercises</a></li>
<li class="chapter" data-level="3.6" data-path="data-frames.html"><a href="data-frames.html#data-frames-in-plots"><i class="fa fa-check"></i><b>3.6</b> Data frames in plots</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="data-frames.html"><a href="data-frames.html#scatter-plots"><i class="fa fa-check"></i><b>3.6.1</b> Scatter plots</a></li>
<li class="chapter" data-level="3.6.2" data-path="data-frames.html"><a href="data-frames.html#histograms"><i class="fa fa-check"></i><b>3.6.2</b> Histograms</a></li>
<li class="chapter" data-level="3.6.3" data-path="data-frames.html"><a href="data-frames.html#box-plot"><i class="fa fa-check"></i><b>3.6.3</b> Box plot</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="data-frames.html"><a href="data-frames.html#data-interpretation"><i class="fa fa-check"></i><b>3.7</b> Data interpretation</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="data-frames.html"><a href="data-frames.html#quartiles"><i class="fa fa-check"></i><b>3.7.1</b> Quartiles</a></li>
<li class="chapter" data-level="3.7.2" data-path="data-frames.html"><a href="data-frames.html#interpretation-of-box-plot"><i class="fa fa-check"></i><b>3.7.2</b> Interpretation of box plot</a></li>
<li class="chapter" data-level="3.7.3" data-path="data-frames.html"><a href="data-frames.html#examples-2"><i class="fa fa-check"></i><b>3.7.3</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="data-frames.html"><a href="data-frames.html#exercises-3"><i class="fa fa-check"></i><b>3.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="advanced-techniques.html"><a href="advanced-techniques.html"><i class="fa fa-check"></i><b>4</b> Advanced Techniques</a>
<ul>
<li class="chapter" data-level="4.1" data-path="advanced-techniques.html"><a href="advanced-techniques.html#metaprogramming-writing-code-that-writes-code"><i class="fa fa-check"></i><b>4.1</b> Metaprogramming: writing code that writes code</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="advanced-techniques.html"><a href="advanced-techniques.html#manipulating-expressions-the-art-of-sculpting-code"><i class="fa fa-check"></i><b>4.1.1</b> Manipulating expressions: The art of sculpting code</a></li>
<li class="chapter" data-level="4.1.2" data-path="advanced-techniques.html"><a href="advanced-techniques.html#examples-3"><i class="fa fa-check"></i><b>4.1.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="advanced-techniques.html"><a href="advanced-techniques.html#functional-programming-a-new-paradigm"><i class="fa fa-check"></i><b>4.2</b> Functional programming: a new paradigm</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="advanced-techniques.html"><a href="advanced-techniques.html#basic-principles-of-functional-programming"><i class="fa fa-check"></i><b>4.2.1</b> Basic principles of functional programming</a></li>
<li class="chapter" data-level="4.2.2" data-path="advanced-techniques.html"><a href="advanced-techniques.html#higher-order-functions-in-r"><i class="fa fa-check"></i><b>4.2.2</b> Higher-order functions in R</a></li>
<li class="chapter" data-level="4.2.3" data-path="advanced-techniques.html"><a href="advanced-techniques.html#examples-4"><i class="fa fa-check"></i><b>4.2.3</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="advanced-techniques.html"><a href="advanced-techniques.html#r6-the-future-of-oop-in-r"><i class="fa fa-check"></i><b>4.3</b> R6: The future of OOP in R</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="advanced-techniques.html"><a href="advanced-techniques.html#the-r6-package-classes-methods-encapsulation-and-inheritance"><i class="fa fa-check"></i><b>4.3.1</b> The R6 package: Classes, methods, encapsulation, and inheritance</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="advanced-techniques.html"><a href="advanced-techniques.html#exercises-4"><i class="fa fa-check"></i><b>4.4</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>II Data Visualization and Summarization</b></span></li>
<li class="chapter" data-level="5" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html"><i class="fa fa-check"></i><b>5</b> Ggplot and dplyr</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#creating-the-ggplot-object"><i class="fa fa-check"></i><b>5.1</b> Creating the ggplot object</a></li>
<li class="chapter" data-level="5.2" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#aesthetic-mapping-layer"><i class="fa fa-check"></i><b>5.2</b> Aesthetic mapping layer</a></li>
<li class="chapter" data-level="5.3" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#geoms-layer"><i class="fa fa-check"></i><b>5.3</b> Geoms layer</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#tweaking-aes-and-geoms"><i class="fa fa-check"></i><b>5.3.1</b> Tweaking aes and geoms</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#scale-layer"><i class="fa fa-check"></i><b>5.4</b> Scale layer</a></li>
<li class="chapter" data-level="5.5" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#label-title-and-legend-layer"><i class="fa fa-check"></i><b>5.5</b> Label, title and legend layer</a></li>
<li class="chapter" data-level="5.6" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#reference-lines"><i class="fa fa-check"></i><b>5.6</b> Reference lines</a></li>
<li class="chapter" data-level="5.7" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#changing-the-plot-style"><i class="fa fa-check"></i><b>5.7</b> Changing the plot style</a></li>
<li class="chapter" data-level="5.8" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#summarizing-data-with-dplyr"><i class="fa fa-check"></i><b>5.8</b> Summarizing data with dplyr</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#summarize-function"><i class="fa fa-check"></i><b>5.8.1</b> Summarize function</a></li>
<li class="chapter" data-level="5.8.2" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#group-by-function"><i class="fa fa-check"></i><b>5.8.2</b> Group By Function</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#exercises-5"><i class="fa fa-check"></i><b>5.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="gapminder.html"><a href="gapminder.html"><i class="fa fa-check"></i><b>6</b> Gapminder</a>
<ul>
<li class="chapter" data-level="6.1" data-path="gapminder.html"><a href="gapminder.html#initial-gapminder-plots"><i class="fa fa-check"></i><b>6.1</b> Initial gapminder plots</a></li>
<li class="chapter" data-level="6.2" data-path="gapminder.html"><a href="gapminder.html#facets"><i class="fa fa-check"></i><b>6.2</b> Facets</a></li>
<li class="chapter" data-level="6.3" data-path="gapminder.html"><a href="gapminder.html#time-series"><i class="fa fa-check"></i><b>6.3</b> Time series</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="gapminder.html"><a href="gapminder.html#individual-time-series"><i class="fa fa-check"></i><b>6.3.1</b> Individual time series</a></li>
<li class="chapter" data-level="6.3.2" data-path="gapminder.html"><a href="gapminder.html#multiple-time-series"><i class="fa fa-check"></i><b>6.3.2</b> Multiple time series</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="gapminder.html"><a href="gapminder.html#exercises-6"><i class="fa fa-check"></i><b>6.4</b> Exercises</a></li>
<li class="chapter" data-level="6.5" data-path="gapminder.html"><a href="gapminder.html#histograms-with-ggplot"><i class="fa fa-check"></i><b>6.5</b> Histograms with ggplot</a></li>
<li class="chapter" data-level="6.6" data-path="gapminder.html"><a href="gapminder.html#box-plots-with-ggplot"><i class="fa fa-check"></i><b>6.6</b> Box plots with ggplot</a></li>
<li class="chapter" data-level="6.7" data-path="gapminder.html"><a href="gapminder.html#comparison-of-distributions"><i class="fa fa-check"></i><b>6.7</b> Comparison of distributions</a></li>
<li class="chapter" data-level="6.8" data-path="gapminder.html"><a href="gapminder.html#exercises-7"><i class="fa fa-check"></i><b>6.8</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>III Statistics</b></span></li>
<li class="chapter" data-level="" data-path="introduction-to-probabilities.html"><a href="introduction-to-probabilities.html"><i class="fa fa-check"></i>Introduction to Probabilities</a></li>
<li class="chapter" data-level="7" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html"><i class="fa fa-check"></i><b>7</b> Discrete Probabilities</a>
<ul>
<li class="chapter" data-level="7.1" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#calculation-using-the-mathematical-definition"><i class="fa fa-check"></i><b>7.1</b> Calculation using the mathematical definition</a></li>
<li class="chapter" data-level="7.2" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#monte-carlo-simulation-for-discrete-variables"><i class="fa fa-check"></i><b>7.2</b> Monte Carlo Simulation for Discrete Variables</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#other-functions-to-create-vectors"><i class="fa fa-check"></i><b>7.2.1</b> Other functions to create vectors</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#exercises-8"><i class="fa fa-check"></i><b>7.3</b> Exercises</a></li>
<li class="chapter" data-level="7.4" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#combinations-and-permutations"><i class="fa fa-check"></i><b>7.4</b> Combinations and Permutations</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#permutations"><i class="fa fa-check"></i><b>7.4.1</b> Permutations</a></li>
<li class="chapter" data-level="7.4.2" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#combinations"><i class="fa fa-check"></i><b>7.4.2</b> Combinations</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#sufficient-experiments-with-monte-carlo-simulation"><i class="fa fa-check"></i><b>7.5</b> Sufficient Experiments with Monte Carlo Simulation</a></li>
<li class="chapter" data-level="7.6" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#case-birthdays-in-classrooms"><i class="fa fa-check"></i><b>7.6</b> Case: Birthdays in Classrooms</a></li>
<li class="chapter" data-level="7.7" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#exercises-9"><i class="fa fa-check"></i><b>7.7</b> Exercises</a></li>
<li class="chapter" data-level="7.8" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#integrative-exercise"><i class="fa fa-check"></i><b>7.8</b> Integrative Exercise</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#monty-hall-problem"><i class="fa fa-check"></i><b>7.8.1</b> Monty Hall Problem</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="continuous-probabilities.html"><a href="continuous-probabilities.html"><i class="fa fa-check"></i><b>8</b> Continuous Probabilities</a>
<ul>
<li class="chapter" data-level="8.1" data-path="continuous-probabilities.html"><a href="continuous-probabilities.html#empirical-distribution"><i class="fa fa-check"></i><b>8.1</b> Empirical Distribution</a></li>
<li class="chapter" data-level="8.2" data-path="continuous-probabilities.html"><a href="continuous-probabilities.html#theoretical-distribution"><i class="fa fa-check"></i><b>8.2</b> Theoretical Distribution</a></li>
<li class="chapter" data-level="8.3" data-path="continuous-probabilities.html"><a href="continuous-probabilities.html#exercises-10"><i class="fa fa-check"></i><b>8.3</b> Exercises</a></li>
<li class="chapter" data-level="8.4" data-path="continuous-probabilities.html"><a href="continuous-probabilities.html#monte-carlo-simulation-for-continuous-variables"><i class="fa fa-check"></i><b>8.4</b> Monte Carlo Simulation for Continuous Variables</a></li>
<li class="chapter" data-level="8.5" data-path="continuous-probabilities.html"><a href="continuous-probabilities.html#exercises-11"><i class="fa fa-check"></i><b>8.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i><b>9</b> Statistical Inference</a>
<ul>
<li class="chapter" data-level="9.1" data-path="statistical-inference.html"><a href="statistical-inference.html#expected-value"><i class="fa fa-check"></i><b>9.1</b> Expected Value</a></li>
<li class="chapter" data-level="9.2" data-path="statistical-inference.html"><a href="statistical-inference.html#central-limit-theorem"><i class="fa fa-check"></i><b>9.2</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="9.3" data-path="statistical-inference.html"><a href="statistical-inference.html#exercises-12"><i class="fa fa-check"></i><b>9.3</b> Exercises</a></li>
<li class="chapter" data-level="9.4" data-path="statistical-inference.html"><a href="statistical-inference.html#parameter-estimation-method"><i class="fa fa-check"></i><b>9.4</b> Parameter Estimation Method</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="statistical-inference.html"><a href="statistical-inference.html#margin-of-error"><i class="fa fa-check"></i><b>9.4.1</b> Margin of Error</a></li>
<li class="chapter" data-level="9.4.2" data-path="statistical-inference.html"><a href="statistical-inference.html#confidence-intervals"><i class="fa fa-check"></i><b>9.4.2</b> Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="statistical-inference.html"><a href="statistical-inference.html#spread-estimation"><i class="fa fa-check"></i><b>9.5</b> Spread Estimation</a></li>
<li class="chapter" data-level="9.6" data-path="statistical-inference.html"><a href="statistical-inference.html#estimates-outside-election-polls"><i class="fa fa-check"></i><b>9.6</b> Estimates Outside Election Polls</a></li>
<li class="chapter" data-level="9.7" data-path="statistical-inference.html"><a href="statistical-inference.html#exercises-13"><i class="fa fa-check"></i><b>9.7</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>IV Data Wrangling</b></span></li>
<li class="chapter" data-level="" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="10" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html"><i class="fa fa-check"></i><b>10</b> Data import and consolidation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#importing-from-files"><i class="fa fa-check"></i><b>10.1</b> Importing from files</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#working-directory"><i class="fa fa-check"></i><b>10.1.1</b> Working Directory</a></li>
<li class="chapter" data-level="10.1.2" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#readr-and-readxl-packages"><i class="fa fa-check"></i><b>10.1.2</b> readr and readxl packages</a></li>
<li class="chapter" data-level="10.1.3" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#importing-files-from-the-internet"><i class="fa fa-check"></i><b>10.1.3</b> Importing files from the internet</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#tidy-data"><i class="fa fa-check"></i><b>10.2</b> Tidy data</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#transforming-to-tidy-data"><i class="fa fa-check"></i><b>10.2.1</b> Transforming to tidy data</a></li>
<li class="chapter" data-level="10.2.2" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#separate-function"><i class="fa fa-check"></i><b>10.2.2</b> separate function</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#exercises-14"><i class="fa fa-check"></i><b>10.3</b> Exercises</a></li>
<li class="chapter" data-level="10.4" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#joining-tables"><i class="fa fa-check"></i><b>10.4</b> Joining tables</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#join-functions"><i class="fa fa-check"></i><b>10.4.1</b> Join functions</a></li>
<li class="chapter" data-level="10.4.2" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#joining-without-a-common-identifier"><i class="fa fa-check"></i><b>10.4.2</b> Joining without a common identifier</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#web-scraping"><i class="fa fa-check"></i><b>10.5</b> Web Scraping</a></li>
<li class="chapter" data-level="10.6" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#exercises-15"><i class="fa fa-check"></i><b>10.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html"><i class="fa fa-check"></i><b>11</b> String processing and text mining</a>
<ul>
<li class="chapter" data-level="11.1" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#basic-functions"><i class="fa fa-check"></i><b>11.1</b> Basic functions</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#replacing-characters"><i class="fa fa-check"></i><b>11.1.1</b> Replacing characters</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#regular-expressions"><i class="fa fa-check"></i><b>11.2</b> Regular expressions</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#alternation"><i class="fa fa-check"></i><b>11.2.1</b> Alternation</a></li>
<li class="chapter" data-level="11.2.2" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#anchoring"><i class="fa fa-check"></i><b>11.2.2</b> Anchoring</a></li>
<li class="chapter" data-level="11.2.3" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#repetitions"><i class="fa fa-check"></i><b>11.2.3</b> Repetitions</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#from-strings-to-dates"><i class="fa fa-check"></i><b>11.3</b> From strings to dates</a></li>
<li class="chapter" data-level="11.4" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#exercises-16"><i class="fa fa-check"></i><b>11.4</b> Exercises</a></li>
<li class="chapter" data-level="11.5" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#text-mining-word-cloud"><i class="fa fa-check"></i><b>11.5</b> Text Mining: Word Cloud</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#importing-data"><i class="fa fa-check"></i><b>11.5.1</b> Importing data</a></li>
<li class="chapter" data-level="11.5.2" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#text-cleaning"><i class="fa fa-check"></i><b>11.5.2</b> Text cleaning</a></li>
<li class="chapter" data-level="11.5.3" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#creating-the-corpus"><i class="fa fa-check"></i><b>11.5.3</b> Creating the Corpus</a></li>
<li class="chapter" data-level="11.5.4" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#nd-data-cleaning"><i class="fa fa-check"></i><b>11.5.4</b> 2nd Data Cleaning</a></li>
<li class="chapter" data-level="11.5.5" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#word-frequency"><i class="fa fa-check"></i><b>11.5.5</b> Word frequency</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#text-mining-sentiment-analysis"><i class="fa fa-check"></i><b>11.6</b> Text Mining: Sentiment Analysis</a></li>
<li class="chapter" data-level="11.7" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#exercises-17"><i class="fa fa-check"></i><b>11.7</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>V Machine learning</b></span></li>
<li class="chapter" data-level="" data-path="introduction-2.html"><a href="introduction-2.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="12" data-path="supervised-learning.html"><a href="supervised-learning.html"><i class="fa fa-check"></i><b>12</b> Supervised Learning</a>
<ul>
<li class="chapter" data-level="12.1" data-path="supervised-learning.html"><a href="supervised-learning.html#classification-and-regression"><i class="fa fa-check"></i><b>12.1</b> Classification and Regression</a></li>
<li class="chapter" data-level="12.2" data-path="supervised-learning.html"><a href="supervised-learning.html#knn-k-nearest-neighbors"><i class="fa fa-check"></i><b>12.2</b> kNN: k-Nearest Neighbors</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="supervised-learning.html"><a href="supervised-learning.html#two-variables-as-input"><i class="fa fa-check"></i><b>12.2.1</b> Two variables as input</a></li>
<li class="chapter" data-level="12.2.2" data-path="supervised-learning.html"><a href="supervised-learning.html#multiple-variables-as-input"><i class="fa fa-check"></i><b>12.2.2</b> Multiple variables as input</a></li>
<li class="chapter" data-level="12.2.3" data-path="supervised-learning.html"><a href="supervised-learning.html#diverse-values-of-k"><i class="fa fa-check"></i><b>12.2.3</b> Diverse values of k</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="supervised-learning.html"><a href="supervised-learning.html#tidymodels-framework"><i class="fa fa-check"></i><b>12.3</b> tidymodels Framework</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="supervised-learning.html"><a href="supervised-learning.html#creation-of-training-and-test-data"><i class="fa fa-check"></i><b>12.3.1</b> Creation of training and test data</a></li>
<li class="chapter" data-level="12.3.2" data-path="supervised-learning.html"><a href="supervised-learning.html#training-our-prediction-algorithm"><i class="fa fa-check"></i><b>12.3.2</b> Training our prediction algorithm</a></li>
<li class="chapter" data-level="12.3.3" data-path="supervised-learning.html"><a href="supervised-learning.html#data-pre-processing-with-recipes"><i class="fa fa-check"></i><b>12.3.3</b> Data Pre-processing with Recipes</a></li>
<li class="chapter" data-level="12.3.4" data-path="supervised-learning.html"><a href="supervised-learning.html#creating-a-workflow"><i class="fa fa-check"></i><b>12.3.4</b> Creating a Workflow</a></li>
<li class="chapter" data-level="12.3.5" data-path="supervised-learning.html"><a href="supervised-learning.html#parameter-tuning-with-cross-validation"><i class="fa fa-check"></i><b>12.3.5</b> Parameter Tuning with Cross-Validation</a></li>
<li class="chapter" data-level="12.3.6" data-path="supervised-learning.html"><a href="supervised-learning.html#finalizing-the-model"><i class="fa fa-check"></i><b>12.3.6</b> Finalizing the Model</a></li>
<li class="chapter" data-level="12.3.7" data-path="supervised-learning.html"><a href="supervised-learning.html#testing-the-prediction-model"><i class="fa fa-check"></i><b>12.3.7</b> Testing the prediction model</a></li>
<li class="chapter" data-level="12.3.8" data-path="supervised-learning.html"><a href="supervised-learning.html#model-evaluation-with-yardstick"><i class="fa fa-check"></i><b>12.3.8</b> Model Evaluation with yardstick</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="supervised-learning.html"><a href="supervised-learning.html#confusion-matrix"><i class="fa fa-check"></i><b>12.4</b> Confusion Matrix</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="supervised-learning.html"><a href="supervised-learning.html#accuracy"><i class="fa fa-check"></i><b>12.4.1</b> Accuracy</a></li>
<li class="chapter" data-level="12.4.2" data-path="supervised-learning.html"><a href="supervised-learning.html#sensitivity"><i class="fa fa-check"></i><b>12.4.2</b> Sensitivity</a></li>
<li class="chapter" data-level="12.4.3" data-path="supervised-learning.html"><a href="supervised-learning.html#specificity"><i class="fa fa-check"></i><b>12.4.3</b> Specificity</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="supervised-learning.html"><a href="supervised-learning.html#exercises-18"><i class="fa fa-check"></i><b>12.5</b> Exercises</a></li>
<li class="chapter" data-level="12.6" data-path="supervised-learning.html"><a href="supervised-learning.html#simple-linear-regression"><i class="fa fa-check"></i><b>12.6</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="12.7" data-path="supervised-learning.html"><a href="supervised-learning.html#multiple-linear-regression"><i class="fa fa-check"></i><b>12.7</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="12.8" data-path="supervised-learning.html"><a href="supervised-learning.html#standard-method-for-evaluating-accuracy"><i class="fa fa-check"></i><b>12.8</b> Standard Method for Evaluating Accuracy</a></li>
<li class="chapter" data-level="12.9" data-path="supervised-learning.html"><a href="supervised-learning.html#selection-of-the-most-optimal-model"><i class="fa fa-check"></i><b>12.9</b> Selection of the Most Optimal Model</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="supervised-learning.html"><a href="supervised-learning.html#k-nearest-neighbors-model"><i class="fa fa-check"></i><b>12.9.1</b> k-Nearest Neighbors Model</a></li>
<li class="chapter" data-level="12.9.2" data-path="supervised-learning.html"><a href="supervised-learning.html#generalized-linear-model---glm"><i class="fa fa-check"></i><b>12.9.2</b> Generalized Linear Model - GLM</a></li>
<li class="chapter" data-level="12.9.3" data-path="supervised-learning.html"><a href="supervised-learning.html#random-forest-model"><i class="fa fa-check"></i><b>12.9.3</b> Random Forest Model</a></li>
<li class="chapter" data-level="12.9.4" data-path="supervised-learning.html"><a href="supervised-learning.html#support-vector-machine-model---svm"><i class="fa fa-check"></i><b>12.9.4</b> Support Vector Machine Model - SVM</a></li>
<li class="chapter" data-level="12.9.5" data-path="supervised-learning.html"><a href="supervised-learning.html#naive-bayes-model"><i class="fa fa-check"></i><b>12.9.5</b> Naive Bayes Model</a></li>
<li class="chapter" data-level="12.9.6" data-path="supervised-learning.html"><a href="supervised-learning.html#model-comparison"><i class="fa fa-check"></i><b>12.9.6</b> Model Comparison</a></li>
<li class="chapter" data-level="12.9.7" data-path="supervised-learning.html"><a href="supervised-learning.html#predicting-using-the-best-model"><i class="fa fa-check"></i><b>12.9.7</b> Predicting using the best model</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="supervised-learning.html"><a href="supervised-learning.html#exercises-19"><i class="fa fa-check"></i><b>12.10</b> Exercises</a></li>
<li class="chapter" data-level="12.11" data-path="supervised-learning.html"><a href="supervised-learning.html#ethics-bias-in-algorithmic-decision-making"><i class="fa fa-check"></i><b>12.11</b> Ethics: Bias in Algorithmic Decision Making</a>
<ul>
<li class="chapter" data-level="12.11.1" data-path="supervised-learning.html"><a href="supervised-learning.html#the-risk-of-proxy-variables"><i class="fa fa-check"></i><b>12.11.1</b> The Risk of Proxy Variables</a></li>
<li class="chapter" data-level="12.11.2" data-path="supervised-learning.html"><a href="supervised-learning.html#feedback-loops"><i class="fa fa-check"></i><b>12.11.2</b> Feedback Loops</a></li>
<li class="chapter" data-level="12.11.3" data-path="supervised-learning.html"><a href="supervised-learning.html#what-can-we-do"><i class="fa fa-check"></i><b>12.11.3</b> What can we do?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html"><i class="fa fa-check"></i><b>13</b> Unsupervised Learning</a>
<ul>
<li class="chapter" data-level="13.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#k-means-clustering"><i class="fa fa-check"></i><b>13.1</b> K-Means Clustering</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#clustering-with-k-2"><i class="fa fa-check"></i><b>13.1.1</b> Clustering with k = 2</a></li>
<li class="chapter" data-level="13.1.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#clustering-with-k-3"><i class="fa fa-check"></i><b>13.1.2</b> Clustering with k &gt;= 3</a></li>
<li class="chapter" data-level="13.1.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#determination-of-optimal-clusters"><i class="fa fa-check"></i><b>13.1.3</b> Determination of Optimal Clusters</a></li>
<li class="chapter" data-level="13.1.4" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#k-means-for-more-than-2-variables"><i class="fa fa-check"></i><b>13.1.4</b> k-means for more than 2 variables</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#hierarchical-clustering"><i class="fa fa-check"></i><b>13.2</b> Hierarchical Clustering</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#clustering-with-two-variables"><i class="fa fa-check"></i><b>13.2.1</b> Clustering with two variables</a></li>
<li class="chapter" data-level="13.2.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#determination-of-optimal-clusters-1"><i class="fa fa-check"></i><b>13.2.2</b> Determination of Optimal Clusters</a></li>
<li class="chapter" data-level="13.2.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#obtain-the-grouping"><i class="fa fa-check"></i><b>13.2.3</b> Obtain the grouping</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#dimensionality-reduction"><i class="fa fa-check"></i><b>13.3</b> Dimensionality Reduction</a></li>
<li class="chapter" data-level="13.4" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#exercises-20"><i class="fa fa-check"></i><b>13.4</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>VI Real Cases</b></span></li>
<li class="chapter" data-level="" data-path="introduction-3.html"><a href="introduction-3.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="14" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html"><i class="fa fa-check"></i><b>14</b> Case Study: Real Estate Market Analysis</a>
<ul>
<li class="chapter" data-level="14.1" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#objectives"><i class="fa fa-check"></i><b>14.1</b> Objectives</a></li>
<li class="chapter" data-level="14.2" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#loading-libraries"><i class="fa fa-check"></i><b>14.2</b> Loading Libraries</a></li>
<li class="chapter" data-level="14.3" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#exploring-the-data"><i class="fa fa-check"></i><b>14.3</b> Exploring the Data</a></li>
<li class="chapter" data-level="14.4" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#data-cleaning"><i class="fa fa-check"></i><b>14.4</b> Data Cleaning</a></li>
<li class="chapter" data-level="14.5" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#exploratory-analysis"><i class="fa fa-check"></i><b>14.5</b> Exploratory Analysis</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#market-volume-over-time"><i class="fa fa-check"></i><b>14.5.1</b> Market Volume Over Time</a></li>
<li class="chapter" data-level="14.5.2" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#comparing-cities"><i class="fa fa-check"></i><b>14.5.2</b> Comparing Cities</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#creating-indicators"><i class="fa fa-check"></i><b>14.6</b> Creating Indicators</a></li>
<li class="chapter" data-level="14.7" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#conclusions"><i class="fa fa-check"></i><b>14.7</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="google-analytics-from-r.html"><a href="google-analytics-from-r.html"><i class="fa fa-check"></i><b>15</b> Google Analytics from R</a>
<ul>
<li class="chapter" data-level="15.1" data-path="google-analytics-from-r.html"><a href="google-analytics-from-r.html#problem"><i class="fa fa-check"></i><b>15.1</b> Problem</a></li>
<li class="chapter" data-level="15.2" data-path="google-analytics-from-r.html"><a href="google-analytics-from-r.html#access-to-data"><i class="fa fa-check"></i><b>15.2</b> Access to data</a></li>
<li class="chapter" data-level="15.3" data-path="google-analytics-from-r.html"><a href="google-analytics-from-r.html#visualization"><i class="fa fa-check"></i><b>15.3</b> Visualization</a></li>
<li class="chapter" data-level="15.4" data-path="google-analytics-from-r.html"><a href="google-analytics-from-r.html#conclusion"><i class="fa fa-check"></i><b>15.4</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="genai-intro.html"><a href="genai-intro.html"><i class="fa fa-check"></i><b>16</b> Data Science in the Age of AI</a>
<ul>
<li class="chapter" data-level="16.1" data-path="genai-intro.html"><a href="genai-intro.html#what-is-a-large-language-model"><i class="fa fa-check"></i><b>16.1</b> What is a Large Language Model?</a></li>
<li class="chapter" data-level="16.2" data-path="genai-intro.html"><a href="genai-intro.html#coding-with-ai-the-pair-programmer"><i class="fa fa-check"></i><b>16.2</b> Coding with AI: The “Pair Programmer”</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="genai-intro.html"><a href="genai-intro.html#explaining-complex-code"><i class="fa fa-check"></i><b>16.2.1</b> 1. Explaining Complex Code</a></li>
<li class="chapter" data-level="16.2.2" data-path="genai-intro.html"><a href="genai-intro.html#generating-boilerplate"><i class="fa fa-check"></i><b>16.2.2</b> 2. Generating Boilerplate</a></li>
<li class="chapter" data-level="16.2.3" data-path="genai-intro.html"><a href="genai-intro.html#regex-the-ultimate-use-case"><i class="fa fa-check"></i><b>16.2.3</b> 3. Regex: The Ultimate Use Case</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="genai-intro.html"><a href="genai-intro.html#ethics-risks-in-the-ai-era"><i class="fa fa-check"></i><b>16.3</b> Ethics &amp; Risks in the AI Era</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="genai-intro.html"><a href="genai-intro.html#hallucinations-fabrication"><i class="fa fa-check"></i><b>16.3.1</b> 1. Hallucinations &amp; Fabrication</a></li>
<li class="chapter" data-level="16.3.2" data-path="genai-intro.html"><a href="genai-intro.html#the-reproducibility-crisis"><i class="fa fa-check"></i><b>16.3.2</b> 2. The Reproducibility Crisis</a></li>
<li class="chapter" data-level="16.3.3" data-path="genai-intro.html"><a href="genai-intro.html#data-privacy-ip"><i class="fa fa-check"></i><b>16.3.3</b> 3. Data Privacy &amp; IP</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="genai-api.html"><a href="genai-api.html"><i class="fa fa-check"></i><b>17</b> LLMs as an Analysis Engine</a>
<ul>
<li class="chapter" data-level="17.1" data-path="genai-api.html"><a href="genai-api.html#the-evolution-of-nlp"><i class="fa fa-check"></i><b>17.1</b> The Evolution of NLP</a></li>
<li class="chapter" data-level="17.2" data-path="genai-api.html"><a href="genai-api.html#interacting-with-apis-from-r"><i class="fa fa-check"></i><b>17.2</b> Interacting with APIs from R</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="genai-api.html"><a href="genai-api.html#prerequisite-api-keys"><i class="fa fa-check"></i><b>17.2.1</b> Prerequisite: API Keys</a></li>
<li class="chapter" data-level="17.2.2" data-path="genai-api.html"><a href="genai-api.html#making-a-request"><i class="fa fa-check"></i><b>17.2.2</b> Making a Request</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="genai-api.html"><a href="genai-api.html#zero-shot-classification"><i class="fa fa-check"></i><b>17.3</b> Zero-Shot Classification</a></li>
<li class="chapter" data-level="17.4" data-path="genai-api.html"><a href="genai-api.html#text-cleaning-with-llms"><i class="fa fa-check"></i><b>17.4</b> Text Cleaning with LLMs</a></li>
<li class="chapter" data-level="17.5" data-path="genai-api.html"><a href="genai-api.html#summary"><i class="fa fa-check"></i><b>17.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="ethics-checklist.html"><a href="ethics-checklist.html"><i class="fa fa-check"></i><b>18</b> Appendix A: Responsible AI Checklist</a>
<ul>
<li class="chapter" data-level="18.1" data-path="ethics-checklist.html"><a href="ethics-checklist.html#data-quality-lineage"><i class="fa fa-check"></i><b>18.1</b> 1. Data Quality &amp; lineage</a></li>
<li class="chapter" data-level="18.2" data-path="ethics-checklist.html"><a href="ethics-checklist.html#fairness-bias"><i class="fa fa-check"></i><b>18.2</b> 2. Fairness &amp; Bias</a></li>
<li class="chapter" data-level="18.3" data-path="ethics-checklist.html"><a href="ethics-checklist.html#transparency-explainability"><i class="fa fa-check"></i><b>18.3</b> 3. Transparency &amp; Explainability</a></li>
<li class="chapter" data-level="18.4" data-path="ethics-checklist.html"><a href="ethics-checklist.html#genai-specifics"><i class="fa fa-check"></i><b>18.4</b> 4. GenAI Specifics</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ggplot-and-dplyr" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Ggplot and dplyr<a href="ggplot-and-dplyr.html#ggplot-and-dplyr" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>We have learned so far how to perform simple and fast visualizations. Now that we have a notion of plots, we will use more complex and aesthetically better plots to present.</p>
<p>To do this, we will use the <code>ggplot</code> object included in the <code>tidyverse</code> library (the <code>tidyverse</code> package includes a package called <code>ggplot2</code> which allows us to use the <code>ggplot</code> object). Previously we have already installed the <code>tidyverse</code> package, so now we only have to load the library:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="ggplot-and-dplyr.html#cb200-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>We are going to learn visualization techniques using our previous case/problem, so that we learn to use the <code>ggplot</code> object gradually with an already known case/problem.</p>
<div id="creating-the-ggplot-object" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Creating the ggplot object<a href="ggplot-and-dplyr.html#creating-the-ggplot-object" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will start by creating the <code>ggplot</code> object from the <code>murders</code> data using the pipeline operator <code>|&gt;</code>. Let’s also remember to have loaded the <code>murders</code> data from the <code>dslabs</code> library.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="ggplot-and-dplyr.html#cb201-1" tabindex="-1"></a><span class="fu">library</span>(dslabs)</span>
<span id="cb201-2"><a href="ggplot-and-dplyr.html#cb201-2" tabindex="-1"></a><span class="fu">data</span>(murders)</span>
<span id="cb201-3"><a href="ggplot-and-dplyr.html#cb201-3" tabindex="-1"></a></span>
<span id="cb201-4"><a href="ggplot-and-dplyr.html#cb201-4" tabindex="-1"></a>murders <span class="sc">|&gt;</span></span>
<span id="cb201-5"><a href="ggplot-and-dplyr.html#cb201-5" tabindex="-1"></a>  <span class="fu">ggplot</span>()</span></code></pre></div>
<p><img src="Data-Science-with-R_files/figure-html/unnamed-chunk-274-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>This code only shows us an empty box. This is because we haven’t specified which variables to take from the data frame nor what type of plot we want.</p>
<p>To add each component of the plot we are creating we will use <em>layers</em>. The <code>ggplot</code> object allows us to add layer by layer which component of the plot we want to add. The symbol to add layers to the <code>ggplot</code> object is the <code>+</code> symbol.</p>
</div>
<div id="aesthetic-mapping-layer" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Aesthetic mapping layer<a href="ggplot-and-dplyr.html#aesthetic-mapping-layer" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First we will focus on the basic aesthetics, that is: what goes on the <em><strong>x-axis</strong></em> and what we put on the <em><strong>y-axis</strong></em>. To do this we will use the aesthetic function which in R is <code>aes()</code>. For example, let’s add the <code>population</code> data on the <em>x-axis</em> and the <code>total</code> data on the <em>y-axis</em>. We don’t have to use the <code>$</code> accessor because the <code>aes</code> function takes the <code>murders</code> table before the pipeline as a reference.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="ggplot-and-dplyr.html#cb202-1" tabindex="-1"></a></span>
<span id="cb202-2"><a href="ggplot-and-dplyr.html#cb202-2" tabindex="-1"></a>murders <span class="sc">|&gt;</span></span>
<span id="cb202-3"><a href="ggplot-and-dplyr.html#cb202-3" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb202-4"><a href="ggplot-and-dplyr.html#cb202-4" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> population, <span class="at">y =</span> total)</span></code></pre></div>
<p><img src="Data-Science-with-R_files/figure-html/unnamed-chunk-275-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>Now we have a box with the axes marked, but still without any data inside the box.</p>
</div>
<div id="geoms-layer" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Geoms layer<a href="ggplot-and-dplyr.html#geoms-layer" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s add one more layer that indicates what type of plot we want. To do this we will use the so-called <strong>geoms</strong>. There are different types of geoms. For example, a scatter plot is shown with points, therefore we will use the <code>geom_point()</code> function. For more detail we can see the documentation of <code>geom_point()</code> <a href="https://ggplot2.tidyverse.org/reference/geom_point.html">here</a>.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="ggplot-and-dplyr.html#cb203-1" tabindex="-1"></a></span>
<span id="cb203-2"><a href="ggplot-and-dplyr.html#cb203-2" tabindex="-1"></a>murders <span class="sc">|&gt;</span></span>
<span id="cb203-3"><a href="ggplot-and-dplyr.html#cb203-3" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb203-4"><a href="ggplot-and-dplyr.html#cb203-4" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> population, <span class="at">y =</span> total) <span class="sc">+</span></span>
<span id="cb203-5"><a href="ggplot-and-dplyr.html#cb203-5" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="Data-Science-with-R_files/figure-html/unnamed-chunk-276-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>In the same way, we can show lines connecting the data instead of points with the <code>geom_line()</code> function.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="ggplot-and-dplyr.html#cb204-1" tabindex="-1"></a></span>
<span id="cb204-2"><a href="ggplot-and-dplyr.html#cb204-2" tabindex="-1"></a>murders <span class="sc">|&gt;</span></span>
<span id="cb204-3"><a href="ggplot-and-dplyr.html#cb204-3" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb204-4"><a href="ggplot-and-dplyr.html#cb204-4" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> population, <span class="at">y =</span> total) <span class="sc">+</span></span>
<span id="cb204-5"><a href="ggplot-and-dplyr.html#cb204-5" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="Data-Science-with-R_files/figure-html/unnamed-chunk-277-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>Up to this point we have created the same scatter plot that we saw in the previous chapter. The power of ggplot lies in the ease of adding components. For example, if we want each point in the scatter plot to have the state name, or even better the abbreviation <code>abb</code>, we just have to add it as a <code>label</code> attribute inside <code>aes</code> and add the <code>geom_text()</code> layer.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="ggplot-and-dplyr.html#cb205-1" tabindex="-1"></a></span>
<span id="cb205-2"><a href="ggplot-and-dplyr.html#cb205-2" tabindex="-1"></a>murders <span class="sc">|&gt;</span></span>
<span id="cb205-3"><a href="ggplot-and-dplyr.html#cb205-3" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb205-4"><a href="ggplot-and-dplyr.html#cb205-4" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> population, <span class="at">y =</span> total, <span class="at">label=</span>abb) <span class="sc">+</span></span>
<span id="cb205-5"><a href="ggplot-and-dplyr.html#cb205-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb205-6"><a href="ggplot-and-dplyr.html#cb205-6" tabindex="-1"></a>  <span class="fu">geom_text</span>()</span></code></pre></div>
<p><img src="Data-Science-with-R_files/figure-html/unnamed-chunk-278-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>In this plot we can already see that the upper right point corresponds to <strong>CA</strong> which is the abbreviation for the state of <strong>California</strong>.</p>
<div id="tweaking-aes-and-geoms" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Tweaking aes and geoms<a href="ggplot-and-dplyr.html#tweaking-aes-and-geoms" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can tweak our plots in multiple ways by adding attributes to our functions.</p>
<p>For example, if we want to identify which region each point belongs to (if it is from the US North, South, etc.) we would have to edit <code>aes()</code> and make <code>color</code> take into account the <code>region</code> variable as follows:</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="ggplot-and-dplyr.html#cb206-1" tabindex="-1"></a></span>
<span id="cb206-2"><a href="ggplot-and-dplyr.html#cb206-2" tabindex="-1"></a>murders <span class="sc">|&gt;</span></span>
<span id="cb206-3"><a href="ggplot-and-dplyr.html#cb206-3" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb206-4"><a href="ggplot-and-dplyr.html#cb206-4" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> population, <span class="at">y =</span> total, <span class="at">label=</span>abb, <span class="at">color=</span>region) <span class="sc">+</span></span>
<span id="cb206-5"><a href="ggplot-and-dplyr.html#cb206-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb206-6"><a href="ggplot-and-dplyr.html#cb206-6" tabindex="-1"></a>  <span class="fu">geom_text</span>()</span></code></pre></div>
<p><img src="Data-Science-with-R_files/figure-html/unnamed-chunk-279-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>Then, we can also edit the attributes of the <code>geoms</code>. For example, let’s make the size of the points larger. To do this we edit inside <code>geom_points()</code>:</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="ggplot-and-dplyr.html#cb207-1" tabindex="-1"></a></span>
<span id="cb207-2"><a href="ggplot-and-dplyr.html#cb207-2" tabindex="-1"></a>murders <span class="sc">|&gt;</span></span>
<span id="cb207-3"><a href="ggplot-and-dplyr.html#cb207-3" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb207-4"><a href="ggplot-and-dplyr.html#cb207-4" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> population, <span class="at">y =</span> total, <span class="at">label=</span>abb, <span class="at">color=</span>region) <span class="sc">+</span></span>
<span id="cb207-5"><a href="ggplot-and-dplyr.html#cb207-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb207-6"><a href="ggplot-and-dplyr.html#cb207-6" tabindex="-1"></a>  <span class="fu">geom_text</span>()</span></code></pre></div>
<p><img src="Data-Science-with-R_files/figure-html/unnamed-chunk-280-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>Having increased the size of the points, we can no longer see the text of the state abbreviations well. We can nudge the text on the <em>x-axis</em> or on the <em>y-axis</em>. Since we are talking about several million people, let’s nudge the letters 1.5 million to the right.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="ggplot-and-dplyr.html#cb208-1" tabindex="-1"></a></span>
<span id="cb208-2"><a href="ggplot-and-dplyr.html#cb208-2" tabindex="-1"></a>murders <span class="sc">|&gt;</span></span>
<span id="cb208-3"><a href="ggplot-and-dplyr.html#cb208-3" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb208-4"><a href="ggplot-and-dplyr.html#cb208-4" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> population, <span class="at">y =</span> total, <span class="at">label=</span>abb, <span class="at">color=</span>region) <span class="sc">+</span></span>
<span id="cb208-5"><a href="ggplot-and-dplyr.html#cb208-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb208-6"><a href="ggplot-and-dplyr.html#cb208-6" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">nudge_x =</span> <span class="dv">1500000</span>)</span></code></pre></div>
<p><img src="Data-Science-with-R_files/figure-html/unnamed-chunk-281-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>To avoid entering such large numbers we can transform the population on the x-axis in the <code>aes()</code> function. Thus, once we express the data without counting the millions we would have to nudge the text only 1.5 points to the right:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="ggplot-and-dplyr.html#cb209-1" tabindex="-1"></a></span>
<span id="cb209-2"><a href="ggplot-and-dplyr.html#cb209-2" tabindex="-1"></a>murders <span class="sc">|&gt;</span></span>
<span id="cb209-3"><a href="ggplot-and-dplyr.html#cb209-3" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb209-4"><a href="ggplot-and-dplyr.html#cb209-4" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">y =</span> total, <span class="at">label=</span>abb, <span class="at">color=</span>region) <span class="sc">+</span></span>
<span id="cb209-5"><a href="ggplot-and-dplyr.html#cb209-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb209-6"><a href="ggplot-and-dplyr.html#cb209-6" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">nudge_x =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="Data-Science-with-R_files/figure-html/unnamed-chunk-282-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>This transformation gives us the same result as before and the <em>x-axis</em> is now easier to understand now that we can see the numbers.</p>
</div>
</div>
<div id="scale-layer" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Scale layer<a href="ggplot-and-dplyr.html#scale-layer" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Visually we can still improve our plot further. We see several data points concentrated in lower values and only a few extremes. In those cases it is better to have a view scaling the axes using logarithms. To do this, we will use the layers <code>scale_x_continuous()</code> and <code>scale_y_continuous()</code>. For example, if we want to transform the scale to base 2 logarithm we would have to add layers, but also change the value of <code>nudge_x</code>, due to the scale change:</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="ggplot-and-dplyr.html#cb210-1" tabindex="-1"></a></span>
<span id="cb210-2"><a href="ggplot-and-dplyr.html#cb210-2" tabindex="-1"></a>murders <span class="sc">|&gt;</span></span>
<span id="cb210-3"><a href="ggplot-and-dplyr.html#cb210-3" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb210-4"><a href="ggplot-and-dplyr.html#cb210-4" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">y =</span> total, <span class="at">label=</span>abb, <span class="at">color=</span>region) <span class="sc">+</span></span>
<span id="cb210-5"><a href="ggplot-and-dplyr.html#cb210-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb210-6"><a href="ggplot-and-dplyr.html#cb210-6" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">nudge_x =</span> <span class="fl">0.23</span>) <span class="sc">+</span></span>
<span id="cb210-7"><a href="ggplot-and-dplyr.html#cb210-7" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="sc">+</span></span>
<span id="cb210-8"><a href="ggplot-and-dplyr.html#cb210-8" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">&quot;log2&quot;</span>)</span></code></pre></div>
<p><img src="Data-Science-with-R_files/figure-html/unnamed-chunk-283-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>In the same way, we could do the transformation to base 10 logarithm:</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="ggplot-and-dplyr.html#cb211-1" tabindex="-1"></a></span>
<span id="cb211-2"><a href="ggplot-and-dplyr.html#cb211-2" tabindex="-1"></a>murders <span class="sc">|&gt;</span></span>
<span id="cb211-3"><a href="ggplot-and-dplyr.html#cb211-3" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb211-4"><a href="ggplot-and-dplyr.html#cb211-4" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">y =</span> total, <span class="at">label=</span>abb, <span class="at">color=</span>region) <span class="sc">+</span></span>
<span id="cb211-5"><a href="ggplot-and-dplyr.html#cb211-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb211-6"><a href="ggplot-and-dplyr.html#cb211-6" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">nudge_x =</span> <span class="fl">0.075</span>) <span class="sc">+</span></span>
<span id="cb211-7"><a href="ggplot-and-dplyr.html#cb211-7" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">&quot;log10&quot;</span>) <span class="sc">+</span></span>
<span id="cb211-8"><a href="ggplot-and-dplyr.html#cb211-8" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">&quot;log10&quot;</span>)</span></code></pre></div>
<p><img src="Data-Science-with-R_files/figure-html/unnamed-chunk-284-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>The transformation of the scale to base 10 logarithm is widely used in statistics and R provides us with a faster function to proceed with this scale transformation, the function <code>scale_x_log10()</code>, which gives us the same result as the previous plot.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="ggplot-and-dplyr.html#cb212-1" tabindex="-1"></a></span>
<span id="cb212-2"><a href="ggplot-and-dplyr.html#cb212-2" tabindex="-1"></a>murders <span class="sc">|&gt;</span></span>
<span id="cb212-3"><a href="ggplot-and-dplyr.html#cb212-3" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb212-4"><a href="ggplot-and-dplyr.html#cb212-4" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">y =</span> total, <span class="at">label=</span>abb, <span class="at">color=</span>region) <span class="sc">+</span></span>
<span id="cb212-5"><a href="ggplot-and-dplyr.html#cb212-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb212-6"><a href="ggplot-and-dplyr.html#cb212-6" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">nudge_x =</span> <span class="fl">0.075</span>) <span class="sc">+</span></span>
<span id="cb212-7"><a href="ggplot-and-dplyr.html#cb212-7" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb212-8"><a href="ggplot-and-dplyr.html#cb212-8" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()</span></code></pre></div>
<p><img src="Data-Science-with-R_files/figure-html/unnamed-chunk-285-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="label-title-and-legend-layer" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Label, title and legend layer<a href="ggplot-and-dplyr.html#label-title-and-legend-layer" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can also <a href="https://www.datanovia.com/en/blog/ggplot-legend-title-position-and-labels/">change the labels</a> (<code>label</code> in English) of the plot. So far on the <em>x-axis</em> we see that <strong>population/10^6</strong> appears and we can change it with the function <code>xlab()</code>. In the same way we can change on the <em>y-axis</em> using <code>ylab()</code>. To add a title to the plot we will use the function <code>ggtitle()</code>. To change the name of the legend we will use the function <code>scale_color_discrete()</code>.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="ggplot-and-dplyr.html#cb213-1" tabindex="-1"></a></span>
<span id="cb213-2"><a href="ggplot-and-dplyr.html#cb213-2" tabindex="-1"></a>murders <span class="sc">|&gt;</span></span>
<span id="cb213-3"><a href="ggplot-and-dplyr.html#cb213-3" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb213-4"><a href="ggplot-and-dplyr.html#cb213-4" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">y =</span> total, <span class="at">label=</span>abb, <span class="at">color=</span>region) <span class="sc">+</span></span>
<span id="cb213-5"><a href="ggplot-and-dplyr.html#cb213-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb213-6"><a href="ggplot-and-dplyr.html#cb213-6" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">nudge_x =</span> <span class="fl">0.075</span>) <span class="sc">+</span></span>
<span id="cb213-7"><a href="ggplot-and-dplyr.html#cb213-7" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb213-8"><a href="ggplot-and-dplyr.html#cb213-8" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb213-9"><a href="ggplot-and-dplyr.html#cb213-9" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Population expressed in millions (logarithmic scale)&quot;</span>) <span class="sc">+</span></span>
<span id="cb213-10"><a href="ggplot-and-dplyr.html#cb213-10" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Total number of murders (logarithmic scale)&quot;</span>) <span class="sc">+</span></span>
<span id="cb213-11"><a href="ggplot-and-dplyr.html#cb213-11" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Gun murders in the US in 2010&quot;</span>) <span class="sc">+</span></span>
<span id="cb213-12"><a href="ggplot-and-dplyr.html#cb213-12" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Regions&quot;</span>)</span></code></pre></div>
<p><img src="Data-Science-with-R_files/figure-html/unnamed-chunk-286-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="reference-lines" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Reference lines<a href="ggplot-and-dplyr.html#reference-lines" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can add reference lines, whether vertical with <code>geom_vline(xintercept = )</code>, horizontal with <code>geom_hline(yintercept = ...)</code> or diagonal with <code>geom_abline(intercept = )</code>, the latter asks us at what point it cuts the <em>y-axis</em> and draws a line with a default slope of 1.</p>
<p>For example, we could calculate the average of total murders and draw a horizontal reference line.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="ggplot-and-dplyr.html#cb214-1" tabindex="-1"></a></span>
<span id="cb214-2"><a href="ggplot-and-dplyr.html#cb214-2" tabindex="-1"></a><span class="co">#Calculate the average of the total</span></span>
<span id="cb214-3"><a href="ggplot-and-dplyr.html#cb214-3" tabindex="-1"></a>avg_total <span class="ot">&lt;-</span> <span class="fu">mean</span>(murders<span class="sc">$</span>total)</span>
<span id="cb214-4"><a href="ggplot-and-dplyr.html#cb214-4" tabindex="-1"></a></span>
<span id="cb214-5"><a href="ggplot-and-dplyr.html#cb214-5" tabindex="-1"></a><span class="co">#And add the horizontal reference line</span></span>
<span id="cb214-6"><a href="ggplot-and-dplyr.html#cb214-6" tabindex="-1"></a>murders <span class="sc">|&gt;</span></span>
<span id="cb214-7"><a href="ggplot-and-dplyr.html#cb214-7" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb214-8"><a href="ggplot-and-dplyr.html#cb214-8" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">y =</span> total, <span class="at">label=</span>abb, <span class="at">color=</span>region) <span class="sc">+</span></span>
<span id="cb214-9"><a href="ggplot-and-dplyr.html#cb214-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb214-10"><a href="ggplot-and-dplyr.html#cb214-10" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">nudge_x =</span> <span class="fl">0.075</span>) <span class="sc">+</span></span>
<span id="cb214-11"><a href="ggplot-and-dplyr.html#cb214-11" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb214-12"><a href="ggplot-and-dplyr.html#cb214-12" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb214-13"><a href="ggplot-and-dplyr.html#cb214-13" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Population expressed in millions (logarithmic scale)&quot;</span>) <span class="sc">+</span></span>
<span id="cb214-14"><a href="ggplot-and-dplyr.html#cb214-14" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Total number of murders (logarithmic scale)&quot;</span>) <span class="sc">+</span></span>
<span id="cb214-15"><a href="ggplot-and-dplyr.html#cb214-15" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Gun murders in the US in 2010&quot;</span>) <span class="sc">+</span></span>
<span id="cb214-16"><a href="ggplot-and-dplyr.html#cb214-16" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Regions&quot;</span>) <span class="sc">+</span></span>
<span id="cb214-17"><a href="ggplot-and-dplyr.html#cb214-17" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> avg_total)</span></code></pre></div>
<p><img src="Data-Science-with-R_files/figure-html/unnamed-chunk-287-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>Or we could calculate the murder rate per million inhabitants throughout the US and draw a reference diagonal. In the case of the diagonal we have to express it in the same scale of the axis, therefore we have to convert it to <code>log10</code>.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="ggplot-and-dplyr.html#cb215-1" tabindex="-1"></a></span>
<span id="cb215-2"><a href="ggplot-and-dplyr.html#cb215-2" tabindex="-1"></a><span class="co"># Calculate the average rate</span></span>
<span id="cb215-3"><a href="ggplot-and-dplyr.html#cb215-3" tabindex="-1"></a>ratio <span class="ot">&lt;-</span> <span class="fu">sum</span>(murders<span class="sc">$</span>total)<span class="sc">/</span><span class="fu">sum</span>(murders<span class="sc">$</span>population) <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">6</span></span>
<span id="cb215-4"><a href="ggplot-and-dplyr.html#cb215-4" tabindex="-1"></a></span>
<span id="cb215-5"><a href="ggplot-and-dplyr.html#cb215-5" tabindex="-1"></a><span class="co"># Calculate base 10 logarithm to obtain the intercept on the &quot;y-axis&quot;</span></span>
<span id="cb215-6"><a href="ggplot-and-dplyr.html#cb215-6" tabindex="-1"></a>ratio_log10 <span class="ot">&lt;-</span> <span class="fu">log10</span>(ratio)</span>
<span id="cb215-7"><a href="ggplot-and-dplyr.html#cb215-7" tabindex="-1"></a></span>
<span id="cb215-8"><a href="ggplot-and-dplyr.html#cb215-8" tabindex="-1"></a><span class="co">#And add the diagonal reference line</span></span>
<span id="cb215-9"><a href="ggplot-and-dplyr.html#cb215-9" tabindex="-1"></a>murders <span class="sc">|&gt;</span></span>
<span id="cb215-10"><a href="ggplot-and-dplyr.html#cb215-10" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb215-11"><a href="ggplot-and-dplyr.html#cb215-11" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">y =</span> total, <span class="at">label=</span>abb, <span class="at">color=</span>region) <span class="sc">+</span></span>
<span id="cb215-12"><a href="ggplot-and-dplyr.html#cb215-12" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb215-13"><a href="ggplot-and-dplyr.html#cb215-13" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">nudge_x =</span> <span class="fl">0.075</span>) <span class="sc">+</span></span>
<span id="cb215-14"><a href="ggplot-and-dplyr.html#cb215-14" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb215-15"><a href="ggplot-and-dplyr.html#cb215-15" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb215-16"><a href="ggplot-and-dplyr.html#cb215-16" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Population expressed in millions (logarithmic scale)&quot;</span>) <span class="sc">+</span></span>
<span id="cb215-17"><a href="ggplot-and-dplyr.html#cb215-17" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Total number of murders (logarithmic scale)&quot;</span>) <span class="sc">+</span></span>
<span id="cb215-18"><a href="ggplot-and-dplyr.html#cb215-18" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Gun murders in the US in 2010&quot;</span>) <span class="sc">+</span></span>
<span id="cb215-19"><a href="ggplot-and-dplyr.html#cb215-19" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Regions&quot;</span>) <span class="sc">+</span></span>
<span id="cb215-20"><a href="ggplot-and-dplyr.html#cb215-20" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> ratio_log10)</span></code></pre></div>
<p><img src="Data-Science-with-R_files/figure-html/unnamed-chunk-288-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>We can improve this reference line by making it dashed and gray. To do this, simply edit the <code>geom_abline()</code> function as follows:</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="ggplot-and-dplyr.html#cb216-1" tabindex="-1"></a></span>
<span id="cb216-2"><a href="ggplot-and-dplyr.html#cb216-2" tabindex="-1"></a>murders <span class="sc">|&gt;</span></span>
<span id="cb216-3"><a href="ggplot-and-dplyr.html#cb216-3" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb216-4"><a href="ggplot-and-dplyr.html#cb216-4" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">y =</span> total, <span class="at">label=</span>abb, <span class="at">color=</span>region) <span class="sc">+</span></span>
<span id="cb216-5"><a href="ggplot-and-dplyr.html#cb216-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb216-6"><a href="ggplot-and-dplyr.html#cb216-6" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">nudge_x =</span> <span class="fl">0.075</span>) <span class="sc">+</span></span>
<span id="cb216-7"><a href="ggplot-and-dplyr.html#cb216-7" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb216-8"><a href="ggplot-and-dplyr.html#cb216-8" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb216-9"><a href="ggplot-and-dplyr.html#cb216-9" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Population expressed in millions (logarithmic scale)&quot;</span>) <span class="sc">+</span></span>
<span id="cb216-10"><a href="ggplot-and-dplyr.html#cb216-10" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Total number of murders (logarithmic scale)&quot;</span>) <span class="sc">+</span></span>
<span id="cb216-11"><a href="ggplot-and-dplyr.html#cb216-11" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Gun murders in the US in 2010&quot;</span>) <span class="sc">+</span></span>
<span id="cb216-12"><a href="ggplot-and-dplyr.html#cb216-12" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Regions&quot;</span>) <span class="sc">+</span></span>
<span id="cb216-13"><a href="ggplot-and-dplyr.html#cb216-13" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> ratio_log10, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;darkgrey&quot;</span>)</span></code></pre></div>
<p><img src="Data-Science-with-R_files/figure-html/unnamed-chunk-289-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="changing-the-plot-style" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Changing the plot style<a href="ggplot-and-dplyr.html#changing-the-plot-style" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The plot style using <code>ggplot()</code> can be easily changed. There are multiple themes we can use by loading the <strong>ggthemes</strong> library. We can, for example, use a widely used theme: the economist theme by adding the <code>theme_economist()</code> layer.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="ggplot-and-dplyr.html#cb217-1" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb217-2"><a href="ggplot-and-dplyr.html#cb217-2" tabindex="-1"></a></span>
<span id="cb217-3"><a href="ggplot-and-dplyr.html#cb217-3" tabindex="-1"></a>murders <span class="sc">|&gt;</span></span>
<span id="cb217-4"><a href="ggplot-and-dplyr.html#cb217-4" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb217-5"><a href="ggplot-and-dplyr.html#cb217-5" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">y =</span> total, <span class="at">label=</span>abb, <span class="at">color=</span>region) <span class="sc">+</span></span>
<span id="cb217-6"><a href="ggplot-and-dplyr.html#cb217-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb217-7"><a href="ggplot-and-dplyr.html#cb217-7" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">nudge_x =</span> <span class="fl">0.075</span>) <span class="sc">+</span></span>
<span id="cb217-8"><a href="ggplot-and-dplyr.html#cb217-8" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb217-9"><a href="ggplot-and-dplyr.html#cb217-9" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb217-10"><a href="ggplot-and-dplyr.html#cb217-10" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Population expressed in millions (logarithmic scale)&quot;</span>) <span class="sc">+</span></span>
<span id="cb217-11"><a href="ggplot-and-dplyr.html#cb217-11" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Total number of murders (logarithmic scale)&quot;</span>) <span class="sc">+</span></span>
<span id="cb217-12"><a href="ggplot-and-dplyr.html#cb217-12" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Gun murders in the US in 2010&quot;</span>) <span class="sc">+</span></span>
<span id="cb217-13"><a href="ggplot-and-dplyr.html#cb217-13" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Regions&quot;</span>) <span class="sc">+</span></span>
<span id="cb217-14"><a href="ggplot-and-dplyr.html#cb217-14" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> ratio_log10, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;darkgrey&quot;</span>) <span class="sc">+</span></span>
<span id="cb217-15"><a href="ggplot-and-dplyr.html#cb217-15" tabindex="-1"></a>  <span class="fu">theme_economist</span>()</span></code></pre></div>
<p><img src="Data-Science-with-R_files/figure-html/unnamed-chunk-290-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>We still see overlapping abbreviations. We can make the names repel each other using the <code>geom_text_repel()</code> function instead of <code>geom_text()</code> that we are currently using. To use this function we need to call the <strong>ggrepel</strong> library.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="ggplot-and-dplyr.html#cb218-1" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb218-2"><a href="ggplot-and-dplyr.html#cb218-2" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb218-3"><a href="ggplot-and-dplyr.html#cb218-3" tabindex="-1"></a></span>
<span id="cb218-4"><a href="ggplot-and-dplyr.html#cb218-4" tabindex="-1"></a>murders <span class="sc">|&gt;</span></span>
<span id="cb218-5"><a href="ggplot-and-dplyr.html#cb218-5" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb218-6"><a href="ggplot-and-dplyr.html#cb218-6" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">y =</span> total, <span class="at">label=</span>abb, <span class="at">color=</span>region) <span class="sc">+</span></span>
<span id="cb218-7"><a href="ggplot-and-dplyr.html#cb218-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb218-8"><a href="ggplot-and-dplyr.html#cb218-8" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>() <span class="sc">+</span></span>
<span id="cb218-9"><a href="ggplot-and-dplyr.html#cb218-9" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb218-10"><a href="ggplot-and-dplyr.html#cb218-10" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb218-11"><a href="ggplot-and-dplyr.html#cb218-11" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Population expressed in millions (logarithmic scale)&quot;</span>) <span class="sc">+</span></span>
<span id="cb218-12"><a href="ggplot-and-dplyr.html#cb218-12" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Total number of murders (logarithmic scale)&quot;</span>) <span class="sc">+</span></span>
<span id="cb218-13"><a href="ggplot-and-dplyr.html#cb218-13" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Gun murders in the US in 2010&quot;</span>) <span class="sc">+</span></span>
<span id="cb218-14"><a href="ggplot-and-dplyr.html#cb218-14" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Regions&quot;</span>) <span class="sc">+</span></span>
<span id="cb218-15"><a href="ggplot-and-dplyr.html#cb218-15" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> ratio_log10, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;darkgrey&quot;</span>) <span class="sc">+</span></span>
<span id="cb218-16"><a href="ggplot-and-dplyr.html#cb218-16" tabindex="-1"></a>  <span class="fu">theme_economist</span>()</span>
<span id="cb218-17"><a href="ggplot-and-dplyr.html#cb218-17" tabindex="-1"></a><span class="co">#&gt; Warning: ggrepel: 1 unlabeled data points (too many overlaps). Consider</span></span>
<span id="cb218-18"><a href="ggplot-and-dplyr.html#cb218-18" tabindex="-1"></a><span class="co">#&gt; increasing max.overlaps</span></span></code></pre></div>
<p><img src="Data-Science-with-R_files/figure-html/unnamed-chunk-291-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>This plot is visually much easier to understand and aesthetically much better than the default plot we created in previous chapters. We can explore more examples at this <a href="https://rstudio-pubs-static.s3.amazonaws.com/228019_f0c39e05758a4a51b435b19dbd321c23.html">link</a>.</p>
</div>
<div id="summarizing-data-with-dplyr" class="section level2 hasAnchor" number="5.8">
<h2><span class="header-section-number">5.8</span> Summarizing data with dplyr<a href="ggplot-and-dplyr.html#summarizing-data-with-dplyr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An important part of exploratory analysis is knowing how to summarize a variable into data that is easy to understand.</p>
<p>The <code>tidyverse</code> package includes several packages, among them <code>dplyr</code> which makes it easier for us to summarize data from a variable. When we call the <code>tidyvere</code> library we are also calling all the functions of <code>dplyr</code>. To start using the functions of <code>dplyr</code> we are going to load the <code>heights</code> data frame which is in the <code>dslabs</code> library.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="ggplot-and-dplyr.html#cb219-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb219-2"><a href="ggplot-and-dplyr.html#cb219-2" tabindex="-1"></a><span class="fu">library</span>(dslabs)</span></code></pre></div>
<p>First let’s understand the <code>heights</code> data frame, we can apply pipeline and then use the <code>head()</code> function:</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="ggplot-and-dplyr.html#cb220-1" tabindex="-1"></a>heights <span class="sc">|&gt;</span> </span>
<span id="cb220-2"><a href="ggplot-and-dplyr.html#cb220-2" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb220-3"><a href="ggplot-and-dplyr.html#cb220-3" tabindex="-1"></a><span class="co">#&gt;      sex height</span></span>
<span id="cb220-4"><a href="ggplot-and-dplyr.html#cb220-4" tabindex="-1"></a><span class="co">#&gt; 1   Male     75</span></span>
<span id="cb220-5"><a href="ggplot-and-dplyr.html#cb220-5" tabindex="-1"></a><span class="co">#&gt; 2   Male     70</span></span>
<span id="cb220-6"><a href="ggplot-and-dplyr.html#cb220-6" tabindex="-1"></a><span class="co">#&gt; 3   Male     68</span></span>
<span id="cb220-7"><a href="ggplot-and-dplyr.html#cb220-7" tabindex="-1"></a><span class="co">#&gt; 4   Male     74</span></span>
<span id="cb220-8"><a href="ggplot-and-dplyr.html#cb220-8" tabindex="-1"></a><span class="co">#&gt; 5   Male     61</span></span>
<span id="cb220-9"><a href="ggplot-and-dplyr.html#cb220-9" tabindex="-1"></a><span class="co">#&gt; 6 Female     65</span></span></code></pre></div>
<p>This data frame corresponds to the list of attributes of students in a university, where the <code>height</code> column indicates the height of each one in inches.</p>
<p>Finally, let’s add the column <code>height_m</code> where we will transform the height to meters. Remember that a meter has 39.37 inches. Let’s store the result in the variable <code>heights_m</code>.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="ggplot-and-dplyr.html#cb221-1" tabindex="-1"></a>heights_m <span class="ot">&lt;-</span> heights <span class="sc">|&gt;</span> </span>
<span id="cb221-2"><a href="ggplot-and-dplyr.html#cb221-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">height_m =</span> height<span class="sc">/</span><span class="fl">39.37</span>)</span>
<span id="cb221-3"><a href="ggplot-and-dplyr.html#cb221-3" tabindex="-1"></a></span>
<span id="cb221-4"><a href="ggplot-and-dplyr.html#cb221-4" tabindex="-1"></a>heights_m <span class="sc">|&gt;</span> </span>
<span id="cb221-5"><a href="ggplot-and-dplyr.html#cb221-5" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb221-6"><a href="ggplot-and-dplyr.html#cb221-6" tabindex="-1"></a><span class="co">#&gt;      sex height height_m</span></span>
<span id="cb221-7"><a href="ggplot-and-dplyr.html#cb221-7" tabindex="-1"></a><span class="co">#&gt; 1   Male     75 1.905004</span></span>
<span id="cb221-8"><a href="ggplot-and-dplyr.html#cb221-8" tabindex="-1"></a><span class="co">#&gt; 2   Male     70 1.778004</span></span>
<span id="cb221-9"><a href="ggplot-and-dplyr.html#cb221-9" tabindex="-1"></a><span class="co">#&gt; 3   Male     68 1.727203</span></span>
<span id="cb221-10"><a href="ggplot-and-dplyr.html#cb221-10" tabindex="-1"></a><span class="co">#&gt; 4   Male     74 1.879604</span></span>
<span id="cb221-11"><a href="ggplot-and-dplyr.html#cb221-11" tabindex="-1"></a><span class="co">#&gt; 5   Male     61 1.549403</span></span>
<span id="cb221-12"><a href="ggplot-and-dplyr.html#cb221-12" tabindex="-1"></a><span class="co">#&gt; 6 Female     65 1.651003</span></span></code></pre></div>
<p>The fastest way to summarize a list of data is indicating what the average is and how much its <a href="https://support.minitab.com/en-us/minitab/18/help-and-how-to/statistics/basic-statistics/supporting-topics/data-concepts/what-is-the-standard-deviation/">standard deviation</a><a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a> is. If we wanted to obtain the average we would use the <code>mean()</code> function and <code>sd()</code> to obtain the standard deviation. For example:</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="ggplot-and-dplyr.html#cb222-1" tabindex="-1"></a>avg <span class="ot">&lt;-</span> <span class="fu">mean</span>(heights_m<span class="sc">$</span>height_m)</span>
<span id="cb222-2"><a href="ggplot-and-dplyr.html#cb222-2" tabindex="-1"></a>std_dev <span class="ot">&lt;-</span> <span class="fu">sd</span>(heights_m<span class="sc">$</span>height_m)</span></code></pre></div>
<p>However, this summarizes all students for us without considering whether men could be on average taller than women. If we wanted to calculate the average and std. dev. we would have to filter first, then store in a variable and finally calculate the average and standard deviation. This is impractical and for that <code>dplyr</code> grants us the <code>summarize()</code> function.</p>
<div id="summarize-function" class="section level3 hasAnchor" number="5.8.1">
<h3><span class="header-section-number">5.8.1</span> Summarize function<a href="ggplot-and-dplyr.html#summarize-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can use the <code>summarize</code> function using the pipeline operator. Thus, we could calculate the average and std. dev. in this way:</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="ggplot-and-dplyr.html#cb223-1" tabindex="-1"></a>heights_m <span class="sc">|&gt;</span></span>
<span id="cb223-2"><a href="ggplot-and-dplyr.html#cb223-2" tabindex="-1"></a>    <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">&quot;Male&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb223-3"><a href="ggplot-and-dplyr.html#cb223-3" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">avg =</span> <span class="fu">mean</span>(height_m), <span class="at">std_dev =</span> <span class="fu">sd</span>(height_m))</span>
<span id="cb223-4"><a href="ggplot-and-dplyr.html#cb223-4" tabindex="-1"></a><span class="co">#&gt;        avg    std_dev</span></span>
<span id="cb223-5"><a href="ggplot-and-dplyr.html#cb223-5" tabindex="-1"></a><span class="co">#&gt; 1 1.760598 0.09172018</span></span></code></pre></div>
<p>This function also generates a data frame for us. We can validate it if we store the result in the variable <code>heights_m_male</code> and then report the <em>class</em> of the variable:</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="ggplot-and-dplyr.html#cb224-1" tabindex="-1"></a>heights_m_male <span class="ot">&lt;-</span> heights_m <span class="sc">|&gt;</span></span>
<span id="cb224-2"><a href="ggplot-and-dplyr.html#cb224-2" tabindex="-1"></a>    <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">&quot;Male&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb224-3"><a href="ggplot-and-dplyr.html#cb224-3" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">avg =</span> <span class="fu">mean</span>(height_m), <span class="at">std_dev =</span> <span class="fu">sd</span>(height_m))</span>
<span id="cb224-4"><a href="ggplot-and-dplyr.html#cb224-4" tabindex="-1"></a></span>
<span id="cb224-5"><a href="ggplot-and-dplyr.html#cb224-5" tabindex="-1"></a><span class="fu">class</span>(heights_m_male)</span>
<span id="cb224-6"><a href="ggplot-and-dplyr.html#cb224-6" tabindex="-1"></a><span class="co">#&gt; [1] &quot;data.frame&quot;</span></span></code></pre></div>
<p>We can report the data frame <code>heights_m_male</code> and use it for future analyzes accessing with the accessor <code>$</code>.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="ggplot-and-dplyr.html#cb225-1" tabindex="-1"></a>heights_m_male</span>
<span id="cb225-2"><a href="ggplot-and-dplyr.html#cb225-2" tabindex="-1"></a><span class="co">#&gt;        avg    std_dev</span></span>
<span id="cb225-3"><a href="ggplot-and-dplyr.html#cb225-3" tabindex="-1"></a><span class="co">#&gt; 1 1.760598 0.09172018</span></span></code></pre></div>
<p>We see that the average height of men is 1.76 meters with a standard deviation of 0.09 meters.</p>
<p>In the same way, we can use <code>summarize</code> to calculate other functions such as:</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="ggplot-and-dplyr.html#cb226-1" tabindex="-1"></a>heights_m <span class="sc">|&gt;</span></span>
<span id="cb226-2"><a href="ggplot-and-dplyr.html#cb226-2" tabindex="-1"></a>    <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">&quot;Male&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb226-3"><a href="ggplot-and-dplyr.html#cb226-3" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">min_val =</span> <span class="fu">min</span>(height_m), <span class="at">max_val =</span> <span class="fu">max</span>(height_m), <span class="at">median_val =</span> <span class="fu">median</span>(height_m))</span>
<span id="cb226-4"><a href="ggplot-and-dplyr.html#cb226-4" tabindex="-1"></a><span class="co">#&gt;    min_val  max_val median_val</span></span>
<span id="cb226-5"><a href="ggplot-and-dplyr.html#cb226-5" tabindex="-1"></a><span class="co">#&gt; 1 1.270003 2.100004   1.752604</span></span></code></pre></div>
<p>The tallest student measures more than 2.1 meters. Half of the male students measure more than 1.75 meters.</p>
<p>However, we would now have to change to “Female” to calculate the data for women. We need to group and then summarize the data taking into account the grouping. For this there is the function <code>group_by()</code></p>
</div>
<div id="group-by-function" class="section level3 hasAnchor" number="5.8.2">
<h3><span class="header-section-number">5.8.2</span> Group By Function<a href="ggplot-and-dplyr.html#group-by-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This function allows us to create grouped data frames which makes it easier for us to summarize the data. We would only have to select based on what we want to group and no longer filter by sex. In this case the grouping would be based on the <code>sex</code> column:</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="ggplot-and-dplyr.html#cb227-1" tabindex="-1"></a>heights_m <span class="sc">|&gt;</span></span>
<span id="cb227-2"><a href="ggplot-and-dplyr.html#cb227-2" tabindex="-1"></a>    <span class="fu">group_by</span>(sex) <span class="sc">|&gt;</span> </span>
<span id="cb227-3"><a href="ggplot-and-dplyr.html#cb227-3" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">avg =</span> <span class="fu">mean</span>(height_m), <span class="at">std_dev =</span> <span class="fu">sd</span>(height_m))</span>
<span id="cb227-4"><a href="ggplot-and-dplyr.html#cb227-4" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 3</span></span>
<span id="cb227-5"><a href="ggplot-and-dplyr.html#cb227-5" tabindex="-1"></a><span class="co">#&gt;   sex      avg std_dev</span></span>
<span id="cb227-6"><a href="ggplot-and-dplyr.html#cb227-6" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;  &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span id="cb227-7"><a href="ggplot-and-dplyr.html#cb227-7" tabindex="-1"></a><span class="co">#&gt; 1 Female  1.65  0.0955</span></span>
<span id="cb227-8"><a href="ggplot-and-dplyr.html#cb227-8" tabindex="-1"></a><span class="co">#&gt; 2 Male    1.76  0.0917</span></span></code></pre></div>
<p>On average, women are shorter than men.</p>
<p>If we now remember our danger case in the US. We can calculate the ratio of total crimes regarding the population and then compare it by region in this way:</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="ggplot-and-dplyr.html#cb228-1" tabindex="-1"></a>murders <span class="sc">|&gt;</span> </span>
<span id="cb228-2"><a href="ggplot-and-dplyr.html#cb228-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ratio =</span> total <span class="sc">/</span> population <span class="sc">*</span> <span class="dv">100000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb228-3"><a href="ggplot-and-dplyr.html#cb228-3" tabindex="-1"></a>  <span class="fu">group_by</span>(region) <span class="sc">|&gt;</span> </span>
<span id="cb228-4"><a href="ggplot-and-dplyr.html#cb228-4" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_ratio =</span> <span class="fu">mean</span>(ratio))</span>
<span id="cb228-5"><a href="ggplot-and-dplyr.html#cb228-5" tabindex="-1"></a><span class="co">#&gt; # A tibble: 4 × 2</span></span>
<span id="cb228-6"><a href="ggplot-and-dplyr.html#cb228-6" tabindex="-1"></a><span class="co">#&gt;   region        avg_ratio</span></span>
<span id="cb228-7"><a href="ggplot-and-dplyr.html#cb228-7" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;             &lt;dbl&gt;</span></span>
<span id="cb228-8"><a href="ggplot-and-dplyr.html#cb228-8" tabindex="-1"></a><span class="co">#&gt; 1 Northeast          1.85</span></span>
<span id="cb228-9"><a href="ggplot-and-dplyr.html#cb228-9" tabindex="-1"></a><span class="co">#&gt; 2 South              4.42</span></span>
<span id="cb228-10"><a href="ggplot-and-dplyr.html#cb228-10" tabindex="-1"></a><span class="co">#&gt; 3 North Central      2.18</span></span>
<span id="cb228-11"><a href="ggplot-and-dplyr.html#cb228-11" tabindex="-1"></a><span class="co">#&gt; 4 West               1.83</span></span></code></pre></div>
<p>On average, the South region is more dangerous.</p>
</div>
</div>
<div id="exercises-5" class="section level2 hasAnchor" number="5.9">
<h2><span class="header-section-number">5.9</span> Exercises<a href="ggplot-and-dplyr.html#exercises-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This time we are going to perform exercises within the field of biology and for this we must remember the parts of a flower. This way we will give more sense to the problem:</p>
<p><img src="_assets/images/03-visualization/partes-de-flor.png" alt="Botanical diagram showing flower parts: sepal, petal, stamen, and pistil" width="150pt" style="display: block; margin: auto;" /></p>
<ol start="53" style="list-style-type: decimal">
<li>Load the <code>iris</code> data frame to your variable environment (<code>data(iris)</code>). In this data frame we find a list of characteristics of 150 flowers of 3 different types of species. Report a scatter plot of the sepal and petal length of the <code>iris</code> data frame.</li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="ggplot-and-dplyr.html#cb229-1" tabindex="-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb229-2"><a href="ggplot-and-dplyr.html#cb229-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb229-3"><a href="ggplot-and-dplyr.html#cb229-3" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Petal.Length) <span class="sc">+</span></span>
<span id="cb229-4"><a href="ggplot-and-dplyr.html#cb229-4" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
</details>
<ol start="54" style="list-style-type: decimal">
<li>From the visualization created in the previous question, color the points according to the species to which it belongs.</li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="ggplot-and-dplyr.html#cb230-1" tabindex="-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb230-2"><a href="ggplot-and-dplyr.html#cb230-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb230-3"><a href="ggplot-and-dplyr.html#cb230-3" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Petal.Length, <span class="at">color =</span> Species) <span class="sc">+</span></span>
<span id="cb230-4"><a href="ggplot-and-dplyr.html#cb230-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
</details>
<ol start="55" style="list-style-type: decimal">
<li>Modify your previous plot so that the following elements appear:</li>
</ol>
<ul>
<li>Chart title: Relationship between sepal and petal size of different flowers</li>
<li>X-axis label: Sepal length (in cm)</li>
<li>Y-axis label: Petal length (in cm)</li>
<li>Legend title: Species</li>
</ul>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="ggplot-and-dplyr.html#cb231-1" tabindex="-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb231-2"><a href="ggplot-and-dplyr.html#cb231-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb231-3"><a href="ggplot-and-dplyr.html#cb231-3" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Petal.Length, <span class="at">color =</span> Species) <span class="sc">+</span></span>
<span id="cb231-4"><a href="ggplot-and-dplyr.html#cb231-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb231-5"><a href="ggplot-and-dplyr.html#cb231-5" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Sepal length (in cm)&quot;</span>) <span class="sc">+</span></span>
<span id="cb231-6"><a href="ggplot-and-dplyr.html#cb231-6" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Petal length (in cm)&quot;</span>) <span class="sc">+</span></span>
<span id="cb231-7"><a href="ggplot-and-dplyr.html#cb231-7" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Relationship between sepal and petal size of different flowers&quot;</span>) <span class="sc">+</span></span>
<span id="cb231-8"><a href="ggplot-and-dplyr.html#cb231-8" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Species&quot;</span>)</span></code></pre></div>
</details>
<ol start="56" style="list-style-type: decimal">
<li>Calculate a summary of the ratio between sepal length and petal length. This summary should show a data frame with the average, standard deviation and median of the ratio of these two dimensions mentioned.</li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="ggplot-and-dplyr.html#cb232-1" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb232-2"><a href="ggplot-and-dplyr.html#cb232-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ratio =</span> Sepal.Length <span class="sc">/</span> Petal.Length) <span class="sc">|&gt;</span> </span>
<span id="cb232-3"><a href="ggplot-and-dplyr.html#cb232-3" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">promedio =</span> <span class="fu">mean</span>(ratio), <span class="at">std_dev =</span> <span class="fu">sd</span>(ratio), <span class="at">median_val =</span> <span class="fu">median</span>(ratio))</span></code></pre></div>
</details>
<ol start="57" style="list-style-type: decimal">
<li>Make a summary of the ratio between sepal and petal length showing one row per species.</li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="ggplot-and-dplyr.html#cb233-1" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb233-2"><a href="ggplot-and-dplyr.html#cb233-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ratio =</span> Sepal.Length <span class="sc">/</span> Petal.Length) <span class="sc">|&gt;</span> </span>
<span id="cb233-3"><a href="ggplot-and-dplyr.html#cb233-3" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">|&gt;</span> </span>
<span id="cb233-4"><a href="ggplot-and-dplyr.html#cb233-4" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">promedio =</span> <span class="fu">mean</span>(ratio), <span class="at">std_dev =</span> <span class="fu">sd</span>(ratio), <span class="at">median_val =</span> <span class="fu">median</span>(ratio))</span></code></pre></div>
</details>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="6">
<li id="fn6"><p>What is the standard deviation?<a href="ggplot-and-dplyr.html#fnref6" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="advanced-techniques.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="gapminder.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": true,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": null
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": null,
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
