<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Data import and consolidation | Data Science with R</title>
  <meta name="description" content="A comprehensive guide to data science using R, covering fundamentals, visualization, statistics, machine learning with tidymodels, and generative AI integration. Second Edition by Daniel Paredes." />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Data import and consolidation | Data Science with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A comprehensive guide to data science using R, covering fundamentals, visualization, statistics, machine learning with tidymodels, and generative AI integration. Second Edition by Daniel Paredes." />
  <meta name="github-repo" content="dparedesi/Data-Science-with-R-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Data import and consolidation | Data Science with R" />
  
  <meta name="twitter:description" content="A comprehensive guide to data science using R, covering fundamentals, visualization, statistics, machine learning with tidymodels, and generative AI integration. Second Edition by Daniel Paredes." />
  

<meta name="author" content="Author: Mg. Daniel Paredes Inilupu" />


<meta name="date" content="2025-12-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-1.html"/>
<link rel="next" href="string-processing-and-text-mining.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics: Sin Vista -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VJJ963010J"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-VJJ963010J');
</script>

<!-- Global site tag (gtag.js) - Google Analytics: Vista -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-165839710-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-165839710-1');
</script>

<!-- Global site tag (gtag.js) - Google Analytics: Agentedec4mbio -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-17876479-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-17876479-1');
</script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Science with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="acknowledgments.html"><a href="acknowledgments.html"><i class="fa fa-check"></i>Acknowledgments</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#why-r"><i class="fa fa-check"></i>Why R?</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#installing-r"><i class="fa fa-check"></i>Installing R</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#installing-rstudio"><i class="fa fa-check"></i>Installing RStudio</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#rstudio-sections"><i class="fa fa-check"></i>RStudio Sections</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#testing-rstudio"><i class="fa fa-check"></i>Testing RStudio</a></li>
</ul></li>
<li class="part"><span><b>I Fundamentals and Key Tools</b></span></li>
<li class="chapter" data-level="1" data-path="objects.html"><a href="objects.html"><i class="fa fa-check"></i><b>1</b> Objects</a>
<ul>
<li class="chapter" data-level="1.1" data-path="objects.html"><a href="objects.html#what-are-objects-in-r"><i class="fa fa-check"></i><b>1.1</b> What are objects in R?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="objects.html"><a href="objects.html#r-as-an-object-oriented-language"><i class="fa fa-check"></i><b>1.1.1</b> R as an object-oriented language</a></li>
<li class="chapter" data-level="1.1.2" data-path="objects.html"><a href="objects.html#the-power-of-abstraction"><i class="fa fa-check"></i><b>1.1.2</b> The power of abstraction</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="objects.html"><a href="objects.html#variables-the-first-objects-on-your-journey"><i class="fa fa-check"></i><b>1.2</b> Variables: The first objects on your journey</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="objects.html"><a href="objects.html#creating-variables-in-r"><i class="fa fa-check"></i><b>1.2.1</b> Creating variables in R</a></li>
<li class="chapter" data-level="1.2.2" data-path="objects.html"><a href="objects.html#operations-with-variables"><i class="fa fa-check"></i><b>1.2.2</b> Operations with variables</a></li>
<li class="chapter" data-level="1.2.3" data-path="objects.html"><a href="objects.html#best-practices-for-naming-variables"><i class="fa fa-check"></i><b>1.2.3</b> Best practices for naming variables</a></li>
<li class="chapter" data-level="1.2.4" data-path="objects.html"><a href="objects.html#data-types"><i class="fa fa-check"></i><b>1.2.4</b> Data types</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="objects.html"><a href="objects.html#object-types-for-complex-data"><i class="fa fa-check"></i><b>1.3</b> Object types for complex data</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="objects.html"><a href="objects.html#vectors-organizing-information-of-the-same-type"><i class="fa fa-check"></i><b>1.3.1</b> Vectors: organizing information of the same type</a></li>
<li class="chapter" data-level="1.3.2" data-path="objects.html"><a href="objects.html#lists-grouping-objects-of-different-types"><i class="fa fa-check"></i><b>1.3.2</b> Lists: grouping objects of different types</a></li>
<li class="chapter" data-level="1.3.3" data-path="objects.html"><a href="objects.html#matrices-organizing-data-in-rows-and-columns"><i class="fa fa-check"></i><b>1.3.3</b> Matrices: organizing data in rows and columns</a></li>
<li class="chapter" data-level="1.3.4" data-path="objects.html"><a href="objects.html#arrays-multidimensional-matrices"><i class="fa fa-check"></i><b>1.3.4</b> Arrays: multidimensional matrices</a></li>
<li class="chapter" data-level="1.3.5" data-path="objects.html"><a href="objects.html#factors-representing-categorical-data"><i class="fa fa-check"></i><b>1.3.5</b> Factors: representing categorical data</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="objects.html"><a href="objects.html#the-universe-of-objects-in-r"><i class="fa fa-check"></i><b>1.4</b> The Universe of Objects in R</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="objects.html"><a href="objects.html#philosophy-of-objects-in-r"><i class="fa fa-check"></i><b>1.4.1</b> Philosophy of objects in R</a></li>
<li class="chapter" data-level="1.4.2" data-path="objects.html"><a href="objects.html#comparison-with-other-languages"><i class="fa fa-check"></i><b>1.4.2</b> Comparison with other languages</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="objects.html"><a href="objects.html#exercises"><i class="fa fa-check"></i><b>1.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>2</b> Functions</a>
<ul>
<li class="chapter" data-level="2.1" data-path="functions.html"><a href="functions.html#introduction-to-the-world-of-functions"><i class="fa fa-check"></i><b>2.1</b> Introduction to the world of functions</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="functions.html"><a href="functions.html#what-are-functions"><i class="fa fa-check"></i><b>2.1.1</b> What are functions?</a></li>
<li class="chapter" data-level="2.1.2" data-path="functions.html"><a href="functions.html#why-use-functions"><i class="fa fa-check"></i><b>2.1.2</b> Why use functions?</a></li>
<li class="chapter" data-level="2.1.3" data-path="functions.html"><a href="functions.html#first-functions-exploring-basic-r-functions"><i class="fa fa-check"></i><b>2.1.3</b> First functions: exploring basic R functions</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="functions.html"><a href="functions.html#anatomy-of-a-function"><i class="fa fa-check"></i><b>2.2</b> Anatomy of a function</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="functions.html"><a href="functions.html#arguments-the-ingredients-of-the-function"><i class="fa fa-check"></i><b>2.2.1</b> Arguments: the ingredients of the function</a></li>
<li class="chapter" data-level="2.2.2" data-path="functions.html"><a href="functions.html#body-the-instructions-of-the-function"><i class="fa fa-check"></i><b>2.2.2</b> Body: the instructions of the function</a></li>
<li class="chapter" data-level="2.2.3" data-path="functions.html"><a href="functions.html#return-value-the-result-of-the-function"><i class="fa fa-check"></i><b>2.2.3</b> Return value: the result of the function</a></li>
<li class="chapter" data-level="2.2.4" data-path="functions.html"><a href="functions.html#examples-creating-simple-functions-step-by-step"><i class="fa fa-check"></i><b>2.2.4</b> Examples: creating simple functions step by step</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="functions.html"><a href="functions.html#mastering-the-use-of-functions"><i class="fa fa-check"></i><b>2.3</b> Mastering the use of functions</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="functions.html"><a href="functions.html#functions-with-a-variable-number-of-arguments-...-adapting-to-different-situations"><i class="fa fa-check"></i><b>2.3.1</b> Functions with a variable number of arguments (<code>...</code>): Adapting to different situations</a></li>
<li class="chapter" data-level="2.3.2" data-path="functions.html"><a href="functions.html#variable-scope-local-and-global-variables"><i class="fa fa-check"></i><b>2.3.2</b> Variable scope: local and global variables</a></li>
<li class="chapter" data-level="2.3.3" data-path="functions.html"><a href="functions.html#examples-functions-to-calculate-taxes-discounts-etc."><i class="fa fa-check"></i><b>2.3.3</b> Examples: functions to calculate taxes, discounts, etc.</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="functions.html"><a href="functions.html#higher-order-functions"><i class="fa fa-check"></i><b>2.4</b> Higher-order functions</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="functions.html"><a href="functions.html#lapply-and-sapply-applying-a-function-to-each-element"><i class="fa fa-check"></i><b>2.4.1</b> <code>lapply()</code> and <code>sapply()</code>: applying a function to each element</a></li>
<li class="chapter" data-level="2.4.2" data-path="functions.html"><a href="functions.html#apply-applying-a-function-to-rows-or-columns"><i class="fa fa-check"></i><b>2.4.2</b> <code>apply()</code>: applying a function to rows or columns</a></li>
<li class="chapter" data-level="2.4.3" data-path="functions.html"><a href="functions.html#mapply-applying-a-function-to-multiple-arguments"><i class="fa fa-check"></i><b>2.4.3</b> <code>mapply()</code>: applying a function to multiple arguments</a></li>
<li class="chapter" data-level="2.4.4" data-path="functions.html"><a href="functions.html#examples-data-analysis-with-higher-order-functions"><i class="fa fa-check"></i><b>2.4.4</b> Examples: data analysis with higher-order functions</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="functions.html"><a href="functions.html#closures-functions-with-memory"><i class="fa fa-check"></i><b>2.5</b> Closures: functions with memory</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="functions.html"><a href="functions.html#concept-functions-that-remember"><i class="fa fa-check"></i><b>2.5.1</b> Concept: functions that “remember”</a></li>
<li class="chapter" data-level="2.5.2" data-path="functions.html"><a href="functions.html#applications-creating-counters-functions-with-internal-state"><i class="fa fa-check"></i><b>2.5.2</b> Applications: creating counters, functions with internal state</a></li>
<li class="chapter" data-level="2.5.3" data-path="functions.html"><a href="functions.html#examples-simulating-a-game-creating-an-operation-history"><i class="fa fa-check"></i><b>2.5.3</b> Examples: simulating a game, creating an operation history</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="functions.html"><a href="functions.html#debugging-and-error-handling-solving-the-mysteries-of-your-code"><i class="fa fa-check"></i><b>2.6</b> Debugging and error handling: solving the mysteries of your code</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="functions.html"><a href="functions.html#identifying-errors-common-error-messages-in-r"><i class="fa fa-check"></i><b>2.6.1</b> Identifying errors: common error messages in R</a></li>
<li class="chapter" data-level="2.6.2" data-path="functions.html"><a href="functions.html#debugging-tools-debug-traceback"><i class="fa fa-check"></i><b>2.6.2</b> Debugging tools: <code>debug()</code>, <code>traceback()</code></a></li>
<li class="chapter" data-level="2.6.3" data-path="functions.html"><a href="functions.html#error-handling-trycatch"><i class="fa fa-check"></i><b>2.6.3</b> Error handling: <code>tryCatch()</code></a></li>
<li class="chapter" data-level="2.6.4" data-path="functions.html"><a href="functions.html#examples-debugging-functions-with-errors-handling-exceptions"><i class="fa fa-check"></i><b>2.6.4</b> Examples: debugging functions with errors, handling exceptions</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="functions.html"><a href="functions.html#exercises-1"><i class="fa fa-check"></i><b>2.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-frames.html"><a href="data-frames.html"><i class="fa fa-check"></i><b>3</b> Data Frames</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-frames.html"><a href="data-frames.html#introduction-to-data-frames"><i class="fa fa-check"></i><b>3.1</b> Introduction to Data Frames</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-frames.html"><a href="data-frames.html#what-are-data-frames"><i class="fa fa-check"></i><b>3.1.1</b> What are data frames?</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-frames.html"><a href="data-frames.html#why-data-frames"><i class="fa fa-check"></i><b>3.1.2</b> Why data frames?</a></li>
<li class="chapter" data-level="3.1.3" data-path="data-frames.html"><a href="data-frames.html#data-frames-in-action-exploring-information-about-the-united-states"><i class="fa fa-check"></i><b>3.1.3</b> Data Frames in action: exploring information about the United States</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-frames.html"><a href="data-frames.html#creating-data-frames-building-your-database-for-the-move"><i class="fa fa-check"></i><b>3.2</b> Creating Data Frames: Building your database for the move</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-frames.html"><a href="data-frames.html#importing-data-from-files-csv-excel"><i class="fa fa-check"></i><b>3.2.1</b> Importing data from files: CSV, Excel</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-frames.html"><a href="data-frames.html#creating-data-frames-manually"><i class="fa fa-check"></i><b>3.2.2</b> Creating data frames manually</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-frames.html"><a href="data-frames.html#examples"><i class="fa fa-check"></i><b>3.2.3</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-frames.html"><a href="data-frames.html#exploring-data-frames-discovering-the-secrets-of-your-data"><i class="fa fa-check"></i><b>3.3</b> Exploring Data Frames: Discovering the secrets of your data</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-frames.html"><a href="data-frames.html#accessing-rows-columns-and-cells"><i class="fa fa-check"></i><b>3.3.1</b> Accessing rows, columns, and cells</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-frames.html"><a href="data-frames.html#functions-for-exploring-data-frames"><i class="fa fa-check"></i><b>3.3.2</b> Functions for exploring data frames</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-frames.html"><a href="data-frames.html#examples-exploring-data-frames-with-move-information"><i class="fa fa-check"></i><b>3.3.3</b> Examples: exploring data frames with move information</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-frames.html"><a href="data-frames.html#manipulating-data-frames-transforming-your-data"><i class="fa fa-check"></i><b>3.4</b> Manipulating Data Frames: Transforming your data</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-frames.html"><a href="data-frames.html#introduction-to-the-pipeline-operator"><i class="fa fa-check"></i><b>3.4.1</b> Introduction to the pipeline operator (<code>|&gt;</code>)</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-frames.html"><a href="data-frames.html#transforming-a-table-with-mutate"><i class="fa fa-check"></i><b>3.4.2</b> Transforming a table with <code>mutate()</code></a></li>
<li class="chapter" data-level="3.4.3" data-path="data-frames.html"><a href="data-frames.html#filtering-data-selecting-cities-that-interest-you"><i class="fa fa-check"></i><b>3.4.3</b> Filtering data: selecting cities that interest you</a></li>
<li class="chapter" data-level="3.4.4" data-path="data-frames.html"><a href="data-frames.html#sorting-data-finding-the-safest-cities"><i class="fa fa-check"></i><b>3.4.4</b> Sorting data: finding the safest cities</a></li>
<li class="chapter" data-level="3.4.5" data-path="data-frames.html"><a href="data-frames.html#aggregating-and-summarizing-data-obtaining-general-overview"><i class="fa fa-check"></i><b>3.4.5</b> Aggregating and summarizing data: obtaining general overview</a></li>
<li class="chapter" data-level="3.4.6" data-path="data-frames.html"><a href="data-frames.html#joining-data-frames-combining-information"><i class="fa fa-check"></i><b>3.4.6</b> Joining data frames: combining information</a></li>
<li class="chapter" data-level="3.4.7" data-path="data-frames.html"><a href="data-frames.html#examples-1"><i class="fa fa-check"></i><b>3.4.7</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-frames.html"><a href="data-frames.html#exercises-2"><i class="fa fa-check"></i><b>3.5</b> Exercises</a></li>
<li class="chapter" data-level="3.6" data-path="data-frames.html"><a href="data-frames.html#data-frames-in-plots"><i class="fa fa-check"></i><b>3.6</b> Data frames in plots</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="data-frames.html"><a href="data-frames.html#scatter-plots"><i class="fa fa-check"></i><b>3.6.1</b> Scatter plots</a></li>
<li class="chapter" data-level="3.6.2" data-path="data-frames.html"><a href="data-frames.html#histograms"><i class="fa fa-check"></i><b>3.6.2</b> Histograms</a></li>
<li class="chapter" data-level="3.6.3" data-path="data-frames.html"><a href="data-frames.html#box-plot"><i class="fa fa-check"></i><b>3.6.3</b> Box plot</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="data-frames.html"><a href="data-frames.html#data-interpretation"><i class="fa fa-check"></i><b>3.7</b> Data interpretation</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="data-frames.html"><a href="data-frames.html#quartiles"><i class="fa fa-check"></i><b>3.7.1</b> Quartiles</a></li>
<li class="chapter" data-level="3.7.2" data-path="data-frames.html"><a href="data-frames.html#interpretation-of-box-plot"><i class="fa fa-check"></i><b>3.7.2</b> Interpretation of box plot</a></li>
<li class="chapter" data-level="3.7.3" data-path="data-frames.html"><a href="data-frames.html#examples-2"><i class="fa fa-check"></i><b>3.7.3</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="data-frames.html"><a href="data-frames.html#exercises-3"><i class="fa fa-check"></i><b>3.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="advanced-techniques.html"><a href="advanced-techniques.html"><i class="fa fa-check"></i><b>4</b> Advanced Techniques</a>
<ul>
<li class="chapter" data-level="4.1" data-path="advanced-techniques.html"><a href="advanced-techniques.html#metaprogramming-writing-code-that-writes-code"><i class="fa fa-check"></i><b>4.1</b> Metaprogramming: writing code that writes code</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="advanced-techniques.html"><a href="advanced-techniques.html#manipulating-expressions-the-art-of-sculpting-code"><i class="fa fa-check"></i><b>4.1.1</b> Manipulating expressions: The art of sculpting code</a></li>
<li class="chapter" data-level="4.1.2" data-path="advanced-techniques.html"><a href="advanced-techniques.html#examples-3"><i class="fa fa-check"></i><b>4.1.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="advanced-techniques.html"><a href="advanced-techniques.html#functional-programming-a-new-paradigm"><i class="fa fa-check"></i><b>4.2</b> Functional programming: a new paradigm</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="advanced-techniques.html"><a href="advanced-techniques.html#basic-principles-of-functional-programming"><i class="fa fa-check"></i><b>4.2.1</b> Basic principles of functional programming</a></li>
<li class="chapter" data-level="4.2.2" data-path="advanced-techniques.html"><a href="advanced-techniques.html#higher-order-functions-in-r"><i class="fa fa-check"></i><b>4.2.2</b> Higher-order functions in R</a></li>
<li class="chapter" data-level="4.2.3" data-path="advanced-techniques.html"><a href="advanced-techniques.html#examples-4"><i class="fa fa-check"></i><b>4.2.3</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="advanced-techniques.html"><a href="advanced-techniques.html#r6-the-future-of-oop-in-r"><i class="fa fa-check"></i><b>4.3</b> R6: The future of OOP in R</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="advanced-techniques.html"><a href="advanced-techniques.html#the-r6-package-classes-methods-encapsulation-and-inheritance"><i class="fa fa-check"></i><b>4.3.1</b> The R6 package: Classes, methods, encapsulation, and inheritance</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="advanced-techniques.html"><a href="advanced-techniques.html#exercises-4"><i class="fa fa-check"></i><b>4.4</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>II Data Visualization and Summarization</b></span></li>
<li class="chapter" data-level="5" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html"><i class="fa fa-check"></i><b>5</b> Ggplot and dplyr</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#creating-the-ggplot-object"><i class="fa fa-check"></i><b>5.1</b> Creating the ggplot object</a></li>
<li class="chapter" data-level="5.2" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#aesthetic-mapping-layer"><i class="fa fa-check"></i><b>5.2</b> Aesthetic mapping layer</a></li>
<li class="chapter" data-level="5.3" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#geoms-layer"><i class="fa fa-check"></i><b>5.3</b> Geoms layer</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#tweaking-aes-and-geoms"><i class="fa fa-check"></i><b>5.3.1</b> Tweaking aes and geoms</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#scale-layer"><i class="fa fa-check"></i><b>5.4</b> Scale layer</a></li>
<li class="chapter" data-level="5.5" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#label-title-and-legend-layer"><i class="fa fa-check"></i><b>5.5</b> Label, title and legend layer</a></li>
<li class="chapter" data-level="5.6" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#reference-lines"><i class="fa fa-check"></i><b>5.6</b> Reference lines</a></li>
<li class="chapter" data-level="5.7" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#changing-the-plot-style"><i class="fa fa-check"></i><b>5.7</b> Changing the plot style</a></li>
<li class="chapter" data-level="5.8" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#summarizing-data-with-dplyr"><i class="fa fa-check"></i><b>5.8</b> Summarizing data with dplyr</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#summarize-function"><i class="fa fa-check"></i><b>5.8.1</b> Summarize function</a></li>
<li class="chapter" data-level="5.8.2" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#group-by-function"><i class="fa fa-check"></i><b>5.8.2</b> Group By Function</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#exercises-5"><i class="fa fa-check"></i><b>5.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="gapminder.html"><a href="gapminder.html"><i class="fa fa-check"></i><b>6</b> Gapminder</a>
<ul>
<li class="chapter" data-level="6.1" data-path="gapminder.html"><a href="gapminder.html#initial-gapminder-plots"><i class="fa fa-check"></i><b>6.1</b> Initial gapminder plots</a></li>
<li class="chapter" data-level="6.2" data-path="gapminder.html"><a href="gapminder.html#facets"><i class="fa fa-check"></i><b>6.2</b> Facets</a></li>
<li class="chapter" data-level="6.3" data-path="gapminder.html"><a href="gapminder.html#time-series"><i class="fa fa-check"></i><b>6.3</b> Time series</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="gapminder.html"><a href="gapminder.html#individual-time-series"><i class="fa fa-check"></i><b>6.3.1</b> Individual time series</a></li>
<li class="chapter" data-level="6.3.2" data-path="gapminder.html"><a href="gapminder.html#multiple-time-series"><i class="fa fa-check"></i><b>6.3.2</b> Multiple time series</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="gapminder.html"><a href="gapminder.html#exercises-6"><i class="fa fa-check"></i><b>6.4</b> Exercises</a></li>
<li class="chapter" data-level="6.5" data-path="gapminder.html"><a href="gapminder.html#histograms-with-ggplot"><i class="fa fa-check"></i><b>6.5</b> Histograms with ggplot</a></li>
<li class="chapter" data-level="6.6" data-path="gapminder.html"><a href="gapminder.html#box-plots-with-ggplot"><i class="fa fa-check"></i><b>6.6</b> Box plots with ggplot</a></li>
<li class="chapter" data-level="6.7" data-path="gapminder.html"><a href="gapminder.html#comparison-of-distributions"><i class="fa fa-check"></i><b>6.7</b> Comparison of distributions</a></li>
<li class="chapter" data-level="6.8" data-path="gapminder.html"><a href="gapminder.html#exercises-7"><i class="fa fa-check"></i><b>6.8</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>III Statistics</b></span></li>
<li class="chapter" data-level="" data-path="introduction-to-probabilities.html"><a href="introduction-to-probabilities.html"><i class="fa fa-check"></i>Introduction to Probabilities</a></li>
<li class="chapter" data-level="7" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html"><i class="fa fa-check"></i><b>7</b> Discrete Probabilities</a>
<ul>
<li class="chapter" data-level="7.1" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#calculation-using-the-mathematical-definition"><i class="fa fa-check"></i><b>7.1</b> Calculation using the mathematical definition</a></li>
<li class="chapter" data-level="7.2" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#monte-carlo-simulation-for-discrete-variables"><i class="fa fa-check"></i><b>7.2</b> Monte Carlo Simulation for Discrete Variables</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#other-functions-to-create-vectors"><i class="fa fa-check"></i><b>7.2.1</b> Other functions to create vectors</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#exercises-8"><i class="fa fa-check"></i><b>7.3</b> Exercises</a></li>
<li class="chapter" data-level="7.4" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#combinations-and-permutations"><i class="fa fa-check"></i><b>7.4</b> Combinations and Permutations</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#permutations"><i class="fa fa-check"></i><b>7.4.1</b> Permutations</a></li>
<li class="chapter" data-level="7.4.2" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#combinations"><i class="fa fa-check"></i><b>7.4.2</b> Combinations</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#sufficient-experiments-with-monte-carlo-simulation"><i class="fa fa-check"></i><b>7.5</b> Sufficient Experiments with Monte Carlo Simulation</a></li>
<li class="chapter" data-level="7.6" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#case-birthdays-in-classrooms"><i class="fa fa-check"></i><b>7.6</b> Case: Birthdays in Classrooms</a></li>
<li class="chapter" data-level="7.7" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#exercises-9"><i class="fa fa-check"></i><b>7.7</b> Exercises</a></li>
<li class="chapter" data-level="7.8" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#integrative-exercise"><i class="fa fa-check"></i><b>7.8</b> Integrative Exercise</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#monty-hall-problem"><i class="fa fa-check"></i><b>7.8.1</b> Monty Hall Problem</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="continuous-probabilities.html"><a href="continuous-probabilities.html"><i class="fa fa-check"></i><b>8</b> Continuous Probabilities</a>
<ul>
<li class="chapter" data-level="8.1" data-path="continuous-probabilities.html"><a href="continuous-probabilities.html#empirical-distribution"><i class="fa fa-check"></i><b>8.1</b> Empirical Distribution</a></li>
<li class="chapter" data-level="8.2" data-path="continuous-probabilities.html"><a href="continuous-probabilities.html#theoretical-distribution"><i class="fa fa-check"></i><b>8.2</b> Theoretical Distribution</a></li>
<li class="chapter" data-level="8.3" data-path="continuous-probabilities.html"><a href="continuous-probabilities.html#exercises-10"><i class="fa fa-check"></i><b>8.3</b> Exercises</a></li>
<li class="chapter" data-level="8.4" data-path="continuous-probabilities.html"><a href="continuous-probabilities.html#monte-carlo-simulation-for-continuous-variables"><i class="fa fa-check"></i><b>8.4</b> Monte Carlo Simulation for Continuous Variables</a></li>
<li class="chapter" data-level="8.5" data-path="continuous-probabilities.html"><a href="continuous-probabilities.html#exercises-11"><i class="fa fa-check"></i><b>8.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i><b>9</b> Statistical Inference</a>
<ul>
<li class="chapter" data-level="9.1" data-path="statistical-inference.html"><a href="statistical-inference.html#expected-value"><i class="fa fa-check"></i><b>9.1</b> Expected Value</a></li>
<li class="chapter" data-level="9.2" data-path="statistical-inference.html"><a href="statistical-inference.html#central-limit-theorem"><i class="fa fa-check"></i><b>9.2</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="9.3" data-path="statistical-inference.html"><a href="statistical-inference.html#exercises-12"><i class="fa fa-check"></i><b>9.3</b> Exercises</a></li>
<li class="chapter" data-level="9.4" data-path="statistical-inference.html"><a href="statistical-inference.html#parameter-estimation-method"><i class="fa fa-check"></i><b>9.4</b> Parameter Estimation Method</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="statistical-inference.html"><a href="statistical-inference.html#margin-of-error"><i class="fa fa-check"></i><b>9.4.1</b> Margin of Error</a></li>
<li class="chapter" data-level="9.4.2" data-path="statistical-inference.html"><a href="statistical-inference.html#confidence-intervals"><i class="fa fa-check"></i><b>9.4.2</b> Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="statistical-inference.html"><a href="statistical-inference.html#spread-estimation"><i class="fa fa-check"></i><b>9.5</b> Spread Estimation</a></li>
<li class="chapter" data-level="9.6" data-path="statistical-inference.html"><a href="statistical-inference.html#estimates-outside-election-polls"><i class="fa fa-check"></i><b>9.6</b> Estimates Outside Election Polls</a></li>
<li class="chapter" data-level="9.7" data-path="statistical-inference.html"><a href="statistical-inference.html#exercises-13"><i class="fa fa-check"></i><b>9.7</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>IV Data Wrangling</b></span></li>
<li class="chapter" data-level="" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="10" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html"><i class="fa fa-check"></i><b>10</b> Data import and consolidation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#importing-from-files"><i class="fa fa-check"></i><b>10.1</b> Importing from files</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#working-directory"><i class="fa fa-check"></i><b>10.1.1</b> Working Directory</a></li>
<li class="chapter" data-level="10.1.2" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#readr-and-readxl-packages"><i class="fa fa-check"></i><b>10.1.2</b> readr and readxl packages</a></li>
<li class="chapter" data-level="10.1.3" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#importing-files-from-the-internet"><i class="fa fa-check"></i><b>10.1.3</b> Importing files from the internet</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#tidy-data"><i class="fa fa-check"></i><b>10.2</b> Tidy data</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#transforming-to-tidy-data"><i class="fa fa-check"></i><b>10.2.1</b> Transforming to tidy data</a></li>
<li class="chapter" data-level="10.2.2" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#separate-function"><i class="fa fa-check"></i><b>10.2.2</b> separate function</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#exercises-14"><i class="fa fa-check"></i><b>10.3</b> Exercises</a></li>
<li class="chapter" data-level="10.4" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#joining-tables"><i class="fa fa-check"></i><b>10.4</b> Joining tables</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#join-functions"><i class="fa fa-check"></i><b>10.4.1</b> Join functions</a></li>
<li class="chapter" data-level="10.4.2" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#joining-without-a-common-identifier"><i class="fa fa-check"></i><b>10.4.2</b> Joining without a common identifier</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#web-scraping"><i class="fa fa-check"></i><b>10.5</b> Web Scraping</a></li>
<li class="chapter" data-level="10.6" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#exercises-15"><i class="fa fa-check"></i><b>10.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html"><i class="fa fa-check"></i><b>11</b> String processing and text mining</a>
<ul>
<li class="chapter" data-level="11.1" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#basic-functions"><i class="fa fa-check"></i><b>11.1</b> Basic functions</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#replacing-characters"><i class="fa fa-check"></i><b>11.1.1</b> Replacing characters</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#regular-expressions"><i class="fa fa-check"></i><b>11.2</b> Regular expressions</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#alternation"><i class="fa fa-check"></i><b>11.2.1</b> Alternation</a></li>
<li class="chapter" data-level="11.2.2" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#anchoring"><i class="fa fa-check"></i><b>11.2.2</b> Anchoring</a></li>
<li class="chapter" data-level="11.2.3" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#repetitions"><i class="fa fa-check"></i><b>11.2.3</b> Repetitions</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#from-strings-to-dates"><i class="fa fa-check"></i><b>11.3</b> From strings to dates</a></li>
<li class="chapter" data-level="11.4" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#exercises-16"><i class="fa fa-check"></i><b>11.4</b> Exercises</a></li>
<li class="chapter" data-level="11.5" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#text-mining-word-cloud"><i class="fa fa-check"></i><b>11.5</b> Text Mining: Word Cloud</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#importing-data"><i class="fa fa-check"></i><b>11.5.1</b> Importing data</a></li>
<li class="chapter" data-level="11.5.2" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#text-cleaning"><i class="fa fa-check"></i><b>11.5.2</b> Text cleaning</a></li>
<li class="chapter" data-level="11.5.3" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#creating-the-corpus"><i class="fa fa-check"></i><b>11.5.3</b> Creating the Corpus</a></li>
<li class="chapter" data-level="11.5.4" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#nd-data-cleaning"><i class="fa fa-check"></i><b>11.5.4</b> 2nd Data Cleaning</a></li>
<li class="chapter" data-level="11.5.5" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#word-frequency"><i class="fa fa-check"></i><b>11.5.5</b> Word frequency</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#text-mining-sentiment-analysis"><i class="fa fa-check"></i><b>11.6</b> Text Mining: Sentiment Analysis</a></li>
<li class="chapter" data-level="11.7" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#exercises-17"><i class="fa fa-check"></i><b>11.7</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>V Machine learning</b></span></li>
<li class="chapter" data-level="" data-path="introduction-2.html"><a href="introduction-2.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="12" data-path="supervised-learning.html"><a href="supervised-learning.html"><i class="fa fa-check"></i><b>12</b> Supervised Learning</a>
<ul>
<li class="chapter" data-level="12.1" data-path="supervised-learning.html"><a href="supervised-learning.html#classification-and-regression"><i class="fa fa-check"></i><b>12.1</b> Classification and Regression</a></li>
<li class="chapter" data-level="12.2" data-path="supervised-learning.html"><a href="supervised-learning.html#knn-k-nearest-neighbors"><i class="fa fa-check"></i><b>12.2</b> kNN: k-Nearest Neighbors</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="supervised-learning.html"><a href="supervised-learning.html#two-variables-as-input"><i class="fa fa-check"></i><b>12.2.1</b> Two variables as input</a></li>
<li class="chapter" data-level="12.2.2" data-path="supervised-learning.html"><a href="supervised-learning.html#multiple-variables-as-input"><i class="fa fa-check"></i><b>12.2.2</b> Multiple variables as input</a></li>
<li class="chapter" data-level="12.2.3" data-path="supervised-learning.html"><a href="supervised-learning.html#diverse-values-of-k"><i class="fa fa-check"></i><b>12.2.3</b> Diverse values of k</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="supervised-learning.html"><a href="supervised-learning.html#tidymodels-framework"><i class="fa fa-check"></i><b>12.3</b> tidymodels Framework</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="supervised-learning.html"><a href="supervised-learning.html#creation-of-training-and-test-data"><i class="fa fa-check"></i><b>12.3.1</b> Creation of training and test data</a></li>
<li class="chapter" data-level="12.3.2" data-path="supervised-learning.html"><a href="supervised-learning.html#training-our-prediction-algorithm"><i class="fa fa-check"></i><b>12.3.2</b> Training our prediction algorithm</a></li>
<li class="chapter" data-level="12.3.3" data-path="supervised-learning.html"><a href="supervised-learning.html#data-pre-processing-with-recipes"><i class="fa fa-check"></i><b>12.3.3</b> Data Pre-processing with Recipes</a></li>
<li class="chapter" data-level="12.3.4" data-path="supervised-learning.html"><a href="supervised-learning.html#creating-a-workflow"><i class="fa fa-check"></i><b>12.3.4</b> Creating a Workflow</a></li>
<li class="chapter" data-level="12.3.5" data-path="supervised-learning.html"><a href="supervised-learning.html#parameter-tuning-with-cross-validation"><i class="fa fa-check"></i><b>12.3.5</b> Parameter Tuning with Cross-Validation</a></li>
<li class="chapter" data-level="12.3.6" data-path="supervised-learning.html"><a href="supervised-learning.html#finalizing-the-model"><i class="fa fa-check"></i><b>12.3.6</b> Finalizing the Model</a></li>
<li class="chapter" data-level="12.3.7" data-path="supervised-learning.html"><a href="supervised-learning.html#testing-the-prediction-model"><i class="fa fa-check"></i><b>12.3.7</b> Testing the prediction model</a></li>
<li class="chapter" data-level="12.3.8" data-path="supervised-learning.html"><a href="supervised-learning.html#model-evaluation-with-yardstick"><i class="fa fa-check"></i><b>12.3.8</b> Model Evaluation with yardstick</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="supervised-learning.html"><a href="supervised-learning.html#confusion-matrix"><i class="fa fa-check"></i><b>12.4</b> Confusion Matrix</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="supervised-learning.html"><a href="supervised-learning.html#accuracy"><i class="fa fa-check"></i><b>12.4.1</b> Accuracy</a></li>
<li class="chapter" data-level="12.4.2" data-path="supervised-learning.html"><a href="supervised-learning.html#sensitivity"><i class="fa fa-check"></i><b>12.4.2</b> Sensitivity</a></li>
<li class="chapter" data-level="12.4.3" data-path="supervised-learning.html"><a href="supervised-learning.html#specificity"><i class="fa fa-check"></i><b>12.4.3</b> Specificity</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="supervised-learning.html"><a href="supervised-learning.html#exercises-18"><i class="fa fa-check"></i><b>12.5</b> Exercises</a></li>
<li class="chapter" data-level="12.6" data-path="supervised-learning.html"><a href="supervised-learning.html#simple-linear-regression"><i class="fa fa-check"></i><b>12.6</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="12.7" data-path="supervised-learning.html"><a href="supervised-learning.html#multiple-linear-regression"><i class="fa fa-check"></i><b>12.7</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="12.8" data-path="supervised-learning.html"><a href="supervised-learning.html#standard-method-for-evaluating-accuracy"><i class="fa fa-check"></i><b>12.8</b> Standard Method for Evaluating Accuracy</a></li>
<li class="chapter" data-level="12.9" data-path="supervised-learning.html"><a href="supervised-learning.html#selection-of-the-most-optimal-model"><i class="fa fa-check"></i><b>12.9</b> Selection of the Most Optimal Model</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="supervised-learning.html"><a href="supervised-learning.html#k-nearest-neighbors-model"><i class="fa fa-check"></i><b>12.9.1</b> k-Nearest Neighbors Model</a></li>
<li class="chapter" data-level="12.9.2" data-path="supervised-learning.html"><a href="supervised-learning.html#generalized-linear-model---glm"><i class="fa fa-check"></i><b>12.9.2</b> Generalized Linear Model - GLM</a></li>
<li class="chapter" data-level="12.9.3" data-path="supervised-learning.html"><a href="supervised-learning.html#random-forest-model"><i class="fa fa-check"></i><b>12.9.3</b> Random Forest Model</a></li>
<li class="chapter" data-level="12.9.4" data-path="supervised-learning.html"><a href="supervised-learning.html#support-vector-machine-model---svm"><i class="fa fa-check"></i><b>12.9.4</b> Support Vector Machine Model - SVM</a></li>
<li class="chapter" data-level="12.9.5" data-path="supervised-learning.html"><a href="supervised-learning.html#naive-bayes-model"><i class="fa fa-check"></i><b>12.9.5</b> Naive Bayes Model</a></li>
<li class="chapter" data-level="12.9.6" data-path="supervised-learning.html"><a href="supervised-learning.html#model-comparison"><i class="fa fa-check"></i><b>12.9.6</b> Model Comparison</a></li>
<li class="chapter" data-level="12.9.7" data-path="supervised-learning.html"><a href="supervised-learning.html#predicting-using-the-best-model"><i class="fa fa-check"></i><b>12.9.7</b> Predicting using the best model</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="supervised-learning.html"><a href="supervised-learning.html#exercises-19"><i class="fa fa-check"></i><b>12.10</b> Exercises</a></li>
<li class="chapter" data-level="12.11" data-path="supervised-learning.html"><a href="supervised-learning.html#ethics-bias-in-algorithmic-decision-making"><i class="fa fa-check"></i><b>12.11</b> Ethics: Bias in Algorithmic Decision Making</a>
<ul>
<li class="chapter" data-level="12.11.1" data-path="supervised-learning.html"><a href="supervised-learning.html#the-risk-of-proxy-variables"><i class="fa fa-check"></i><b>12.11.1</b> The Risk of Proxy Variables</a></li>
<li class="chapter" data-level="12.11.2" data-path="supervised-learning.html"><a href="supervised-learning.html#feedback-loops"><i class="fa fa-check"></i><b>12.11.2</b> Feedback Loops</a></li>
<li class="chapter" data-level="12.11.3" data-path="supervised-learning.html"><a href="supervised-learning.html#what-can-we-do"><i class="fa fa-check"></i><b>12.11.3</b> What can we do?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html"><i class="fa fa-check"></i><b>13</b> Unsupervised Learning</a>
<ul>
<li class="chapter" data-level="13.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#k-means-clustering"><i class="fa fa-check"></i><b>13.1</b> K-Means Clustering</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#clustering-with-k-2"><i class="fa fa-check"></i><b>13.1.1</b> Clustering with k = 2</a></li>
<li class="chapter" data-level="13.1.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#clustering-with-k-3"><i class="fa fa-check"></i><b>13.1.2</b> Clustering with k &gt;= 3</a></li>
<li class="chapter" data-level="13.1.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#determination-of-optimal-clusters"><i class="fa fa-check"></i><b>13.1.3</b> Determination of Optimal Clusters</a></li>
<li class="chapter" data-level="13.1.4" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#k-means-for-more-than-2-variables"><i class="fa fa-check"></i><b>13.1.4</b> k-means for more than 2 variables</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#hierarchical-clustering"><i class="fa fa-check"></i><b>13.2</b> Hierarchical Clustering</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#clustering-with-two-variables"><i class="fa fa-check"></i><b>13.2.1</b> Clustering with two variables</a></li>
<li class="chapter" data-level="13.2.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#determination-of-optimal-clusters-1"><i class="fa fa-check"></i><b>13.2.2</b> Determination of Optimal Clusters</a></li>
<li class="chapter" data-level="13.2.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#obtain-the-grouping"><i class="fa fa-check"></i><b>13.2.3</b> Obtain the grouping</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#dimensionality-reduction"><i class="fa fa-check"></i><b>13.3</b> Dimensionality Reduction</a></li>
<li class="chapter" data-level="13.4" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#exercises-20"><i class="fa fa-check"></i><b>13.4</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>VI Real Cases</b></span></li>
<li class="chapter" data-level="" data-path="introduction-3.html"><a href="introduction-3.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="14" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html"><i class="fa fa-check"></i><b>14</b> Case Study: Real Estate Market Analysis</a>
<ul>
<li class="chapter" data-level="14.1" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#objectives"><i class="fa fa-check"></i><b>14.1</b> Objectives</a></li>
<li class="chapter" data-level="14.2" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#loading-libraries"><i class="fa fa-check"></i><b>14.2</b> Loading Libraries</a></li>
<li class="chapter" data-level="14.3" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#exploring-the-data"><i class="fa fa-check"></i><b>14.3</b> Exploring the Data</a></li>
<li class="chapter" data-level="14.4" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#data-cleaning"><i class="fa fa-check"></i><b>14.4</b> Data Cleaning</a></li>
<li class="chapter" data-level="14.5" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#exploratory-analysis"><i class="fa fa-check"></i><b>14.5</b> Exploratory Analysis</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#market-volume-over-time"><i class="fa fa-check"></i><b>14.5.1</b> Market Volume Over Time</a></li>
<li class="chapter" data-level="14.5.2" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#comparing-cities"><i class="fa fa-check"></i><b>14.5.2</b> Comparing Cities</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#creating-indicators"><i class="fa fa-check"></i><b>14.6</b> Creating Indicators</a></li>
<li class="chapter" data-level="14.7" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#conclusions"><i class="fa fa-check"></i><b>14.7</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="google-analytics-from-r.html"><a href="google-analytics-from-r.html"><i class="fa fa-check"></i><b>15</b> Google Analytics from R</a>
<ul>
<li class="chapter" data-level="15.1" data-path="google-analytics-from-r.html"><a href="google-analytics-from-r.html#problem"><i class="fa fa-check"></i><b>15.1</b> Problem</a></li>
<li class="chapter" data-level="15.2" data-path="google-analytics-from-r.html"><a href="google-analytics-from-r.html#access-to-data"><i class="fa fa-check"></i><b>15.2</b> Access to data</a></li>
<li class="chapter" data-level="15.3" data-path="google-analytics-from-r.html"><a href="google-analytics-from-r.html#visualization"><i class="fa fa-check"></i><b>15.3</b> Visualization</a></li>
<li class="chapter" data-level="15.4" data-path="google-analytics-from-r.html"><a href="google-analytics-from-r.html#conclusion"><i class="fa fa-check"></i><b>15.4</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="genai-intro.html"><a href="genai-intro.html"><i class="fa fa-check"></i><b>16</b> Data Science in the Age of AI</a>
<ul>
<li class="chapter" data-level="16.1" data-path="genai-intro.html"><a href="genai-intro.html#what-is-a-large-language-model"><i class="fa fa-check"></i><b>16.1</b> What is a Large Language Model?</a></li>
<li class="chapter" data-level="16.2" data-path="genai-intro.html"><a href="genai-intro.html#coding-with-ai-the-pair-programmer"><i class="fa fa-check"></i><b>16.2</b> Coding with AI: The “Pair Programmer”</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="genai-intro.html"><a href="genai-intro.html#explaining-complex-code"><i class="fa fa-check"></i><b>16.2.1</b> 1. Explaining Complex Code</a></li>
<li class="chapter" data-level="16.2.2" data-path="genai-intro.html"><a href="genai-intro.html#generating-boilerplate"><i class="fa fa-check"></i><b>16.2.2</b> 2. Generating Boilerplate</a></li>
<li class="chapter" data-level="16.2.3" data-path="genai-intro.html"><a href="genai-intro.html#regex-the-ultimate-use-case"><i class="fa fa-check"></i><b>16.2.3</b> 3. Regex: The Ultimate Use Case</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="genai-intro.html"><a href="genai-intro.html#ethics-risks-in-the-ai-era"><i class="fa fa-check"></i><b>16.3</b> Ethics &amp; Risks in the AI Era</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="genai-intro.html"><a href="genai-intro.html#hallucinations-fabrication"><i class="fa fa-check"></i><b>16.3.1</b> 1. Hallucinations &amp; Fabrication</a></li>
<li class="chapter" data-level="16.3.2" data-path="genai-intro.html"><a href="genai-intro.html#the-reproducibility-crisis"><i class="fa fa-check"></i><b>16.3.2</b> 2. The Reproducibility Crisis</a></li>
<li class="chapter" data-level="16.3.3" data-path="genai-intro.html"><a href="genai-intro.html#data-privacy-ip"><i class="fa fa-check"></i><b>16.3.3</b> 3. Data Privacy &amp; IP</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="genai-api.html"><a href="genai-api.html"><i class="fa fa-check"></i><b>17</b> LLMs as an Analysis Engine</a>
<ul>
<li class="chapter" data-level="17.1" data-path="genai-api.html"><a href="genai-api.html#the-evolution-of-nlp"><i class="fa fa-check"></i><b>17.1</b> The Evolution of NLP</a></li>
<li class="chapter" data-level="17.2" data-path="genai-api.html"><a href="genai-api.html#interacting-with-apis-from-r"><i class="fa fa-check"></i><b>17.2</b> Interacting with APIs from R</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="genai-api.html"><a href="genai-api.html#prerequisite-api-keys"><i class="fa fa-check"></i><b>17.2.1</b> Prerequisite: API Keys</a></li>
<li class="chapter" data-level="17.2.2" data-path="genai-api.html"><a href="genai-api.html#making-a-request"><i class="fa fa-check"></i><b>17.2.2</b> Making a Request</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="genai-api.html"><a href="genai-api.html#zero-shot-classification"><i class="fa fa-check"></i><b>17.3</b> Zero-Shot Classification</a></li>
<li class="chapter" data-level="17.4" data-path="genai-api.html"><a href="genai-api.html#text-cleaning-with-llms"><i class="fa fa-check"></i><b>17.4</b> Text Cleaning with LLMs</a></li>
<li class="chapter" data-level="17.5" data-path="genai-api.html"><a href="genai-api.html#summary"><i class="fa fa-check"></i><b>17.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="ethics-checklist.html"><a href="ethics-checklist.html"><i class="fa fa-check"></i><b>18</b> Appendix A: Responsible AI Checklist</a>
<ul>
<li class="chapter" data-level="18.1" data-path="ethics-checklist.html"><a href="ethics-checklist.html#data-quality-lineage"><i class="fa fa-check"></i><b>18.1</b> 1. Data Quality &amp; lineage</a></li>
<li class="chapter" data-level="18.2" data-path="ethics-checklist.html"><a href="ethics-checklist.html#fairness-bias"><i class="fa fa-check"></i><b>18.2</b> 2. Fairness &amp; Bias</a></li>
<li class="chapter" data-level="18.3" data-path="ethics-checklist.html"><a href="ethics-checklist.html#transparency-explainability"><i class="fa fa-check"></i><b>18.3</b> 3. Transparency &amp; Explainability</a></li>
<li class="chapter" data-level="18.4" data-path="ethics-checklist.html"><a href="ethics-checklist.html#genai-specifics"><i class="fa fa-check"></i><b>18.4</b> 4. GenAI Specifics</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-import-and-consolidation" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Chapter 10</span> Data import and consolidation<a href="data-import-and-consolidation.html#data-import-and-consolidation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="importing-from-files" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Importing from files<a href="data-import-and-consolidation.html#importing-from-files" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For importing files, whether they are text types or spreadsheets, we need to know where we are going to import the data from.</p>
<div id="working-directory" class="section level3 hasAnchor" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> Working Directory<a href="data-import-and-consolidation.html#working-directory" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>By default, when we import files, R will search in the working directory. To find out the path of our working directory we will use the <code>getwd()</code> function.</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="data-import-and-consolidation.html#cb401-1" tabindex="-1"></a><span class="fu">getwd</span>()</span>
<span id="cb401-2"><a href="data-import-and-consolidation.html#cb401-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;c:/Documents/dparedesi/git-repository/DS&quot;</span></span></code></pre></div>
<p>This is the path where we can place our files to load them. If we want to load data from another folder we can change the working directory using <code>setwd()</code>.</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="data-import-and-consolidation.html#cb402-1" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;c:/Documents/Proyectos/Archivos para R&quot;</span>)</span>
<span id="cb402-2"><a href="data-import-and-consolidation.html#cb402-2" tabindex="-1"></a></span>
<span id="cb402-3"><a href="data-import-and-consolidation.html#cb402-3" tabindex="-1"></a><span class="fu">getwd</span>()</span>
<span id="cb402-4"><a href="data-import-and-consolidation.html#cb402-4" tabindex="-1"></a><span class="co">#&gt; [1] &quot;c:/Documents/Proyectos/Archivos para R&quot;</span></span></code></pre></div>
<p>For practical purposes, we are going to use a file already available in one of the previously installed packages, <code>dslabs</code>, when we analyzed the danger level to decide which US state to travel to. To do this, we can use the <code>system.file()</code> function and determine the path where the <code>dslabs</code> package was installed.</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="data-import-and-consolidation.html#cb403-1" tabindex="-1"></a>dslabs_path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="at">package=</span><span class="st">&quot;dslabs&quot;</span>)</span></code></pre></div>
<p>Likewise, we can list the files and folders within that path using the <code>list.files()</code> function.</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="data-import-and-consolidation.html#cb404-1" tabindex="-1"></a>dslabs_path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="at">package=</span><span class="st">&quot;dslabs&quot;</span>)</span>
<span id="cb404-2"><a href="data-import-and-consolidation.html#cb404-2" tabindex="-1"></a><span class="fu">list.files</span>(dslabs_path)</span>
<span id="cb404-3"><a href="data-import-and-consolidation.html#cb404-3" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;data&quot;        &quot;DESCRIPTION&quot; &quot;extdata&quot;     &quot;help&quot;        &quot;html&quot;       </span></span>
<span id="cb404-4"><a href="data-import-and-consolidation.html#cb404-4" tabindex="-1"></a><span class="co">#&gt;  [6] &quot;INDEX&quot;       &quot;Meta&quot;        &quot;NAMESPACE&quot;   &quot;R&quot;           &quot;script&quot;</span></span></code></pre></div>
<p>The folder we will use is <strong>extdata</strong>. We can access the path of this folder if we modify the parameters of the <code>system.file()</code> function.</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="data-import-and-consolidation.html#cb405-1" tabindex="-1"></a>dslabs_path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="at">package=</span><span class="st">&quot;dslabs&quot;</span>)</span>
<span id="cb405-2"><a href="data-import-and-consolidation.html#cb405-2" tabindex="-1"></a><span class="fu">list.files</span>(dslabs_path)</span>
<span id="cb405-3"><a href="data-import-and-consolidation.html#cb405-3" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;2010_bigfive_regents.xls&quot;                               </span></span>
<span id="cb405-4"><a href="data-import-and-consolidation.html#cb405-4" tabindex="-1"></a><span class="co">#&gt;  [2] &quot;calificaciones.csv&quot;                                     </span></span>
<span id="cb405-5"><a href="data-import-and-consolidation.html#cb405-5" tabindex="-1"></a><span class="co">#&gt;  [3] &quot;carbon_emissions.csv&quot;                                   </span></span>
<span id="cb405-6"><a href="data-import-and-consolidation.html#cb405-6" tabindex="-1"></a><span class="co">#&gt;  [4] &quot;fertility-two-countries-example.csv&quot;                    </span></span>
<span id="cb405-7"><a href="data-import-and-consolidation.html#cb405-7" tabindex="-1"></a><span class="co">#&gt;  [5] &quot;HRlist2.txt&quot;                                            </span></span>
<span id="cb405-8"><a href="data-import-and-consolidation.html#cb405-8" tabindex="-1"></a><span class="co">#&gt;  [6] &quot;life-expectancy-and-fertility-two-countries-example.csv&quot;</span></span>
<span id="cb405-9"><a href="data-import-and-consolidation.html#cb405-9" tabindex="-1"></a><span class="co">#&gt;  [7] &quot;murders.csv&quot;                                            </span></span>
<span id="cb405-10"><a href="data-import-and-consolidation.html#cb405-10" tabindex="-1"></a><span class="co">#&gt;  [8] &quot;olive.csv&quot;                                              </span></span>
<span id="cb405-11"><a href="data-import-and-consolidation.html#cb405-11" tabindex="-1"></a><span class="co">#&gt;  [9] &quot;RD-Mortality-Report_2015-18-180531.pdf&quot;                 </span></span>
<span id="cb405-12"><a href="data-import-and-consolidation.html#cb405-12" tabindex="-1"></a><span class="co">#&gt; [10] &quot;ssa-death-probability.csv&quot;</span></span></code></pre></div>
<p>The file we will use is <strong>murders.csv</strong>. To build the complete path of this file we can concatenate the strings or we can also directly use the <code>file.path(path, file_name)</code> function.</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="data-import-and-consolidation.html#cb406-1" tabindex="-1"></a>csv_example_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dslabs_path, <span class="st">&quot;murders.csv&quot;</span>)</span></code></pre></div>
<p>Finally, we will copy the file to our working directory with the <code>file.copy(source_path, destination_path)</code> function.</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="data-import-and-consolidation.html#cb407-1" tabindex="-1"></a><span class="fu">file.copy</span>(csv_example_path, <span class="fu">getwd</span>())</span>
<span id="cb407-2"><a href="data-import-and-consolidation.html#cb407-2" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>We can validate the copy with the <code>file.exists(file_name)</code> function.</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="data-import-and-consolidation.html#cb408-1" tabindex="-1"></a><span class="fu">file.exists</span>(<span class="st">&quot;murders.csv&quot;</span>)</span>
<span id="cb408-2"><a href="data-import-and-consolidation.html#cb408-2" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>It is recommended to check the documentation of the file manipulation functions.</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="data-import-and-consolidation.html#cb409-1" tabindex="-1"></a>?files</span></code></pre></div>
</div>
<div id="readr-and-readxl-packages" class="section level3 hasAnchor" number="10.1.2">
<h3><span class="header-section-number">10.1.2</span> readr and readxl packages<a href="data-import-and-consolidation.html#readr-and-readxl-packages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we have the file in our working directory, we will use functions within the <strong>readr</strong> and <strong>readxl</strong> packages to import files into R. Both are included in the <strong>tidyverse</strong> package that we previously installed.</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="data-import-and-consolidation.html#cb410-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># Here readr is included automatically</span></span>
<span id="cb410-2"><a href="data-import-and-consolidation.html#cb410-2" tabindex="-1"></a><span class="fu">library</span>(readxl)</span></code></pre></div>
<p>The functions we will use the most will be <code>read_csv()</code> and <code>read_excel()</code>. The latter supports .xls and .xlsx extensions.</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="data-import-and-consolidation.html#cb411-1" tabindex="-1"></a>data_df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;murders.csv&quot;</span>)</span>
<span id="cb411-2"><a href="data-import-and-consolidation.html#cb411-2" tabindex="-1"></a><span class="co">#&gt; Rows: 51 Columns: 5</span></span>
<span id="cb411-3"><a href="data-import-and-consolidation.html#cb411-3" tabindex="-1"></a><span class="co">#&gt; ── Column specification ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></span>
<span id="cb411-4"><a href="data-import-and-consolidation.html#cb411-4" tabindex="-1"></a><span class="co">#&gt; Delimiter: &quot;,&quot;</span></span>
<span id="cb411-5"><a href="data-import-and-consolidation.html#cb411-5" tabindex="-1"></a><span class="co">#&gt; chr (3): state, abb, region</span></span>
<span id="cb411-6"><a href="data-import-and-consolidation.html#cb411-6" tabindex="-1"></a><span class="co">#&gt; dbl (2): population, total</span></span>
<span id="cb411-7"><a href="data-import-and-consolidation.html#cb411-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb411-8"><a href="data-import-and-consolidation.html#cb411-8" tabindex="-1"></a><span class="co">#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span id="cb411-9"><a href="data-import-and-consolidation.html#cb411-9" tabindex="-1"></a><span class="co">#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span id="cb411-10"><a href="data-import-and-consolidation.html#cb411-10" tabindex="-1"></a></span>
<span id="cb411-11"><a href="data-import-and-consolidation.html#cb411-11" tabindex="-1"></a><span class="co"># Once imported we can remove the file if we wish</span></span>
<span id="cb411-12"><a href="data-import-and-consolidation.html#cb411-12" tabindex="-1"></a><span class="fu">file.remove</span>(<span class="st">&quot;murders.csv&quot;</span>)</span>
<span id="cb411-13"><a href="data-import-and-consolidation.html#cb411-13" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>We see how by default it detects the headers in the first row and assigns them a default data type. Let’s now explore our <code>data_df</code> object.</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="data-import-and-consolidation.html#cb412-1" tabindex="-1"></a>data_df</span>
<span id="cb412-2"><a href="data-import-and-consolidation.html#cb412-2" tabindex="-1"></a><span class="co">#&gt; # A tibble: 51 × 5</span></span>
<span id="cb412-3"><a href="data-import-and-consolidation.html#cb412-3" tabindex="-1"></a><span class="co">#&gt;    state                abb   region    population total</span></span>
<span id="cb412-4"><a href="data-import-and-consolidation.html#cb412-4" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;                &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb412-5"><a href="data-import-and-consolidation.html#cb412-5" tabindex="-1"></a><span class="co">#&gt;  1 Alabama              AL    South        4779736   135</span></span>
<span id="cb412-6"><a href="data-import-and-consolidation.html#cb412-6" tabindex="-1"></a><span class="co">#&gt;  2 Alaska               AK    West          710231    19</span></span>
<span id="cb412-7"><a href="data-import-and-consolidation.html#cb412-7" tabindex="-1"></a><span class="co">#&gt;  3 Arizona              AZ    West         6392017   232</span></span>
<span id="cb412-8"><a href="data-import-and-consolidation.html#cb412-8" tabindex="-1"></a><span class="co">#&gt;  4 Arkansas             AR    South        2915918    93</span></span>
<span id="cb412-9"><a href="data-import-and-consolidation.html#cb412-9" tabindex="-1"></a><span class="co">#&gt;  5 California           CA    West        37253956  1257</span></span>
<span id="cb412-10"><a href="data-import-and-consolidation.html#cb412-10" tabindex="-1"></a><span class="co">#&gt;  6 Colorado             CO    West         5029196    65</span></span>
<span id="cb412-11"><a href="data-import-and-consolidation.html#cb412-11" tabindex="-1"></a><span class="co">#&gt;  7 Connecticut          CT    Northeast    3574097    97</span></span>
<span id="cb412-12"><a href="data-import-and-consolidation.html#cb412-12" tabindex="-1"></a><span class="co">#&gt;  8 Delaware             DE    South         897934    38</span></span>
<span id="cb412-13"><a href="data-import-and-consolidation.html#cb412-13" tabindex="-1"></a><span class="co">#&gt;  9 District of Columbia DC    South         601723    99</span></span>
<span id="cb412-14"><a href="data-import-and-consolidation.html#cb412-14" tabindex="-1"></a><span class="co">#&gt; 10 Florida              FL    South       19687653   669</span></span>
<span id="cb412-15"><a href="data-import-and-consolidation.html#cb412-15" tabindex="-1"></a><span class="co">#&gt; # ℹ 41 more rows</span></span></code></pre></div>
<p>The first thing it indicates is that the object is of type <strong>tibble</strong>. This object is very similar to a data frame, but with improved features such as, for example, the number of rows and columns in the console, the data type under the header, the default report of only the first 10 records automatically, among many others that we will discover in this chapter.</p>
<p>The same syntax and logic would apply for importing an excel file. In this case we are importing directly from the package path and not from our working directory.</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="data-import-and-consolidation.html#cb413-1" tabindex="-1"></a>excel_example_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dslabs_path, <span class="st">&quot;2010_bigfive_regents.xls&quot;</span>)</span>
<span id="cb413-2"><a href="data-import-and-consolidation.html#cb413-2" tabindex="-1"></a>data_df_de_excel <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(excel_example_path)</span></code></pre></div>
<p><strong>readr</strong> gives us 7 different types of functions for importing flat files:</p>
<table>
<caption><span id="tab:date-format">TABLE 10.1: </span> readr functions for importing files</caption>
<colgroup>
<col width="16%" />
<col width="83%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Usage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>read_csv()</code></td>
<td align="left">Comma separated files</td>
</tr>
<tr class="even">
<td align="left"><code>read_tsv()</code></td>
<td align="left">Tab separated files</td>
</tr>
<tr class="odd">
<td align="left"><code>read_delim()</code></td>
<td align="left">General delimited files</td>
</tr>
<tr class="even">
<td align="left"><code>read_fwf()</code></td>
<td align="left">Fixed width files</td>
</tr>
<tr class="odd">
<td align="left"><code>read_table()</code></td>
<td align="left">Tabular files where columns are separated by white space</td>
</tr>
<tr class="even">
<td align="left"><code>read_log()</code></td>
<td align="left">Web log files</td>
</tr>
</tbody>
</table>
</div>
<div id="importing-files-from-the-internet" class="section level3 hasAnchor" number="10.1.3">
<h3><span class="header-section-number">10.1.3</span> Importing files from the internet<a href="data-import-and-consolidation.html#importing-files-from-the-internet" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We have seen how we can enter the full path to load a file directly from another source different from our working directory. In the same way, if we have a file in an internet path we can pass it directly to R since <code>read_csv()</code> and the other <strong>readr</strong> import functions support URL input as a parameter.</p>
<p>Here we see the import of grades from students of the Data Science with R course.</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="data-import-and-consolidation.html#cb414-1" tabindex="-1"></a><span class="do">##### Example 1:</span></span>
<span id="cb414-2"><a href="data-import-and-consolidation.html#cb414-2" tabindex="-1"></a><span class="co"># Historical grades data</span></span>
<span id="cb414-3"><a href="data-import-and-consolidation.html#cb414-3" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://dparedesi.github.io/DS-con-R/grades-estudiantes.csv&quot;</span></span>
<span id="cb414-4"><a href="data-import-and-consolidation.html#cb414-4" tabindex="-1"></a>grades <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(url)</span></code></pre></div>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="data-import-and-consolidation.html#cb415-1" tabindex="-1"></a>grades <span class="ot">&lt;-</span> grades <span class="sc">|&gt;</span></span>
<span id="cb415-2"><a href="data-import-and-consolidation.html#cb415-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total =</span> (P1 <span class="sc">+</span> P2 <span class="sc">+</span> P3 <span class="sc">+</span> P4 <span class="sc">+</span> P5 <span class="sc">+</span> P6)<span class="sc">/</span><span class="dv">30</span><span class="sc">*</span><span class="dv">20</span>)</span>
<span id="cb415-3"><a href="data-import-and-consolidation.html#cb415-3" tabindex="-1"></a></span>
<span id="cb415-4"><a href="data-import-and-consolidation.html#cb415-4" tabindex="-1"></a>grades <span class="sc">|&gt;</span> </span>
<span id="cb415-5"><a href="data-import-and-consolidation.html#cb415-5" tabindex="-1"></a>  <span class="fu">select</span>(P1, P2, P3, P4, P5, total) <span class="sc">|&gt;</span> </span>
<span id="cb415-6"><a href="data-import-and-consolidation.html#cb415-6" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<p>From this we could visualize a histogram:</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="data-import-and-consolidation.html#cb416-1" tabindex="-1"></a><span class="fu">hist</span>(grades<span class="sc">$</span>total)</span></code></pre></div>
<p>Or we could compare between genders which one has the highest median:</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="data-import-and-consolidation.html#cb417-1" tabindex="-1"></a>grades <span class="sc">|&gt;</span></span>
<span id="cb417-2"><a href="data-import-and-consolidation.html#cb417-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb417-3"><a href="data-import-and-consolidation.html#cb417-3" tabindex="-1"></a>  <span class="fu">aes</span>(gender, total) <span class="sc">+</span></span>
<span id="cb417-4"><a href="data-import-and-consolidation.html#cb417-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb417-5"><a href="data-import-and-consolidation.html#cb417-5" tabindex="-1"></a>  </span></code></pre></div>
<p>We could also extract updated Covid-19 information.</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="data-import-and-consolidation.html#cb418-1" tabindex="-1"></a><span class="do">##### Example 2:</span></span>
<span id="cb418-2"><a href="data-import-and-consolidation.html#cb418-2" tabindex="-1"></a><span class="co"># Covid-19 Data</span></span>
<span id="cb418-3"><a href="data-import-and-consolidation.html#cb418-3" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://covid.ourworldindata.org/data/owid-covid-data.csv&quot;</span></span>
<span id="cb418-4"><a href="data-import-and-consolidation.html#cb418-4" tabindex="-1"></a>internet_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(url)</span>
<span id="cb418-5"><a href="data-import-and-consolidation.html#cb418-5" tabindex="-1"></a></span>
<span id="cb418-6"><a href="data-import-and-consolidation.html#cb418-6" tabindex="-1"></a>internet_data <span class="sc">|&gt;</span> </span>
<span id="cb418-7"><a href="data-import-and-consolidation.html#cb418-7" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(date)) <span class="sc">|&gt;</span> </span>
<span id="cb418-8"><a href="data-import-and-consolidation.html#cb418-8" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
</div>
</div>
<div id="tidy-data" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Tidy data<a href="data-import-and-consolidation.html#tidy-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Ordered data or <em>tidy data</em> are those obtained from a process called <em>data tidying</em>. It is one of the important cleaning processes during processing of large data or ‘big data’ and is a very used step in Data Science. The main characteristics are that each different observation of that variable has to be in a different row and that each variable you measure has to be in a column <span class="citation">(<a href="#ref-leek2015">Leek 2015</a>)</span>.</p>
<p>As we may have noticed, we have been using <em>tidy data</em> since the first chapters. However, not all our data comes ordered. Most of it comes in what we call wide data or <em>wide data</em>.</p>
<p>For example, we have previously used data from Gapminder. Let’s filter the data from Germany and South Korea to remember how we had our data.</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="data-import-and-consolidation.html#cb419-1" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb419-2"><a href="data-import-and-consolidation.html#cb419-2" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;South Korea&quot;</span>, <span class="st">&quot;Germany&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb419-3"><a href="data-import-and-consolidation.html#cb419-3" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb419-4"><a href="data-import-and-consolidation.html#cb419-4" tabindex="-1"></a><span class="co">#&gt;        country year infant_mortality life_expectancy fertility population</span></span>
<span id="cb419-5"><a href="data-import-and-consolidation.html#cb419-5" tabindex="-1"></a><span class="co">#&gt; 1      Germany 1960             34.0           69.26      2.41   73179665</span></span>
<span id="cb419-6"><a href="data-import-and-consolidation.html#cb419-6" tabindex="-1"></a><span class="co">#&gt; 2  South Korea 1960             80.2           53.02      6.16   25074028</span></span>
<span id="cb419-7"><a href="data-import-and-consolidation.html#cb419-7" tabindex="-1"></a><span class="co">#&gt; 3      Germany 1961               NA           69.85      2.44   73686490</span></span>
<span id="cb419-8"><a href="data-import-and-consolidation.html#cb419-8" tabindex="-1"></a><span class="co">#&gt; 4  South Korea 1961             76.1           53.75      5.99   25808542</span></span>
<span id="cb419-9"><a href="data-import-and-consolidation.html#cb419-9" tabindex="-1"></a><span class="co">#&gt; 5      Germany 1962               NA           70.01      2.47   74238494</span></span>
<span id="cb419-10"><a href="data-import-and-consolidation.html#cb419-10" tabindex="-1"></a><span class="co">#&gt; 6  South Korea 1962             72.4           54.51      5.79   26495107</span></span>
<span id="cb419-11"><a href="data-import-and-consolidation.html#cb419-11" tabindex="-1"></a><span class="co">#&gt; 7      Germany 1963               NA           70.10      2.49   74820389</span></span>
<span id="cb419-12"><a href="data-import-and-consolidation.html#cb419-12" tabindex="-1"></a><span class="co">#&gt; 8  South Korea 1963             68.8           55.27      5.57   27143075</span></span>
<span id="cb419-13"><a href="data-import-and-consolidation.html#cb419-13" tabindex="-1"></a><span class="co">#&gt; 9      Germany 1964               NA           70.66      2.49   75410766</span></span>
<span id="cb419-14"><a href="data-import-and-consolidation.html#cb419-14" tabindex="-1"></a><span class="co">#&gt; 10 South Korea 1964             65.3           56.04      5.36   27770874</span></span>
<span id="cb419-15"><a href="data-import-and-consolidation.html#cb419-15" tabindex="-1"></a><span class="co">#&gt;            gdp continent         region</span></span>
<span id="cb419-16"><a href="data-import-and-consolidation.html#cb419-16" tabindex="-1"></a><span class="co">#&gt; 1           NA    Europe Western Europe</span></span>
<span id="cb419-17"><a href="data-import-and-consolidation.html#cb419-17" tabindex="-1"></a><span class="co">#&gt; 2  28928298962      Asia   Eastern Asia</span></span>
<span id="cb419-18"><a href="data-import-and-consolidation.html#cb419-18" tabindex="-1"></a><span class="co">#&gt; 3           NA    Europe Western Europe</span></span>
<span id="cb419-19"><a href="data-import-and-consolidation.html#cb419-19" tabindex="-1"></a><span class="co">#&gt; 4  30356298714      Asia   Eastern Asia</span></span>
<span id="cb419-20"><a href="data-import-and-consolidation.html#cb419-20" tabindex="-1"></a><span class="co">#&gt; 5           NA    Europe Western Europe</span></span>
<span id="cb419-21"><a href="data-import-and-consolidation.html#cb419-21" tabindex="-1"></a><span class="co">#&gt; 6  31102566019      Asia   Eastern Asia</span></span>
<span id="cb419-22"><a href="data-import-and-consolidation.html#cb419-22" tabindex="-1"></a><span class="co">#&gt; 7           NA    Europe Western Europe</span></span>
<span id="cb419-23"><a href="data-import-and-consolidation.html#cb419-23" tabindex="-1"></a><span class="co">#&gt; 8  34067175844      Asia   Eastern Asia</span></span>
<span id="cb419-24"><a href="data-import-and-consolidation.html#cb419-24" tabindex="-1"></a><span class="co">#&gt; 9           NA    Europe Western Europe</span></span>
<span id="cb419-25"><a href="data-import-and-consolidation.html#cb419-25" tabindex="-1"></a><span class="co">#&gt; 10 36643076469      Asia   Eastern Asia</span></span></code></pre></div>
<p>We notice that each row is an observation and each column represents a variable. It is ordered data, <em>tidy data</em>. On the other hand, we can see what the data was like for these two countries if we access the source in the <code>dslabs</code> package.</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="data-import-and-consolidation.html#cb420-1" tabindex="-1"></a>fertility_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dslabs_path, <span class="st">&quot;fertility-two-countries-example.csv&quot;</span>)</span>
<span id="cb420-2"><a href="data-import-and-consolidation.html#cb420-2" tabindex="-1"></a></span>
<span id="cb420-3"><a href="data-import-and-consolidation.html#cb420-3" tabindex="-1"></a>wide_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(fertility_path)</span>
<span id="cb420-4"><a href="data-import-and-consolidation.html#cb420-4" tabindex="-1"></a><span class="co">#&gt; Rows: 2 Columns: 57</span></span>
<span id="cb420-5"><a href="data-import-and-consolidation.html#cb420-5" tabindex="-1"></a><span class="co">#&gt; ── Column specification ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></span>
<span id="cb420-6"><a href="data-import-and-consolidation.html#cb420-6" tabindex="-1"></a><span class="co">#&gt; Delimiter: &quot;,&quot;</span></span>
<span id="cb420-7"><a href="data-import-and-consolidation.html#cb420-7" tabindex="-1"></a><span class="co">#&gt; chr  (1): country</span></span>
<span id="cb420-8"><a href="data-import-and-consolidation.html#cb420-8" tabindex="-1"></a><span class="co">#&gt; dbl (56): 1960, 1961, 1962, 1963, 1964, 1965, 1966, 1967, 1968, 1969, 1970, ...</span></span>
<span id="cb420-9"><a href="data-import-and-consolidation.html#cb420-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb420-10"><a href="data-import-and-consolidation.html#cb420-10" tabindex="-1"></a><span class="co">#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span id="cb420-11"><a href="data-import-and-consolidation.html#cb420-11" tabindex="-1"></a><span class="co">#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span id="cb420-12"><a href="data-import-and-consolidation.html#cb420-12" tabindex="-1"></a></span>
<span id="cb420-13"><a href="data-import-and-consolidation.html#cb420-13" tabindex="-1"></a>wide_data</span>
<span id="cb420-14"><a href="data-import-and-consolidation.html#cb420-14" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 57</span></span>
<span id="cb420-15"><a href="data-import-and-consolidation.html#cb420-15" tabindex="-1"></a><span class="co">#&gt;   country  `1960` `1961` `1962` `1963` `1964` `1965` `1966` `1967` `1968` `1969`</span></span>
<span id="cb420-16"><a href="data-import-and-consolidation.html#cb420-16" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb420-17"><a href="data-import-and-consolidation.html#cb420-17" tabindex="-1"></a><span class="co">#&gt; 1 Germany    2.41   2.44   2.47   2.49   2.49   2.48   2.44   2.37   2.28   2.17</span></span>
<span id="cb420-18"><a href="data-import-and-consolidation.html#cb420-18" tabindex="-1"></a><span class="co">#&gt; 2 South K…   6.16   5.99   5.79   5.57   5.36   5.16   4.99   4.85   4.73   4.62</span></span>
<span id="cb420-19"><a href="data-import-and-consolidation.html#cb420-19" tabindex="-1"></a><span class="co">#&gt; # ℹ 46 more variables: `1970` &lt;dbl&gt;, `1971` &lt;dbl&gt;, `1972` &lt;dbl&gt;, `1973` &lt;dbl&gt;,</span></span>
<span id="cb420-20"><a href="data-import-and-consolidation.html#cb420-20" tabindex="-1"></a><span class="co">#&gt; #   `1974` &lt;dbl&gt;, `1975` &lt;dbl&gt;, `1976` &lt;dbl&gt;, `1977` &lt;dbl&gt;, `1978` &lt;dbl&gt;,</span></span>
<span id="cb420-21"><a href="data-import-and-consolidation.html#cb420-21" tabindex="-1"></a><span class="co">#&gt; #   `1979` &lt;dbl&gt;, `1980` &lt;dbl&gt;, `1981` &lt;dbl&gt;, `1982` &lt;dbl&gt;, `1983` &lt;dbl&gt;,</span></span>
<span id="cb420-22"><a href="data-import-and-consolidation.html#cb420-22" tabindex="-1"></a><span class="co">#&gt; #   `1984` &lt;dbl&gt;, `1985` &lt;dbl&gt;, `1986` &lt;dbl&gt;, `1987` &lt;dbl&gt;, `1988` &lt;dbl&gt;,</span></span>
<span id="cb420-23"><a href="data-import-and-consolidation.html#cb420-23" tabindex="-1"></a><span class="co">#&gt; #   `1989` &lt;dbl&gt;, `1990` &lt;dbl&gt;, `1991` &lt;dbl&gt;, `1992` &lt;dbl&gt;, `1993` &lt;dbl&gt;,</span></span>
<span id="cb420-24"><a href="data-import-and-consolidation.html#cb420-24" tabindex="-1"></a><span class="co">#&gt; #   `1994` &lt;dbl&gt;, `1995` &lt;dbl&gt;, `1996` &lt;dbl&gt;, `1997` &lt;dbl&gt;, `1998` &lt;dbl&gt;,</span></span>
<span id="cb420-25"><a href="data-import-and-consolidation.html#cb420-25" tabindex="-1"></a><span class="co">#&gt; #   `1999` &lt;dbl&gt;, `2000` &lt;dbl&gt;, `2001` &lt;dbl&gt;, `2002` &lt;dbl&gt;, `2003` &lt;dbl&gt;, …</span></span></code></pre></div>
<p>We see that the original data had two rows, one per country and then each column represented a year. This is what we call wide data or <em>wide data</em>. Normally we will have <em>wide data</em> that we first have to convert to <em>tidy data</em> to later be able to perform our analyses.</p>
<div id="transforming-to-tidy-data" class="section level3 hasAnchor" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Transforming to tidy data<a href="data-import-and-consolidation.html#transforming-to-tidy-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>tidyverse</code> library provides two functions to reshape data between <em>wide</em> and <em>long</em> (tidy) formats. We use <code>pivot_longer()</code> to convert from <em>wide data</em> to <em>tidy data</em> and <code>pivot_wider()</code> to convert from <em>tidy data</em> to <em>wide data</em>.</p>
<div id="pivot_longer-function" class="section level4 hasAnchor" number="10.2.1.1">
<h4><span class="header-section-number">10.2.1.1</span> pivot_longer function<a href="data-import-and-consolidation.html#pivot_longer-function" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s see the utility with the <code>wide_data</code> object that we created in the previous section as a result of importing data from the csv. First apply the <code>pivot_longer()</code> function to explore the conversion that is performed by default.</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="data-import-and-consolidation.html#cb421-1" tabindex="-1"></a>tidy_data <span class="ot">&lt;-</span> wide_data <span class="sc">|&gt;</span></span>
<span id="cb421-2"><a href="data-import-and-consolidation.html#cb421-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>country, <span class="at">names_to =</span> <span class="st">&quot;key&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb421-3"><a href="data-import-and-consolidation.html#cb421-3" tabindex="-1"></a></span>
<span id="cb421-4"><a href="data-import-and-consolidation.html#cb421-4" tabindex="-1"></a>tidy_data</span>
<span id="cb421-5"><a href="data-import-and-consolidation.html#cb421-5" tabindex="-1"></a><span class="co">#&gt; # A tibble: 112 × 3</span></span>
<span id="cb421-6"><a href="data-import-and-consolidation.html#cb421-6" tabindex="-1"></a><span class="co">#&gt;    country key   value</span></span>
<span id="cb421-7"><a href="data-import-and-consolidation.html#cb421-7" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;</span></span>
<span id="cb421-8"><a href="data-import-and-consolidation.html#cb421-8" tabindex="-1"></a><span class="co">#&gt;  1 Germany 1960   2.41</span></span>
<span id="cb421-9"><a href="data-import-and-consolidation.html#cb421-9" tabindex="-1"></a><span class="co">#&gt;  2 Germany 1961   2.44</span></span>
<span id="cb421-10"><a href="data-import-and-consolidation.html#cb421-10" tabindex="-1"></a><span class="co">#&gt;  3 Germany 1962   2.47</span></span>
<span id="cb421-11"><a href="data-import-and-consolidation.html#cb421-11" tabindex="-1"></a><span class="co">#&gt;  4 Germany 1963   2.49</span></span>
<span id="cb421-12"><a href="data-import-and-consolidation.html#cb421-12" tabindex="-1"></a><span class="co">#&gt;  5 Germany 1964   2.49</span></span>
<span id="cb421-13"><a href="data-import-and-consolidation.html#cb421-13" tabindex="-1"></a><span class="co">#&gt;  6 Germany 1965   2.48</span></span>
<span id="cb421-14"><a href="data-import-and-consolidation.html#cb421-14" tabindex="-1"></a><span class="co">#&gt;  7 Germany 1966   2.44</span></span>
<span id="cb421-15"><a href="data-import-and-consolidation.html#cb421-15" tabindex="-1"></a><span class="co">#&gt;  8 Germany 1967   2.37</span></span>
<span id="cb421-16"><a href="data-import-and-consolidation.html#cb421-16" tabindex="-1"></a><span class="co">#&gt;  9 Germany 1968   2.28</span></span>
<span id="cb421-17"><a href="data-import-and-consolidation.html#cb421-17" tabindex="-1"></a><span class="co">#&gt; 10 Germany 1969   2.17</span></span>
<span id="cb421-18"><a href="data-import-and-consolidation.html#cb421-18" tabindex="-1"></a><span class="co">#&gt; # ℹ 102 more rows</span></span></code></pre></div>
<p>We see how the <code>pivot_longer()</code> function has collected the columns into two, the names column (“key”) and the values column (“value”). We can change the title of these new columns, for example “year” and “fertility”.</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="data-import-and-consolidation.html#cb422-1" tabindex="-1"></a>tidy_data <span class="ot">&lt;-</span> wide_data <span class="sc">|&gt;</span></span>
<span id="cb422-2"><a href="data-import-and-consolidation.html#cb422-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>country, <span class="at">names_to =</span> <span class="st">&quot;year&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;fertility&quot;</span>)</span>
<span id="cb422-3"><a href="data-import-and-consolidation.html#cb422-3" tabindex="-1"></a></span>
<span id="cb422-4"><a href="data-import-and-consolidation.html#cb422-4" tabindex="-1"></a>tidy_data</span>
<span id="cb422-5"><a href="data-import-and-consolidation.html#cb422-5" tabindex="-1"></a><span class="co">#&gt; # A tibble: 112 × 3</span></span>
<span id="cb422-6"><a href="data-import-and-consolidation.html#cb422-6" tabindex="-1"></a><span class="co">#&gt;    country year  fertility</span></span>
<span id="cb422-7"><a href="data-import-and-consolidation.html#cb422-7" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt;</span></span>
<span id="cb422-8"><a href="data-import-and-consolidation.html#cb422-8" tabindex="-1"></a><span class="co">#&gt;  1 Germany 1960       2.41</span></span>
<span id="cb422-9"><a href="data-import-and-consolidation.html#cb422-9" tabindex="-1"></a><span class="co">#&gt;  2 Germany 1961       2.44</span></span>
<span id="cb422-10"><a href="data-import-and-consolidation.html#cb422-10" tabindex="-1"></a><span class="co">#&gt;  3 Germany 1962       2.47</span></span>
<span id="cb422-11"><a href="data-import-and-consolidation.html#cb422-11" tabindex="-1"></a><span class="co">#&gt;  4 Germany 1963       2.49</span></span>
<span id="cb422-12"><a href="data-import-and-consolidation.html#cb422-12" tabindex="-1"></a><span class="co">#&gt;  5 Germany 1964       2.49</span></span>
<span id="cb422-13"><a href="data-import-and-consolidation.html#cb422-13" tabindex="-1"></a><span class="co">#&gt;  6 Germany 1965       2.48</span></span>
<span id="cb422-14"><a href="data-import-and-consolidation.html#cb422-14" tabindex="-1"></a><span class="co">#&gt;  7 Germany 1966       2.44</span></span>
<span id="cb422-15"><a href="data-import-and-consolidation.html#cb422-15" tabindex="-1"></a><span class="co">#&gt;  8 Germany 1967       2.37</span></span>
<span id="cb422-16"><a href="data-import-and-consolidation.html#cb422-16" tabindex="-1"></a><span class="co">#&gt;  9 Germany 1968       2.28</span></span>
<span id="cb422-17"><a href="data-import-and-consolidation.html#cb422-17" tabindex="-1"></a><span class="co">#&gt; 10 Germany 1969       2.17</span></span>
<span id="cb422-18"><a href="data-import-and-consolidation.html#cb422-18" tabindex="-1"></a><span class="co">#&gt; # ℹ 102 more rows</span></span></code></pre></div>
<p>We use <code>cols = -country</code> to exclude the country column from being pivoted. By default the column names are collected as text. To convert them to numbers we use the <code>names_transform</code> argument.</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="data-import-and-consolidation.html#cb423-1" tabindex="-1"></a>tidy_data <span class="ot">&lt;-</span> wide_data <span class="sc">|&gt;</span></span>
<span id="cb423-2"><a href="data-import-and-consolidation.html#cb423-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>country, <span class="at">names_to =</span> <span class="st">&quot;year&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;fertility&quot;</span>,</span>
<span id="cb423-3"><a href="data-import-and-consolidation.html#cb423-3" tabindex="-1"></a>               <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">year =</span> as.integer))</span>
<span id="cb423-4"><a href="data-import-and-consolidation.html#cb423-4" tabindex="-1"></a></span>
<span id="cb423-5"><a href="data-import-and-consolidation.html#cb423-5" tabindex="-1"></a>tidy_data</span>
<span id="cb423-6"><a href="data-import-and-consolidation.html#cb423-6" tabindex="-1"></a><span class="co">#&gt; # A tibble: 112 × 3</span></span>
<span id="cb423-7"><a href="data-import-and-consolidation.html#cb423-7" tabindex="-1"></a><span class="co">#&gt;    country  year fertility</span></span>
<span id="cb423-8"><a href="data-import-and-consolidation.html#cb423-8" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;   &lt;int&gt;     &lt;dbl&gt;</span></span>
<span id="cb423-9"><a href="data-import-and-consolidation.html#cb423-9" tabindex="-1"></a><span class="co">#&gt;  1 Germany  1960      2.41</span></span>
<span id="cb423-10"><a href="data-import-and-consolidation.html#cb423-10" tabindex="-1"></a><span class="co">#&gt;  2 Germany  1961      2.44</span></span>
<span id="cb423-11"><a href="data-import-and-consolidation.html#cb423-11" tabindex="-1"></a><span class="co">#&gt;  3 Germany  1962      2.47</span></span>
<span id="cb423-12"><a href="data-import-and-consolidation.html#cb423-12" tabindex="-1"></a><span class="co">#&gt;  4 Germany  1963      2.49</span></span>
<span id="cb423-13"><a href="data-import-and-consolidation.html#cb423-13" tabindex="-1"></a><span class="co">#&gt;  5 Germany  1964      2.49</span></span>
<span id="cb423-14"><a href="data-import-and-consolidation.html#cb423-14" tabindex="-1"></a><span class="co">#&gt;  6 Germany  1965      2.48</span></span>
<span id="cb423-15"><a href="data-import-and-consolidation.html#cb423-15" tabindex="-1"></a><span class="co">#&gt;  7 Germany  1966      2.44</span></span>
<span id="cb423-16"><a href="data-import-and-consolidation.html#cb423-16" tabindex="-1"></a><span class="co">#&gt;  8 Germany  1967      2.37</span></span>
<span id="cb423-17"><a href="data-import-and-consolidation.html#cb423-17" tabindex="-1"></a><span class="co">#&gt;  9 Germany  1968      2.28</span></span>
<span id="cb423-18"><a href="data-import-and-consolidation.html#cb423-18" tabindex="-1"></a><span class="co">#&gt; 10 Germany  1969      2.17</span></span>
<span id="cb423-19"><a href="data-import-and-consolidation.html#cb423-19" tabindex="-1"></a><span class="co">#&gt; # ℹ 102 more rows</span></span></code></pre></div>
<p>This data would now be ready to create graphs using <code>ggplot()</code>.</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="data-import-and-consolidation.html#cb424-1" tabindex="-1"></a>tidy_data <span class="sc">|&gt;</span></span>
<span id="cb424-2"><a href="data-import-and-consolidation.html#cb424-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb424-3"><a href="data-import-and-consolidation.html#cb424-3" tabindex="-1"></a>  <span class="fu">aes</span>(year, fertility, <span class="at">color =</span> country) <span class="sc">+</span></span>
<span id="cb424-4"><a href="data-import-and-consolidation.html#cb424-4" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="Data-Science-with-R_files/figure-html/unnamed-chunk-550-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="pivot_wider-function" class="section level4 hasAnchor" number="10.2.1.2">
<h4><span class="header-section-number">10.2.1.2</span> pivot_wider function<a href="data-import-and-consolidation.html#pivot_wider-function" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Sometimes, as we will see in the following section, it will be useful to go back from rows to columns. For this we will use the <code>pivot_wider()</code> function, where we specify <code>names_from</code> (the column containing the new column names) and <code>values_from</code> (the column containing the values). Additionally, we can use the <code>:</code> operator to indicate from which column to which column we want to select.</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="data-import-and-consolidation.html#cb425-1" tabindex="-1"></a>tidy_data <span class="sc">|&gt;</span> </span>
<span id="cb425-2"><a href="data-import-and-consolidation.html#cb425-2" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> year, <span class="at">values_from =</span> fertility) <span class="sc">|&gt;</span> </span>
<span id="cb425-3"><a href="data-import-and-consolidation.html#cb425-3" tabindex="-1"></a>  <span class="fu">select</span>(country, <span class="st">`</span><span class="at">1965</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">1970</span><span class="st">`</span>)</span>
<span id="cb425-4"><a href="data-import-and-consolidation.html#cb425-4" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 7</span></span>
<span id="cb425-5"><a href="data-import-and-consolidation.html#cb425-5" tabindex="-1"></a><span class="co">#&gt;   country     `1965` `1966` `1967` `1968` `1969` `1970`</span></span>
<span id="cb425-6"><a href="data-import-and-consolidation.html#cb425-6" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb425-7"><a href="data-import-and-consolidation.html#cb425-7" tabindex="-1"></a><span class="co">#&gt; 1 Germany       2.48   2.44   2.37   2.28   2.17   2.04</span></span>
<span id="cb425-8"><a href="data-import-and-consolidation.html#cb425-8" tabindex="-1"></a><span class="co">#&gt; 2 South Korea   5.16   4.99   4.85   4.73   4.62   4.53</span></span></code></pre></div>
</div>
</div>
<div id="separate-function" class="section level3 hasAnchor" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> separate function<a href="data-import-and-consolidation.html#separate-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the cases described above we had a situation with relatively ordered data. We only had to do a collection transformation and converted to <em>tidy data</em>. However, the data is not always stored in such an easily interpretable way. Sometimes we have data like this:</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="data-import-and-consolidation.html#cb426-1" tabindex="-1"></a>ruta <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dslabs_path, <span class="st">&quot;life-expectancy-and-fertility-two-countries-example.csv&quot;</span>)</span>
<span id="cb426-2"><a href="data-import-and-consolidation.html#cb426-2" tabindex="-1"></a></span>
<span id="cb426-3"><a href="data-import-and-consolidation.html#cb426-3" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(ruta)</span>
<span id="cb426-4"><a href="data-import-and-consolidation.html#cb426-4" tabindex="-1"></a><span class="co">#&gt; Rows: 2 Columns: 113</span></span>
<span id="cb426-5"><a href="data-import-and-consolidation.html#cb426-5" tabindex="-1"></a><span class="co">#&gt; ── Column specification ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></span>
<span id="cb426-6"><a href="data-import-and-consolidation.html#cb426-6" tabindex="-1"></a><span class="co">#&gt; Delimiter: &quot;,&quot;</span></span>
<span id="cb426-7"><a href="data-import-and-consolidation.html#cb426-7" tabindex="-1"></a><span class="co">#&gt; chr   (1): country</span></span>
<span id="cb426-8"><a href="data-import-and-consolidation.html#cb426-8" tabindex="-1"></a><span class="co">#&gt; dbl (112): 1960_fertility, 1960_life_expectancy, 1961_fertility, 1961_life_e...</span></span>
<span id="cb426-9"><a href="data-import-and-consolidation.html#cb426-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb426-10"><a href="data-import-and-consolidation.html#cb426-10" tabindex="-1"></a><span class="co">#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span id="cb426-11"><a href="data-import-and-consolidation.html#cb426-11" tabindex="-1"></a><span class="co">#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span id="cb426-12"><a href="data-import-and-consolidation.html#cb426-12" tabindex="-1"></a></span>
<span id="cb426-13"><a href="data-import-and-consolidation.html#cb426-13" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb426-14"><a href="data-import-and-consolidation.html#cb426-14" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="co">#Report first 5 columns</span></span>
<span id="cb426-15"><a href="data-import-and-consolidation.html#cb426-15" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 5</span></span>
<span id="cb426-16"><a href="data-import-and-consolidation.html#cb426-16" tabindex="-1"></a><span class="co">#&gt;   country     `1960_fertility` `1960_life_expectancy` `1961_fertility`</span></span>
<span id="cb426-17"><a href="data-import-and-consolidation.html#cb426-17" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;                  &lt;dbl&gt;                  &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span id="cb426-18"><a href="data-import-and-consolidation.html#cb426-18" tabindex="-1"></a><span class="co">#&gt; 1 Germany                 2.41                   69.3             2.44</span></span>
<span id="cb426-19"><a href="data-import-and-consolidation.html#cb426-19" tabindex="-1"></a><span class="co">#&gt; 2 South Korea             6.16                   53.0             5.99</span></span>
<span id="cb426-20"><a href="data-import-and-consolidation.html#cb426-20" tabindex="-1"></a><span class="co">#&gt; # ℹ 1 more variable: `1961_life_expectancy` &lt;dbl&gt;</span></span></code></pre></div>
<p>If we apply <code>pivot_longer()</code> directly we would not have our data ordered yet. Let’s see:</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="data-import-and-consolidation.html#cb427-1" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb427-2"><a href="data-import-and-consolidation.html#cb427-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>country, <span class="at">names_to =</span> <span class="st">&quot;key_col&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;value_col&quot;</span>)</span>
<span id="cb427-3"><a href="data-import-and-consolidation.html#cb427-3" tabindex="-1"></a><span class="co">#&gt; # A tibble: 224 × 3</span></span>
<span id="cb427-4"><a href="data-import-and-consolidation.html#cb427-4" tabindex="-1"></a><span class="co">#&gt;    country key_col              value_col</span></span>
<span id="cb427-5"><a href="data-import-and-consolidation.html#cb427-5" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;                    &lt;dbl&gt;</span></span>
<span id="cb427-6"><a href="data-import-and-consolidation.html#cb427-6" tabindex="-1"></a><span class="co">#&gt;  1 Germany 1960_fertility            2.41</span></span>
<span id="cb427-7"><a href="data-import-and-consolidation.html#cb427-7" tabindex="-1"></a><span class="co">#&gt;  2 Germany 1960_life_expectancy     69.3 </span></span>
<span id="cb427-8"><a href="data-import-and-consolidation.html#cb427-8" tabindex="-1"></a><span class="co">#&gt;  3 Germany 1961_fertility            2.44</span></span>
<span id="cb427-9"><a href="data-import-and-consolidation.html#cb427-9" tabindex="-1"></a><span class="co">#&gt;  4 Germany 1961_life_expectancy     69.8 </span></span>
<span id="cb427-10"><a href="data-import-and-consolidation.html#cb427-10" tabindex="-1"></a><span class="co">#&gt;  5 Germany 1962_fertility            2.47</span></span>
<span id="cb427-11"><a href="data-import-and-consolidation.html#cb427-11" tabindex="-1"></a><span class="co">#&gt;  6 Germany 1962_life_expectancy     70.0 </span></span>
<span id="cb427-12"><a href="data-import-and-consolidation.html#cb427-12" tabindex="-1"></a><span class="co">#&gt;  7 Germany 1963_fertility            2.49</span></span>
<span id="cb427-13"><a href="data-import-and-consolidation.html#cb427-13" tabindex="-1"></a><span class="co">#&gt;  8 Germany 1963_life_expectancy     70.1 </span></span>
<span id="cb427-14"><a href="data-import-and-consolidation.html#cb427-14" tabindex="-1"></a><span class="co">#&gt;  9 Germany 1964_fertility            2.49</span></span>
<span id="cb427-15"><a href="data-import-and-consolidation.html#cb427-15" tabindex="-1"></a><span class="co">#&gt; 10 Germany 1964_life_expectancy     70.7 </span></span>
<span id="cb427-16"><a href="data-import-and-consolidation.html#cb427-16" tabindex="-1"></a><span class="co">#&gt; # ℹ 214 more rows</span></span></code></pre></div>
<p>We will use the <code>separate()</code> function to separate a column into multiple columns using a specific separator. In this case our separator would be the character <code>_</code>. Also, we will add the attribute <code>extra="merge"</code> to indicate that if there is more than one separator character, do not separate them and keep them joined.</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="data-import-and-consolidation.html#cb428-1" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb428-2"><a href="data-import-and-consolidation.html#cb428-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>country, <span class="at">names_to =</span> <span class="st">&quot;key_col&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;value_col&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb428-3"><a href="data-import-and-consolidation.html#cb428-3" tabindex="-1"></a>  <span class="fu">separate</span>(key_col, <span class="fu">c</span>(<span class="st">&quot;año&quot;</span>, <span class="st">&quot;other_var&quot;</span>), <span class="at">sep=</span><span class="st">&quot;_&quot;</span>, <span class="at">extra =</span> <span class="st">&quot;merge&quot;</span>)</span>
<span id="cb428-4"><a href="data-import-and-consolidation.html#cb428-4" tabindex="-1"></a><span class="co">#&gt; # A tibble: 224 × 4</span></span>
<span id="cb428-5"><a href="data-import-and-consolidation.html#cb428-5" tabindex="-1"></a><span class="co">#&gt;    country año   other_var       value_col</span></span>
<span id="cb428-6"><a href="data-import-and-consolidation.html#cb428-6" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;               &lt;dbl&gt;</span></span>
<span id="cb428-7"><a href="data-import-and-consolidation.html#cb428-7" tabindex="-1"></a><span class="co">#&gt;  1 Germany 1960  fertility            2.41</span></span>
<span id="cb428-8"><a href="data-import-and-consolidation.html#cb428-8" tabindex="-1"></a><span class="co">#&gt;  2 Germany 1960  life_expectancy     69.3 </span></span>
<span id="cb428-9"><a href="data-import-and-consolidation.html#cb428-9" tabindex="-1"></a><span class="co">#&gt;  3 Germany 1961  fertility            2.44</span></span>
<span id="cb428-10"><a href="data-import-and-consolidation.html#cb428-10" tabindex="-1"></a><span class="co">#&gt;  4 Germany 1961  life_expectancy     69.8 </span></span>
<span id="cb428-11"><a href="data-import-and-consolidation.html#cb428-11" tabindex="-1"></a><span class="co">#&gt;  5 Germany 1962  fertility            2.47</span></span>
<span id="cb428-12"><a href="data-import-and-consolidation.html#cb428-12" tabindex="-1"></a><span class="co">#&gt;  6 Germany 1962  life_expectancy     70.0 </span></span>
<span id="cb428-13"><a href="data-import-and-consolidation.html#cb428-13" tabindex="-1"></a><span class="co">#&gt;  7 Germany 1963  fertility            2.49</span></span>
<span id="cb428-14"><a href="data-import-and-consolidation.html#cb428-14" tabindex="-1"></a><span class="co">#&gt;  8 Germany 1963  life_expectancy     70.1 </span></span>
<span id="cb428-15"><a href="data-import-and-consolidation.html#cb428-15" tabindex="-1"></a><span class="co">#&gt;  9 Germany 1964  fertility            2.49</span></span>
<span id="cb428-16"><a href="data-import-and-consolidation.html#cb428-16" tabindex="-1"></a><span class="co">#&gt; 10 Germany 1964  life_expectancy     70.7 </span></span>
<span id="cb428-17"><a href="data-import-and-consolidation.html#cb428-17" tabindex="-1"></a><span class="co">#&gt; # ℹ 214 more rows</span></span></code></pre></div>
<p>We already have the year separated, but this data is still not <em>tidy data</em> since there is a row for fertility and a row for life expectancy for each country. We have to pass these values from row to columns. And for that we already learned that we can use the <code>pivot_wider()</code> function</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="data-import-and-consolidation.html#cb429-1" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb429-2"><a href="data-import-and-consolidation.html#cb429-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>country, <span class="at">names_to =</span> <span class="st">&quot;key_col&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;value_col&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb429-3"><a href="data-import-and-consolidation.html#cb429-3" tabindex="-1"></a>  <span class="fu">separate</span>(key_col, <span class="fu">c</span>(<span class="st">&quot;año&quot;</span>, <span class="st">&quot;other_var&quot;</span>), <span class="at">sep=</span><span class="st">&quot;_&quot;</span>, <span class="at">extra =</span> <span class="st">&quot;merge&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb429-4"><a href="data-import-and-consolidation.html#cb429-4" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> other_var, <span class="at">values_from =</span> value_col)</span>
<span id="cb429-5"><a href="data-import-and-consolidation.html#cb429-5" tabindex="-1"></a><span class="co">#&gt; # A tibble: 112 × 4</span></span>
<span id="cb429-6"><a href="data-import-and-consolidation.html#cb429-6" tabindex="-1"></a><span class="co">#&gt;    country año   fertility life_expectancy</span></span>
<span id="cb429-7"><a href="data-import-and-consolidation.html#cb429-7" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt;           &lt;dbl&gt;</span></span>
<span id="cb429-8"><a href="data-import-and-consolidation.html#cb429-8" tabindex="-1"></a><span class="co">#&gt;  1 Germany 1960       2.41            69.3</span></span>
<span id="cb429-9"><a href="data-import-and-consolidation.html#cb429-9" tabindex="-1"></a><span class="co">#&gt;  2 Germany 1961       2.44            69.8</span></span>
<span id="cb429-10"><a href="data-import-and-consolidation.html#cb429-10" tabindex="-1"></a><span class="co">#&gt;  3 Germany 1962       2.47            70.0</span></span>
<span id="cb429-11"><a href="data-import-and-consolidation.html#cb429-11" tabindex="-1"></a><span class="co">#&gt;  4 Germany 1963       2.49            70.1</span></span>
<span id="cb429-12"><a href="data-import-and-consolidation.html#cb429-12" tabindex="-1"></a><span class="co">#&gt;  5 Germany 1964       2.49            70.7</span></span>
<span id="cb429-13"><a href="data-import-and-consolidation.html#cb429-13" tabindex="-1"></a><span class="co">#&gt;  6 Germany 1965       2.48            70.6</span></span>
<span id="cb429-14"><a href="data-import-and-consolidation.html#cb429-14" tabindex="-1"></a><span class="co">#&gt;  7 Germany 1966       2.44            70.8</span></span>
<span id="cb429-15"><a href="data-import-and-consolidation.html#cb429-15" tabindex="-1"></a><span class="co">#&gt;  8 Germany 1967       2.37            71.0</span></span>
<span id="cb429-16"><a href="data-import-and-consolidation.html#cb429-16" tabindex="-1"></a><span class="co">#&gt;  9 Germany 1968       2.28            70.6</span></span>
<span id="cb429-17"><a href="data-import-and-consolidation.html#cb429-17" tabindex="-1"></a><span class="co">#&gt; 10 Germany 1969       2.17            70.5</span></span>
<span id="cb429-18"><a href="data-import-and-consolidation.html#cb429-18" tabindex="-1"></a><span class="co">#&gt; # ℹ 102 more rows</span></span></code></pre></div>
<p>In other cases, instead of separating a column we will want to join them. In future cases we will see how the <code>unite(column_1, column2)</code> function can also be useful.</p>
</div>
</div>
<div id="exercises-14" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Exercises<a href="data-import-and-consolidation.html#exercises-14" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol start="87" style="list-style-type: decimal">
<li>Explore the following file: <a href="https://dparedesi.github.io/DS-con-R/uber_peru_2010.csv" class="uri">https://dparedesi.github.io/DS-con-R/uber_peru_2010.csv</a> and import it into the <code>uber_peru_2010</code> object.</li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="data-import-and-consolidation.html#cb430-1" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://dparedesi.github.io/DS-con-R/uber_peru_2010.csv&quot;</span></span>
<span id="cb430-2"><a href="data-import-and-consolidation.html#cb430-2" tabindex="-1"></a></span>
<span id="cb430-3"><a href="data-import-and-consolidation.html#cb430-3" tabindex="-1"></a><span class="co"># We will use read_csv since it is separated by commas</span></span>
<span id="cb430-4"><a href="data-import-and-consolidation.html#cb430-4" tabindex="-1"></a>uber_peru_2010 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(url)</span>
<span id="cb430-5"><a href="data-import-and-consolidation.html#cb430-5" tabindex="-1"></a></span>
<span id="cb430-6"><a href="data-import-and-consolidation.html#cb430-6" tabindex="-1"></a><span class="co"># Upon importing it we realize it is separated by &quot;;&quot;</span></span>
<span id="cb430-7"><a href="data-import-and-consolidation.html#cb430-7" tabindex="-1"></a>uber_peru_2010 <span class="sc">|&gt;</span> </span>
<span id="cb430-8"><a href="data-import-and-consolidation.html#cb430-8" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb430-9"><a href="data-import-and-consolidation.html#cb430-9" tabindex="-1"></a></span>
<span id="cb430-10"><a href="data-import-and-consolidation.html#cb430-10" tabindex="-1"></a><span class="co"># Therefore we import again using read_delim</span></span>
<span id="cb430-11"><a href="data-import-and-consolidation.html#cb430-11" tabindex="-1"></a>uber_peru_2010 <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">&quot;external/uber_peru_2010.csv&quot;</span>, </span>
<span id="cb430-12"><a href="data-import-and-consolidation.html#cb430-12" tabindex="-1"></a>                             <span class="at">delim =</span> <span class="st">&quot;;&quot;</span>, </span>
<span id="cb430-13"><a href="data-import-and-consolidation.html#cb430-13" tabindex="-1"></a>                             <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">.default =</span> <span class="st">&quot;c&quot;</span>)</span>
<span id="cb430-14"><a href="data-import-and-consolidation.html#cb430-14" tabindex="-1"></a>                             )</span>
<span id="cb430-15"><a href="data-import-and-consolidation.html#cb430-15" tabindex="-1"></a></span>
<span id="cb430-16"><a href="data-import-and-consolidation.html#cb430-16" tabindex="-1"></a>uber_peru_2010 <span class="sc">|&gt;</span> </span>
<span id="cb430-17"><a href="data-import-and-consolidation.html#cb430-17" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
</details>
<ol start="88" style="list-style-type: decimal">
<li>Explore the following file: <a href="https://www.datosabiertos.gob.pe/sites/default/files/DATASET_SINADEF.csv" class="uri">https://www.datosabiertos.gob.pe/sites/default/files/DATASET_SINADEF.csv</a> and import it into the <code>deaths</code> object.</li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="data-import-and-consolidation.html#cb431-1" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://www.datosabiertos.gob.pe/sites/default/files/DATASET_SINADEF.csv&quot;</span></span>
<span id="cb431-2"><a href="data-import-and-consolidation.html#cb431-2" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://dparedesi.github.io/DS-con-R/DATASET_SINADEF.csv&quot;</span></span>
<span id="cb431-3"><a href="data-import-and-consolidation.html#cb431-3" tabindex="-1"></a></span>
<span id="cb431-4"><a href="data-import-and-consolidation.html#cb431-4" tabindex="-1"></a><span class="co"># We will use read_delim because it is delimited by &quot;;&quot; and not by &quot;,&quot;</span></span>
<span id="cb431-5"><a href="data-import-and-consolidation.html#cb431-5" tabindex="-1"></a><span class="co"># Also we change the encoding to avoid error in loading</span></span>
<span id="cb431-6"><a href="data-import-and-consolidation.html#cb431-6" tabindex="-1"></a>deaths <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(url, <span class="st">&quot;;&quot;</span>,</span>
<span id="cb431-7"><a href="data-import-and-consolidation.html#cb431-7" tabindex="-1"></a>                          <span class="at">local =</span> <span class="fu">locale</span>(<span class="at">encoding =</span> <span class="st">&quot;latin1&quot;</span>))</span></code></pre></div>
</details>
<ol start="89" style="list-style-type: decimal">
<li>Download the file “<a href="https://dparedesi.github.io/DS-con-R/resources-other-idd.xlsx" class="uri">https://dparedesi.github.io/DS-con-R/resources-other-idd.xlsx</a>” and load the “Deflators” tab to the <code>data</code> object.</li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="data-import-and-consolidation.html#cb432-1" tabindex="-1"></a><span class="co"># Store the url</span></span>
<span id="cb432-2"><a href="data-import-and-consolidation.html#cb432-2" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://dparedesi.github.io/DS-con-R/resources-other-idd.xlsx&quot;</span></span>
<span id="cb432-3"><a href="data-import-and-consolidation.html#cb432-3" tabindex="-1"></a></span>
<span id="cb432-4"><a href="data-import-and-consolidation.html#cb432-4" tabindex="-1"></a><span class="co"># Create a temporary name &amp; path for our file. See: ?tempfile</span></span>
<span id="cb432-5"><a href="data-import-and-consolidation.html#cb432-5" tabindex="-1"></a>temp_file <span class="ot">&lt;-</span> <span class="fu">tempfile</span>()</span>
<span id="cb432-6"><a href="data-import-and-consolidation.html#cb432-6" tabindex="-1"></a></span>
<span id="cb432-7"><a href="data-import-and-consolidation.html#cb432-7" tabindex="-1"></a><span class="co"># Download the file to our temp</span></span>
<span id="cb432-8"><a href="data-import-and-consolidation.html#cb432-8" tabindex="-1"></a><span class="fu">download.file</span>(url, temp_file)</span>
<span id="cb432-9"><a href="data-import-and-consolidation.html#cb432-9" tabindex="-1"></a></span>
<span id="cb432-10"><a href="data-import-and-consolidation.html#cb432-10" tabindex="-1"></a><span class="co"># Import the excel</span></span>
<span id="cb432-11"><a href="data-import-and-consolidation.html#cb432-11" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(temp_file, <span class="at">sheet =</span> <span class="st">&quot;Deflators&quot;</span>)</span>
<span id="cb432-12"><a href="data-import-and-consolidation.html#cb432-12" tabindex="-1"></a></span>
<span id="cb432-13"><a href="data-import-and-consolidation.html#cb432-13" tabindex="-1"></a><span class="co"># Remove the temporary file</span></span>
<span id="cb432-14"><a href="data-import-and-consolidation.html#cb432-14" tabindex="-1"></a><span class="fu">file.remove</span>(temp_file)</span></code></pre></div>
</details>
<p>For the following files run the following code so that you have access to the objects referred to in the problems:</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="data-import-and-consolidation.html#cb433-1" tabindex="-1"></a><span class="co"># GDP by countries</span></span>
<span id="cb433-2"><a href="data-import-and-consolidation.html#cb433-2" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://dparedesi.github.io/DS-con-R/pbi.csv&quot;</span></span>
<span id="cb433-3"><a href="data-import-and-consolidation.html#cb433-3" tabindex="-1"></a>pbi <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(url)</span>
<span id="cb433-4"><a href="data-import-and-consolidation.html#cb433-4" tabindex="-1"></a></span>
<span id="cb433-5"><a href="data-import-and-consolidation.html#cb433-5" tabindex="-1"></a><span class="co"># Diseases by years by countries</span></span>
<span id="cb433-6"><a href="data-import-and-consolidation.html#cb433-6" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://dparedesi.github.io/DS-con-R/enfermedades-evolutivo.csv&quot;</span></span>
<span id="cb433-7"><a href="data-import-and-consolidation.html#cb433-7" tabindex="-1"></a>enfermedades_wide <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(url)</span>
<span id="cb433-8"><a href="data-import-and-consolidation.html#cb433-8" tabindex="-1"></a></span>
<span id="cb433-9"><a href="data-import-and-consolidation.html#cb433-9" tabindex="-1"></a><span class="co"># Number of female mayors</span></span>
<span id="cb433-10"><a href="data-import-and-consolidation.html#cb433-10" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://dparedesi.github.io/DS-con-R/alcaldes-mujeres.csv&quot;</span></span>
<span id="cb433-11"><a href="data-import-and-consolidation.html#cb433-11" tabindex="-1"></a>alcaldes_mujeres <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(url)</span>
<span id="cb433-12"><a href="data-import-and-consolidation.html#cb433-12" tabindex="-1"></a></span>
<span id="cb433-13"><a href="data-import-and-consolidation.html#cb433-13" tabindex="-1"></a><span class="co"># Evolution of a university</span></span>
<span id="cb433-14"><a href="data-import-and-consolidation.html#cb433-14" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://dparedesi.github.io/DS-con-R/universidad.csv&quot;</span></span>
<span id="cb433-15"><a href="data-import-and-consolidation.html#cb433-15" tabindex="-1"></a>universidad <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(url)</span></code></pre></div>
<ol start="90" style="list-style-type: decimal">
<li>Explore the <code>pbi</code> (GDP) object and convert it to <em>tidy data</em>. Then show a line graph differentiating the evolution of each country’s GDP.</li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="data-import-and-consolidation.html#cb434-1" tabindex="-1"></a><span class="co"># To tidy data</span></span>
<span id="cb434-2"><a href="data-import-and-consolidation.html#cb434-2" tabindex="-1"></a>pbi <span class="ot">&lt;-</span> pbi <span class="sc">|&gt;</span> </span>
<span id="cb434-3"><a href="data-import-and-consolidation.html#cb434-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>pais, <span class="at">names_to =</span> <span class="st">&quot;año&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;pbi&quot;</span>,</span>
<span id="cb434-4"><a href="data-import-and-consolidation.html#cb434-4" tabindex="-1"></a>               <span class="at">names_transform =</span> <span class="fu">list</span>(año <span class="ot">=</span> as.integer))</span>
<span id="cb434-5"><a href="data-import-and-consolidation.html#cb434-5" tabindex="-1"></a></span>
<span id="cb434-6"><a href="data-import-and-consolidation.html#cb434-6" tabindex="-1"></a>pbi</span>
<span id="cb434-7"><a href="data-import-and-consolidation.html#cb434-7" tabindex="-1"></a></span>
<span id="cb434-8"><a href="data-import-and-consolidation.html#cb434-8" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb434-9"><a href="data-import-and-consolidation.html#cb434-9" tabindex="-1"></a>pbi <span class="sc">|&gt;</span> </span>
<span id="cb434-10"><a href="data-import-and-consolidation.html#cb434-10" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb434-11"><a href="data-import-and-consolidation.html#cb434-11" tabindex="-1"></a>  <span class="fu">aes</span>(año, pbi, <span class="at">color=</span>pais) <span class="sc">+</span></span>
<span id="cb434-12"><a href="data-import-and-consolidation.html#cb434-12" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
</details>
<ol start="91" style="list-style-type: decimal">
<li>Explore the <code>enfermedades_wide</code> object and convert it to <em>tidy data</em>.</li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="data-import-and-consolidation.html#cb435-1" tabindex="-1"></a><span class="co"># Solution</span></span>
<span id="cb435-2"><a href="data-import-and-consolidation.html#cb435-2" tabindex="-1"></a>enfermedades_1 <span class="ot">&lt;-</span> enfermedades_wide <span class="sc">|&gt;</span> </span>
<span id="cb435-3"><a href="data-import-and-consolidation.html#cb435-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="sc">-</span>pais, <span class="sc">-</span>año, <span class="sc">-</span>poblacion), <span class="at">names_to =</span> <span class="st">&quot;enfermedad&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;cantidad&quot;</span>)</span>
<span id="cb435-4"><a href="data-import-and-consolidation.html#cb435-4" tabindex="-1"></a></span>
<span id="cb435-5"><a href="data-import-and-consolidation.html#cb435-5" tabindex="-1"></a>enfermedades_1</span>
<span id="cb435-6"><a href="data-import-and-consolidation.html#cb435-6" tabindex="-1"></a></span>
<span id="cb435-7"><a href="data-import-and-consolidation.html#cb435-7" tabindex="-1"></a><span class="co"># Alternative solution. Instead of indicating what to omit, we indicate what to take into account</span></span>
<span id="cb435-8"><a href="data-import-and-consolidation.html#cb435-8" tabindex="-1"></a>enfermedades_2 <span class="ot">&lt;-</span> enfermedades_wide <span class="sc">|&gt;</span> </span>
<span id="cb435-9"><a href="data-import-and-consolidation.html#cb435-9" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> HepatitisA<span class="sc">:</span>Rubeola, <span class="at">names_to =</span> <span class="st">&quot;enfermedad&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;cantidad&quot;</span>)</span>
<span id="cb435-10"><a href="data-import-and-consolidation.html#cb435-10" tabindex="-1"></a></span>
<span id="cb435-11"><a href="data-import-and-consolidation.html#cb435-11" tabindex="-1"></a>enfermedades_2</span></code></pre></div>
</details>
<ol start="92" style="list-style-type: decimal">
<li>Explore the <code>alcaldes_mujeres</code> object and then convert it to <em>tidy data</em></li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="data-import-and-consolidation.html#cb436-1" tabindex="-1"></a>alcaldes_mujeres <span class="ot">&lt;-</span> alcaldes_mujeres <span class="sc">|&gt;</span> </span>
<span id="cb436-2"><a href="data-import-and-consolidation.html#cb436-2" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable, <span class="at">values_from =</span> total)</span></code></pre></div>
</details>
<ol start="93" style="list-style-type: decimal">
<li>Explore the <code>universidad</code> object and then convert it to <em>tidy data</em></li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="data-import-and-consolidation.html#cb437-1" tabindex="-1"></a>universidad <span class="ot">&lt;-</span> universidad <span class="sc">|&gt;</span> </span>
<span id="cb437-2"><a href="data-import-and-consolidation.html#cb437-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>semestre, <span class="at">names_to =</span> <span class="st">&quot;variable&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;valor&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb437-3"><a href="data-import-and-consolidation.html#cb437-3" tabindex="-1"></a>  <span class="fu">separate</span>(variable, <span class="fu">c</span>(<span class="st">&quot;nombre&quot;</span>, <span class="st">&quot;variable2&quot;</span>), <span class="at">sep=</span><span class="st">&quot;_&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb437-4"><a href="data-import-and-consolidation.html#cb437-4" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable2, <span class="at">values_from =</span> valor)</span>
<span id="cb437-5"><a href="data-import-and-consolidation.html#cb437-5" tabindex="-1"></a></span>
<span id="cb437-6"><a href="data-import-and-consolidation.html#cb437-6" tabindex="-1"></a>universidad</span></code></pre></div>
</details>
</div>
<div id="joining-tables" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> Joining tables<a href="data-import-and-consolidation.html#joining-tables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Regularly we will have data from different sources that we then have to combine to be able to perform our analyses. For this we will learn different groups of functions that will allow us to combine multiple objects.</p>
<div id="join-functions" class="section level3 hasAnchor" number="10.4.1">
<h3><span class="header-section-number">10.4.1</span> Join functions<a href="data-import-and-consolidation.html#join-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Join functions are the most used in table crossing. To use them we have to make sure we have the <code>dplyr</code> library installed.</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="data-import-and-consolidation.html#cb438-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<p>This library includes a variety of functions to combine tables.</p>
<table>
<caption><span id="tab:date-format">TABLE 10.1: </span> List of join functions</caption>
<colgroup>
<col width="16%" />
<col width="83%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Usage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>left_join()</code></td>
<td align="left">Only keeps rows that have information in the first table.</td>
</tr>
<tr class="even">
<td align="left"><code>right_join()</code></td>
<td align="left">Only keeps rows that have information in the second table.</td>
</tr>
<tr class="odd">
<td align="left"><code>inner_join()</code></td>
<td align="left">Only keeps rows that have information in both tables.</td>
</tr>
<tr class="even">
<td align="left"><code>full_join()</code></td>
<td align="left">Keeps all rows from both tables.</td>
</tr>
<tr class="odd">
<td align="left"><code>semi_join()</code></td>
<td align="left">Keeps the part of the first table for which we have information in the second.</td>
</tr>
<tr class="even">
<td align="left"><code>anti_join()</code></td>
<td align="left">Keeps the elements of the first table for which there is no information in the second.</td>
</tr>
</tbody>
</table>
<p>To see the join functions with examples we will use the following files:</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="data-import-and-consolidation.html#cb439-1" tabindex="-1"></a>url_1 <span class="ot">&lt;-</span> <span class="st">&quot;https://dparedesi.github.io/DS-con-R/j_tarjeta.csv&quot;</span></span>
<span id="cb439-2"><a href="data-import-and-consolidation.html#cb439-2" tabindex="-1"></a>url_2 <span class="ot">&lt;-</span> <span class="st">&quot;https://dparedesi.github.io/DS-con-R/j_cliente.csv&quot;</span></span>
<span id="cb439-3"><a href="data-import-and-consolidation.html#cb439-3" tabindex="-1"></a></span>
<span id="cb439-4"><a href="data-import-and-consolidation.html#cb439-4" tabindex="-1"></a>data_1_tarjetas <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(url_1, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">dni =</span> <span class="fu">col_character</span>()))</span>
<span id="cb439-5"><a href="data-import-and-consolidation.html#cb439-5" tabindex="-1"></a>data_2_clientes <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(url_2, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">dni =</span> <span class="fu">col_character</span>()))</span>
<span id="cb439-6"><a href="data-import-and-consolidation.html#cb439-6" tabindex="-1"></a></span>
<span id="cb439-7"><a href="data-import-and-consolidation.html#cb439-7" tabindex="-1"></a>data_1_tarjetas</span>
<span id="cb439-8"><a href="data-import-and-consolidation.html#cb439-8" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 3</span></span>
<span id="cb439-9"><a href="data-import-and-consolidation.html#cb439-9" tabindex="-1"></a><span class="co">#&gt;   dni      tipo_cliente tarjeta         </span></span>
<span id="cb439-10"><a href="data-import-and-consolidation.html#cb439-10" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;        &lt;chr&gt;           </span></span>
<span id="cb439-11"><a href="data-import-and-consolidation.html#cb439-11" tabindex="-1"></a><span class="co">#&gt; 1 45860518 premium      VISA oro        </span></span>
<span id="cb439-12"><a href="data-import-and-consolidation.html#cb439-12" tabindex="-1"></a><span class="co">#&gt; 2 46534312 bronce       Mastercard Black</span></span>
<span id="cb439-13"><a href="data-import-and-consolidation.html#cb439-13" tabindex="-1"></a><span class="co">#&gt; 3 47564535 plata        VISA plantinum  </span></span>
<span id="cb439-14"><a href="data-import-and-consolidation.html#cb439-14" tabindex="-1"></a><span class="co">#&gt; 4 48987654 bronce       American Express</span></span>
<span id="cb439-15"><a href="data-import-and-consolidation.html#cb439-15" tabindex="-1"></a><span class="co">#&gt; 5 78765434 oro          VISA Signature  </span></span>
<span id="cb439-16"><a href="data-import-and-consolidation.html#cb439-16" tabindex="-1"></a><span class="co">#&gt; 6 41346556 premium      Diners Club</span></span>
<span id="cb439-17"><a href="data-import-and-consolidation.html#cb439-17" tabindex="-1"></a></span>
<span id="cb439-18"><a href="data-import-and-consolidation.html#cb439-18" tabindex="-1"></a>data_2_clientes</span>
<span id="cb439-19"><a href="data-import-and-consolidation.html#cb439-19" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 4</span></span>
<span id="cb439-20"><a href="data-import-and-consolidation.html#cb439-20" tabindex="-1"></a><span class="co">#&gt;   dni      nombres   apellido_paterno apellido_materno</span></span>
<span id="cb439-21"><a href="data-import-and-consolidation.html#cb439-21" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;            &lt;chr&gt;           </span></span>
<span id="cb439-22"><a href="data-import-and-consolidation.html#cb439-22" tabindex="-1"></a><span class="co">#&gt; 1 49321442 Iver      Castro           Rivera          </span></span>
<span id="cb439-23"><a href="data-import-and-consolidation.html#cb439-23" tabindex="-1"></a><span class="co">#&gt; 2 47564535 Enrique   Gutierrez        Rivasplata      </span></span>
<span id="cb439-24"><a href="data-import-and-consolidation.html#cb439-24" tabindex="-1"></a><span class="co">#&gt; 3 48987654 Alexandra Cupe             Gaspar          </span></span>
<span id="cb439-25"><a href="data-import-and-consolidation.html#cb439-25" tabindex="-1"></a><span class="co">#&gt; 4 47542345 Christiam Olortegui        Roca            </span></span>
<span id="cb439-26"><a href="data-import-and-consolidation.html#cb439-26" tabindex="-1"></a><span class="co">#&gt; 5 41346556 Karen     Jara             Mory            </span></span>
<span id="cb439-27"><a href="data-import-and-consolidation.html#cb439-27" tabindex="-1"></a><span class="co">#&gt; 6 45860518 Hebert    Lopez            Chavez          </span></span>
<span id="cb439-28"><a href="data-import-and-consolidation.html#cb439-28" tabindex="-1"></a><span class="co">#&gt; 7 71234321 Jesus     Valle            Mariños         </span></span>
<span id="cb439-29"><a href="data-import-and-consolidation.html#cb439-29" tabindex="-1"></a><span class="co">#&gt; 8 73231243 Jenny     Sosa             Sosa</span></span></code></pre></div>
<div id="left-join" class="section level4 hasAnchor" number="10.4.1.1">
<h4><span class="header-section-number">10.4.1.1</span> Left join<a href="data-import-and-consolidation.html#left-join" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Given two tables with the same identifier (in our case our identifier consists only of a single column: DNI), the left join function maintains the information of the first table and completes it with the data that crosses in the second table</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="data-import-and-consolidation.html#cb440-1" tabindex="-1"></a><span class="fu">left_join</span>(data_1_tarjetas, data_2_clientes, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;dni&quot;</span>))</span>
<span id="cb440-2"><a href="data-import-and-consolidation.html#cb440-2" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 6</span></span>
<span id="cb440-3"><a href="data-import-and-consolidation.html#cb440-3" tabindex="-1"></a><span class="co">#&gt;   dni      tipo_cliente tarjeta        nombres apellido_paterno apellido_materno</span></span>
<span id="cb440-4"><a href="data-import-and-consolidation.html#cb440-4" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;        &lt;chr&gt;          &lt;chr&gt;   &lt;chr&gt;            &lt;chr&gt;           </span></span>
<span id="cb440-5"><a href="data-import-and-consolidation.html#cb440-5" tabindex="-1"></a><span class="co">#&gt; 1 45860518 premium      VISA oro       Hebert  Lopez            Chavez          </span></span>
<span id="cb440-6"><a href="data-import-and-consolidation.html#cb440-6" tabindex="-1"></a><span class="co">#&gt; 2 46534312 bronce       Mastercard Bl… &lt;NA&gt;    &lt;NA&gt;             &lt;NA&gt;            </span></span>
<span id="cb440-7"><a href="data-import-and-consolidation.html#cb440-7" tabindex="-1"></a><span class="co">#&gt; 3 47564535 plata        VISA plantinum Enrique Gutierrez        Rivasplata      </span></span>
<span id="cb440-8"><a href="data-import-and-consolidation.html#cb440-8" tabindex="-1"></a><span class="co">#&gt; 4 48987654 bronce       American Expr… Alexan… Cupe             Gaspar          </span></span>
<span id="cb440-9"><a href="data-import-and-consolidation.html#cb440-9" tabindex="-1"></a><span class="co">#&gt; 5 78765434 oro          VISA Signature &lt;NA&gt;    &lt;NA&gt;             &lt;NA&gt;            </span></span>
<span id="cb440-10"><a href="data-import-and-consolidation.html#cb440-10" tabindex="-1"></a><span class="co">#&gt; 6 41346556 premium      Diners Club    Karen   Jara             Mory</span></span></code></pre></div>
<p>As we can see, the first three columns are exactly the same as we initially had and to the right of those columns we see the columns of the other table for the values ​​that did cross the data. In this case we are facing a data inconsistency since all customers of <code>data_1_tarjetas</code> should be in <code>data_2_clientes</code>. This inconsistency could lead us to have to map the data loss process, etc.</p>
</div>
<div id="right-join" class="section level4 hasAnchor" number="10.4.1.2">
<h4><span class="header-section-number">10.4.1.2</span> Right join<a href="data-import-and-consolidation.html#right-join" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Given two tables with the same identifier, the right join function maintains the information of the second table and completes it with the data that crosses in the first table</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="data-import-and-consolidation.html#cb441-1" tabindex="-1"></a><span class="fu">right_join</span>(data_1_tarjetas, data_2_clientes, <span class="at">by =</span> <span class="st">&quot;dni&quot;</span>)</span>
<span id="cb441-2"><a href="data-import-and-consolidation.html#cb441-2" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 6</span></span>
<span id="cb441-3"><a href="data-import-and-consolidation.html#cb441-3" tabindex="-1"></a><span class="co">#&gt;   dni      tipo_cliente tarjeta        nombres apellido_paterno apellido_materno</span></span>
<span id="cb441-4"><a href="data-import-and-consolidation.html#cb441-4" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;        &lt;chr&gt;          &lt;chr&gt;   &lt;chr&gt;            &lt;chr&gt;           </span></span>
<span id="cb441-5"><a href="data-import-and-consolidation.html#cb441-5" tabindex="-1"></a><span class="co">#&gt; 1 45860518 premium      VISA oro       Hebert  Lopez            Chavez          </span></span>
<span id="cb441-6"><a href="data-import-and-consolidation.html#cb441-6" tabindex="-1"></a><span class="co">#&gt; 2 47564535 plata        VISA plantinum Enrique Gutierrez        Rivasplata      </span></span>
<span id="cb441-7"><a href="data-import-and-consolidation.html#cb441-7" tabindex="-1"></a><span class="co">#&gt; 3 48987654 bronce       American Expr… Alexan… Cupe             Gaspar          </span></span>
<span id="cb441-8"><a href="data-import-and-consolidation.html#cb441-8" tabindex="-1"></a><span class="co">#&gt; 4 41346556 premium      Diners Club    Karen   Jara             Mory            </span></span>
<span id="cb441-9"><a href="data-import-and-consolidation.html#cb441-9" tabindex="-1"></a><span class="co">#&gt; 5 49321442 &lt;NA&gt;         &lt;NA&gt;           Iver    Castro           Rivera          </span></span>
<span id="cb441-10"><a href="data-import-and-consolidation.html#cb441-10" tabindex="-1"></a><span class="co">#&gt; 6 47542345 &lt;NA&gt;         &lt;NA&gt;           Christ… Olortegui        Roca            </span></span>
<span id="cb441-11"><a href="data-import-and-consolidation.html#cb441-11" tabindex="-1"></a><span class="co">#&gt; 7 71234321 &lt;NA&gt;         &lt;NA&gt;           Jesus   Valle            Mariños         </span></span>
<span id="cb441-12"><a href="data-import-and-consolidation.html#cb441-12" tabindex="-1"></a><span class="co">#&gt; 8 73231243 &lt;NA&gt;         &lt;NA&gt;           Jenny   Sosa             Sosa</span></span></code></pre></div>
<p>The idea is the same as in <code>left_join</code>, only this time the <code>NA</code> are in the first two columns.</p>
</div>
<div id="inner-join" class="section level4 hasAnchor" number="10.4.1.3">
<h4><span class="header-section-number">10.4.1.3</span> Inner join<a href="data-import-and-consolidation.html#inner-join" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this case we will only have the intersection of the tables. Only the result of the data that are in both tables will be shown.</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="data-import-and-consolidation.html#cb442-1" tabindex="-1"></a><span class="fu">inner_join</span>(data_1_tarjetas, data_2_clientes, <span class="at">by =</span> <span class="st">&quot;dni&quot;</span>)</span>
<span id="cb442-2"><a href="data-import-and-consolidation.html#cb442-2" tabindex="-1"></a><span class="co">#&gt; # A tibble: 4 × 6</span></span>
<span id="cb442-3"><a href="data-import-and-consolidation.html#cb442-3" tabindex="-1"></a><span class="co">#&gt;   dni      tipo_cliente tarjeta        nombres apellido_paterno apellido_materno</span></span>
<span id="cb442-4"><a href="data-import-and-consolidation.html#cb442-4" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;        &lt;chr&gt;          &lt;chr&gt;   &lt;chr&gt;            &lt;chr&gt;           </span></span>
<span id="cb442-5"><a href="data-import-and-consolidation.html#cb442-5" tabindex="-1"></a><span class="co">#&gt; 1 45860518 premium      VISA oro       Hebert  Lopez            Chavez          </span></span>
<span id="cb442-6"><a href="data-import-and-consolidation.html#cb442-6" tabindex="-1"></a><span class="co">#&gt; 2 47564535 plata        VISA plantinum Enrique Gutierrez        Rivasplata      </span></span>
<span id="cb442-7"><a href="data-import-and-consolidation.html#cb442-7" tabindex="-1"></a><span class="co">#&gt; 3 48987654 bronce       American Expr… Alexan… Cupe             Gaspar          </span></span>
<span id="cb442-8"><a href="data-import-and-consolidation.html#cb442-8" tabindex="-1"></a><span class="co">#&gt; 4 41346556 premium      Diners Club    Karen   Jara             Mory</span></span></code></pre></div>
</div>
<div id="full-join" class="section level4 hasAnchor" number="10.4.1.4">
<h4><span class="header-section-number">10.4.1.4</span> Full join<a href="data-import-and-consolidation.html#full-join" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Full join is a total crossing of both. It shows us all the data that are in both the first and the second table.</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="data-import-and-consolidation.html#cb443-1" tabindex="-1"></a><span class="fu">full_join</span>(data_1_tarjetas, data_2_clientes, <span class="at">by =</span> <span class="st">&quot;dni&quot;</span>)</span>
<span id="cb443-2"><a href="data-import-and-consolidation.html#cb443-2" tabindex="-1"></a><span class="co">#&gt; # A tibble: 10 × 6</span></span>
<span id="cb443-3"><a href="data-import-and-consolidation.html#cb443-3" tabindex="-1"></a><span class="co">#&gt;    dni      tipo_cliente tarjeta       nombres apellido_paterno apellido_materno</span></span>
<span id="cb443-4"><a href="data-import-and-consolidation.html#cb443-4" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;    &lt;chr&gt;        &lt;chr&gt;         &lt;chr&gt;   &lt;chr&gt;            &lt;chr&gt;           </span></span>
<span id="cb443-5"><a href="data-import-and-consolidation.html#cb443-5" tabindex="-1"></a><span class="co">#&gt;  1 45860518 premium      VISA oro      Hebert  Lopez            Chavez          </span></span>
<span id="cb443-6"><a href="data-import-and-consolidation.html#cb443-6" tabindex="-1"></a><span class="co">#&gt;  2 46534312 bronce       Mastercard B… &lt;NA&gt;    &lt;NA&gt;             &lt;NA&gt;            </span></span>
<span id="cb443-7"><a href="data-import-and-consolidation.html#cb443-7" tabindex="-1"></a><span class="co">#&gt;  3 47564535 plata        VISA plantin… Enrique Gutierrez        Rivasplata      </span></span>
<span id="cb443-8"><a href="data-import-and-consolidation.html#cb443-8" tabindex="-1"></a><span class="co">#&gt;  4 48987654 bronce       American Exp… Alexan… Cupe             Gaspar          </span></span>
<span id="cb443-9"><a href="data-import-and-consolidation.html#cb443-9" tabindex="-1"></a><span class="co">#&gt;  5 78765434 oro          VISA Signatu… &lt;NA&gt;    &lt;NA&gt;             &lt;NA&gt;            </span></span>
<span id="cb443-10"><a href="data-import-and-consolidation.html#cb443-10" tabindex="-1"></a><span class="co">#&gt;  6 41346556 premium      Diners Club   Karen   Jara             Mory            </span></span>
<span id="cb443-11"><a href="data-import-and-consolidation.html#cb443-11" tabindex="-1"></a><span class="co">#&gt;  7 49321442 &lt;NA&gt;         &lt;NA&gt;          Iver    Castro           Rivera          </span></span>
<span id="cb443-12"><a href="data-import-and-consolidation.html#cb443-12" tabindex="-1"></a><span class="co">#&gt;  8 47542345 &lt;NA&gt;         &lt;NA&gt;          Christ… Olortegui        Roca            </span></span>
<span id="cb443-13"><a href="data-import-and-consolidation.html#cb443-13" tabindex="-1"></a><span class="co">#&gt;  9 71234321 &lt;NA&gt;         &lt;NA&gt;          Jesus   Valle            Mariños         </span></span>
<span id="cb443-14"><a href="data-import-and-consolidation.html#cb443-14" tabindex="-1"></a><span class="co">#&gt; 10 73231243 &lt;NA&gt;         &lt;NA&gt;          Jenny   Sosa             Sosa</span></span></code></pre></div>
</div>
<div id="semi-join" class="section level4 hasAnchor" number="10.4.1.5">
<h4><span class="header-section-number">10.4.1.5</span> Semi join<a href="data-import-and-consolidation.html#semi-join" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The case of the semi join is very similar to <code>left_join</code> with the difference that it only shows us the columns of the first table and eliminates the data that did not manage to cross (what in <code>left_join</code> comes out as NA). Also, none of the columns of table 2 appear. This is like doing a filter requesting the following: show me only the data from table 1 that is also in table 2.</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="data-import-and-consolidation.html#cb444-1" tabindex="-1"></a><span class="fu">semi_join</span>(data_1_tarjetas, data_2_clientes, <span class="at">by =</span> <span class="st">&quot;dni&quot;</span>)</span>
<span id="cb444-2"><a href="data-import-and-consolidation.html#cb444-2" tabindex="-1"></a><span class="co">#&gt; # A tibble: 4 × 3</span></span>
<span id="cb444-3"><a href="data-import-and-consolidation.html#cb444-3" tabindex="-1"></a><span class="co">#&gt;   dni      tipo_cliente tarjeta         </span></span>
<span id="cb444-4"><a href="data-import-and-consolidation.html#cb444-4" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;        &lt;chr&gt;           </span></span>
<span id="cb444-5"><a href="data-import-and-consolidation.html#cb444-5" tabindex="-1"></a><span class="co">#&gt; 1 45860518 premium      VISA oro        </span></span>
<span id="cb444-6"><a href="data-import-and-consolidation.html#cb444-6" tabindex="-1"></a><span class="co">#&gt; 2 47564535 plata        VISA plantinum  </span></span>
<span id="cb444-7"><a href="data-import-and-consolidation.html#cb444-7" tabindex="-1"></a><span class="co">#&gt; 3 48987654 bronce       American Express</span></span>
<span id="cb444-8"><a href="data-import-and-consolidation.html#cb444-8" tabindex="-1"></a><span class="co">#&gt; 4 41346556 premium      Diners Club</span></span></code></pre></div>
</div>
<div id="anti-join" class="section level4 hasAnchor" number="10.4.1.6">
<h4><span class="header-section-number">10.4.1.6</span> Anti join<a href="data-import-and-consolidation.html#anti-join" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the case of <code>anti_join</code> we have the opposite of <code>semi_join</code> since it shows the data from table 1 that are <strong>not</strong> in table 2.</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="data-import-and-consolidation.html#cb445-1" tabindex="-1"></a><span class="fu">anti_join</span>(data_1_tarjetas, data_2_clientes, <span class="at">by =</span> <span class="st">&quot;dni&quot;</span>)</span>
<span id="cb445-2"><a href="data-import-and-consolidation.html#cb445-2" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 3</span></span>
<span id="cb445-3"><a href="data-import-and-consolidation.html#cb445-3" tabindex="-1"></a><span class="co">#&gt;   dni      tipo_cliente tarjeta         </span></span>
<span id="cb445-4"><a href="data-import-and-consolidation.html#cb445-4" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;        &lt;chr&gt;           </span></span>
<span id="cb445-5"><a href="data-import-and-consolidation.html#cb445-5" tabindex="-1"></a><span class="co">#&gt; 1 46534312 bronce       Mastercard Black</span></span>
<span id="cb445-6"><a href="data-import-and-consolidation.html#cb445-6" tabindex="-1"></a><span class="co">#&gt; 2 78765434 oro          VISA Signature</span></span></code></pre></div>
</div>
</div>
<div id="joining-without-a-common-identifier" class="section level3 hasAnchor" number="10.4.2">
<h3><span class="header-section-number">10.4.2</span> Joining without a common identifier<a href="data-import-and-consolidation.html#joining-without-a-common-identifier" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Likewise, we will have some moments when we need to combine only two objects, without using any type of intersection. For this we will use the <code>bind</code> functions. These functions allow us to put together two vectors or tables either in rows or columns.</p>
<div id="union-of-vectors" class="section level4 hasAnchor" number="10.4.2.1">
<h4><span class="header-section-number">10.4.2.1</span> Union of vectors<a href="data-import-and-consolidation.html#union-of-vectors" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If we have two or more vectors of the same size we can create the union of the columns to create a table using the <code>bind_cols()</code> function. Let’s see with an example:</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="data-import-and-consolidation.html#cb446-1" tabindex="-1"></a>vector_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;hola&quot;</span>, <span class="st">&quot;Has visto a&quot;</span>, <span class="st">&quot;el&quot;</span>)</span>
<span id="cb446-2"><a href="data-import-and-consolidation.html#cb446-2" tabindex="-1"></a>vector_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Julian&quot;</span>, <span class="st">&quot;Carla&quot;</span>, <span class="st">&quot;Miércoles&quot;</span>)</span>
<span id="cb446-3"><a href="data-import-and-consolidation.html#cb446-3" tabindex="-1"></a></span>
<span id="cb446-4"><a href="data-import-and-consolidation.html#cb446-4" tabindex="-1"></a>resultado <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(<span class="at">saludo =</span> vector_1, <span class="at">sustantivos =</span> vector_2)</span>
<span id="cb446-5"><a href="data-import-and-consolidation.html#cb446-5" tabindex="-1"></a></span>
<span id="cb446-6"><a href="data-import-and-consolidation.html#cb446-6" tabindex="-1"></a>resultado</span>
<span id="cb446-7"><a href="data-import-and-consolidation.html#cb446-7" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 2</span></span>
<span id="cb446-8"><a href="data-import-and-consolidation.html#cb446-8" tabindex="-1"></a><span class="co">#&gt;   saludo      sustantivos</span></span>
<span id="cb446-9"><a href="data-import-and-consolidation.html#cb446-9" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;       &lt;chr&gt;      </span></span>
<span id="cb446-10"><a href="data-import-and-consolidation.html#cb446-10" tabindex="-1"></a><span class="co">#&gt; 1 hola        Julian     </span></span>
<span id="cb446-11"><a href="data-import-and-consolidation.html#cb446-11" tabindex="-1"></a><span class="co">#&gt; 2 Has visto a Carla      </span></span>
<span id="cb446-12"><a href="data-import-and-consolidation.html#cb446-12" tabindex="-1"></a><span class="co">#&gt; 3 el          Miércoles</span></span></code></pre></div>
</div>
<div id="union-of-tables" class="section level4 hasAnchor" number="10.4.2.2">
<h4><span class="header-section-number">10.4.2.2</span> Union of tables<a href="data-import-and-consolidation.html#union-of-tables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the case of tables the use is the same. Likewise, we can also join the rows of two or more tables. To see its application let’s first create some example tables:</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="data-import-and-consolidation.html#cb447-1" tabindex="-1"></a>tabla_1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb447-2"><a href="data-import-and-consolidation.html#cb447-2" tabindex="-1"></a>  <span class="at">nombre =</span> <span class="fu">c</span>(<span class="st">&quot;Jhasury&quot;</span>, <span class="st">&quot;Thomas&quot;</span>, <span class="st">&quot;Andres&quot;</span>, <span class="st">&quot;Josep&quot;</span>),</span>
<span id="cb447-3"><a href="data-import-and-consolidation.html#cb447-3" tabindex="-1"></a>  <span class="at">apellido =</span> <span class="fu">c</span>(<span class="st">&quot;Campos&quot;</span>, <span class="st">&quot;Gonzales&quot;</span>, <span class="st">&quot;Santiago&quot;</span>, <span class="st">&quot;Villaverde&quot;</span>),</span>
<span id="cb447-4"><a href="data-import-and-consolidation.html#cb447-4" tabindex="-1"></a>  <span class="at">direccion =</span> <span class="fu">c</span>(<span class="st">&quot;Jr. los campos 471&quot;</span>, <span class="st">&quot;Av. Casuarinas 142&quot;</span>, <span class="cn">NA</span>, <span class="st">&quot;Av. Tupac Amaru 164&quot;</span>),</span>
<span id="cb447-5"><a href="data-import-and-consolidation.html#cb447-5" tabindex="-1"></a>  <span class="at">telefono =</span> <span class="fu">c</span>(<span class="st">&quot;976567325&quot;</span>, <span class="st">&quot;956732587&quot;</span>, <span class="st">&quot;961445664&quot;</span>, <span class="st">&quot;987786453&quot;</span>)</span>
<span id="cb447-6"><a href="data-import-and-consolidation.html#cb447-6" tabindex="-1"></a>)</span>
<span id="cb447-7"><a href="data-import-and-consolidation.html#cb447-7" tabindex="-1"></a></span>
<span id="cb447-8"><a href="data-import-and-consolidation.html#cb447-8" tabindex="-1"></a>tabla_2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb447-9"><a href="data-import-and-consolidation.html#cb447-9" tabindex="-1"></a>  <span class="at">edad =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>, <span class="dv">19</span>, <span class="dv">12</span>),</span>
<span id="cb447-10"><a href="data-import-and-consolidation.html#cb447-10" tabindex="-1"></a>  <span class="at">signo =</span> <span class="fu">c</span>(<span class="st">&quot;Aries&quot;</span>, <span class="st">&quot;Capricornio&quot;</span>, <span class="st">&quot;Sagitario&quot;</span>, <span class="st">&quot;Libra&quot;</span>)</span>
<span id="cb447-11"><a href="data-import-and-consolidation.html#cb447-11" tabindex="-1"></a>)</span>
<span id="cb447-12"><a href="data-import-and-consolidation.html#cb447-12" tabindex="-1"></a></span>
<span id="cb447-13"><a href="data-import-and-consolidation.html#cb447-13" tabindex="-1"></a><span class="co"># Create a table from row 2 to 3 of table 1</span></span>
<span id="cb447-14"><a href="data-import-and-consolidation.html#cb447-14" tabindex="-1"></a>tabla_3 <span class="ot">&lt;-</span> tabla_1[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, ]</span></code></pre></div>
<p>Once we have our tables let’s proceed to join them. We see that they do not have a common identifier.</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="data-import-and-consolidation.html#cb448-1" tabindex="-1"></a>resultado <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(tabla_1, tabla_2)</span>
<span id="cb448-2"><a href="data-import-and-consolidation.html#cb448-2" tabindex="-1"></a>resultado</span>
<span id="cb448-3"><a href="data-import-and-consolidation.html#cb448-3" tabindex="-1"></a><span class="co">#&gt;    nombre   apellido           direccion  telefono edad       signo</span></span>
<span id="cb448-4"><a href="data-import-and-consolidation.html#cb448-4" tabindex="-1"></a><span class="co">#&gt; 1 Jhasury     Campos  Jr. los campos 471 976567325   21       Aries</span></span>
<span id="cb448-5"><a href="data-import-and-consolidation.html#cb448-5" tabindex="-1"></a><span class="co">#&gt; 2  Thomas   Gonzales  Av. Casuarinas 142 956732587   24 Capricornio</span></span>
<span id="cb448-6"><a href="data-import-and-consolidation.html#cb448-6" tabindex="-1"></a><span class="co">#&gt; 3  Andres   Santiago                &lt;NA&gt; 961445664   19   Sagitario</span></span>
<span id="cb448-7"><a href="data-import-and-consolidation.html#cb448-7" tabindex="-1"></a><span class="co">#&gt; 4   Josep Villaverde Av. Tupac Amaru 164 987786453   12       Libra</span></span></code></pre></div>
<p>Likewise, we can join by rows like this:</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="data-import-and-consolidation.html#cb449-1" tabindex="-1"></a>resultado <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tabla_1, tabla_3)</span>
<span id="cb449-2"><a href="data-import-and-consolidation.html#cb449-2" tabindex="-1"></a>resultado</span>
<span id="cb449-3"><a href="data-import-and-consolidation.html#cb449-3" tabindex="-1"></a><span class="co">#&gt;    nombre   apellido           direccion  telefono</span></span>
<span id="cb449-4"><a href="data-import-and-consolidation.html#cb449-4" tabindex="-1"></a><span class="co">#&gt; 1 Jhasury     Campos  Jr. los campos 471 976567325</span></span>
<span id="cb449-5"><a href="data-import-and-consolidation.html#cb449-5" tabindex="-1"></a><span class="co">#&gt; 2  Thomas   Gonzales  Av. Casuarinas 142 956732587</span></span>
<span id="cb449-6"><a href="data-import-and-consolidation.html#cb449-6" tabindex="-1"></a><span class="co">#&gt; 3  Andres   Santiago                &lt;NA&gt; 961445664</span></span>
<span id="cb449-7"><a href="data-import-and-consolidation.html#cb449-7" tabindex="-1"></a><span class="co">#&gt; 4   Josep Villaverde Av. Tupac Amaru 164 987786453</span></span>
<span id="cb449-8"><a href="data-import-and-consolidation.html#cb449-8" tabindex="-1"></a><span class="co">#&gt; 5  Thomas   Gonzales  Av. Casuarinas 142 956732587</span></span>
<span id="cb449-9"><a href="data-import-and-consolidation.html#cb449-9" tabindex="-1"></a><span class="co">#&gt; 6  Andres   Santiago                &lt;NA&gt; 961445664</span></span></code></pre></div>
</div>
</div>
</div>
<div id="web-scraping" class="section level2 hasAnchor" number="10.5">
<h2><span class="header-section-number">10.5</span> Web Scraping<a href="data-import-and-consolidation.html#web-scraping" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Web Scraping is the process of extracting data from a website. We will use it when we need to extract data directly from tables that are presented on websites. For this we will use the <code>rvest</code> library, included in the <code>tidyverse</code> library.</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="data-import-and-consolidation.html#cb450-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb450-2"><a href="data-import-and-consolidation.html#cb450-2" tabindex="-1"></a><span class="fu">library</span>(rvest)</span></code></pre></div>
<p>The function we will use the most will be <code>read_html()</code> and as an argument we will place the url of the web from where we want to extract the data. We are not talking about a url that downloads a text file but a web page like this:</p>
<p><img src="_assets/images/05-wrangling/paises-hispanos.png" alt="Wikipedia table of Hispanic countries by population" width="80%" style="display: block; margin: auto;" /></p>
<p>Thus, we will use <code>read_html()</code> to store all the web html and then little by little access the table data in R.</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="data-import-and-consolidation.html#cb451-1" tabindex="-1"></a>data_en_html <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">&quot;https://es.wikipedia.org/wiki/Anexo:Pa%C3%ADses_hispanos_por_poblaci%C3%B3n&quot;</span>)</span>
<span id="cb451-2"><a href="data-import-and-consolidation.html#cb451-2" tabindex="-1"></a></span>
<span id="cb451-3"><a href="data-import-and-consolidation.html#cb451-3" tabindex="-1"></a>data_en_html</span>
<span id="cb451-4"><a href="data-import-and-consolidation.html#cb451-4" tabindex="-1"></a><span class="co">#&gt; {html_document}</span></span>
<span id="cb451-5"><a href="data-import-and-consolidation.html#cb451-5" tabindex="-1"></a><span class="co">#&gt; &lt;html class=&quot;client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-1 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-enabled skin-theme-clientpref-day vector-sticky-header-enabled vector-toc-available&quot; lang=&quot;es&quot; dir=&quot;ltr&quot;&gt;</span></span>
<span id="cb451-6"><a href="data-import-and-consolidation.html#cb451-6" tabindex="-1"></a><span class="co">#&gt; [1] &lt;head&gt;\n&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8 ...</span></span>
<span id="cb451-7"><a href="data-import-and-consolidation.html#cb451-7" tabindex="-1"></a><span class="co">#&gt; [2] &lt;body class=&quot;skin--responsive skin-vector skin-vector-search-vue mediawik ...</span></span></code></pre></div>
<p>Now that we have the data stored in the object we have to go looking for the data, doing scraping. For this we will use the <code>html_nodes("table")</code> function to access the “table” node.</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="data-import-and-consolidation.html#cb452-1" tabindex="-1"></a>tablas_web <span class="ot">&lt;-</span> data_en_html <span class="sc">|&gt;</span> </span>
<span id="cb452-2"><a href="data-import-and-consolidation.html#cb452-2" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&quot;table&quot;</span>)</span></code></pre></div>
<p>Finally, we have to go index by index looking for the table that interests us. To give it table format we will use <code>html_table</code>. In this case we will use double brackets because it is a list of lists and the <code>setNames()</code> function to change the name of the columns.</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="data-import-and-consolidation.html#cb453-1" tabindex="-1"></a><span class="co"># We format as table and store in wide_tabla</span></span>
<span id="cb453-2"><a href="data-import-and-consolidation.html#cb453-2" tabindex="-1"></a>tabla_en_bruto <span class="ot">&lt;-</span> tablas_web[[<span class="dv">1</span>]] <span class="sc">|&gt;</span> </span>
<span id="cb453-3"><a href="data-import-and-consolidation.html#cb453-3" tabindex="-1"></a>  <span class="fu">html_table</span>()</span>
<span id="cb453-4"><a href="data-import-and-consolidation.html#cb453-4" tabindex="-1"></a></span>
<span id="cb453-5"><a href="data-import-and-consolidation.html#cb453-5" tabindex="-1"></a><span class="co"># Change header names</span></span>
<span id="cb453-6"><a href="data-import-and-consolidation.html#cb453-6" tabindex="-1"></a>tabla_en_bruto <span class="ot">&lt;-</span> tabla_en_bruto <span class="sc">|&gt;</span> </span>
<span id="cb453-7"><a href="data-import-and-consolidation.html#cb453-7" tabindex="-1"></a>  <span class="fu">setNames</span>(</span>
<span id="cb453-8"><a href="data-import-and-consolidation.html#cb453-8" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;N&quot;</span>, <span class="st">&quot;pais&quot;</span>, <span class="st">&quot;poblacion&quot;</span>, <span class="st">&quot;prop_poblacion&quot;</span>, <span class="st">&quot;cambio_medio&quot;</span>, <span class="st">&quot;link&quot;</span>)</span>
<span id="cb453-9"><a href="data-import-and-consolidation.html#cb453-9" tabindex="-1"></a>  )</span>
<span id="cb453-10"><a href="data-import-and-consolidation.html#cb453-10" tabindex="-1"></a></span>
<span id="cb453-11"><a href="data-import-and-consolidation.html#cb453-11" tabindex="-1"></a><span class="co"># Convert to tibble</span></span>
<span id="cb453-12"><a href="data-import-and-consolidation.html#cb453-12" tabindex="-1"></a>tabla_en_bruto <span class="ot">&lt;-</span> tabla_en_bruto <span class="sc">|&gt;</span> </span>
<span id="cb453-13"><a href="data-import-and-consolidation.html#cb453-13" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb453-14"><a href="data-import-and-consolidation.html#cb453-14" tabindex="-1"></a></span>
<span id="cb453-15"><a href="data-import-and-consolidation.html#cb453-15" tabindex="-1"></a><span class="co"># Report first rows</span></span>
<span id="cb453-16"><a href="data-import-and-consolidation.html#cb453-16" tabindex="-1"></a>tabla_en_bruto <span class="sc">|&gt;</span> </span>
<span id="cb453-17"><a href="data-import-and-consolidation.html#cb453-17" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span>
<span id="cb453-18"><a href="data-import-and-consolidation.html#cb453-18" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span id="cb453-19"><a href="data-import-and-consolidation.html#cb453-19" tabindex="-1"></a><span class="co">#&gt;   N     pais                                                                    </span></span>
<span id="cb453-20"><a href="data-import-and-consolidation.html#cb453-20" tabindex="-1"></a><span class="co">#&gt;   &lt;lgl&gt; &lt;chr&gt;                                                                   </span></span>
<span id="cb453-21"><a href="data-import-and-consolidation.html#cb453-21" tabindex="-1"></a><span class="co">#&gt; 1 NA    Este artículo o sección se encuentra desactualizado.La información sumi…</span></span></code></pre></div>
<p>We already have our data imported and we could already start exploring its content in detail.</p>
</div>
<div id="exercises-15" class="section level2 hasAnchor" number="10.6">
<h2><span class="header-section-number">10.6</span> Exercises<a href="data-import-and-consolidation.html#exercises-15" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For the following exercises we will use objects from the <strong>Lahman</strong> library, which contains US baseball player data. Run the following Script before starting to solve the exercises.</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="data-import-and-consolidation.html#cb454-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;Lahman&quot;</span>)</span>
<span id="cb454-2"><a href="data-import-and-consolidation.html#cb454-2" tabindex="-1"></a><span class="fu">library</span>(Lahman)</span>
<span id="cb454-3"><a href="data-import-and-consolidation.html#cb454-3" tabindex="-1"></a></span>
<span id="cb454-4"><a href="data-import-and-consolidation.html#cb454-4" tabindex="-1"></a><span class="co"># Top 10 players of the year 2016</span></span>
<span id="cb454-5"><a href="data-import-and-consolidation.html#cb454-5" tabindex="-1"></a>top_jugadores <span class="ot">&lt;-</span> Batting <span class="sc">|&gt;</span> </span>
<span id="cb454-6"><a href="data-import-and-consolidation.html#cb454-6" tabindex="-1"></a>  <span class="fu">filter</span>(yearID <span class="sc">==</span> <span class="dv">2016</span>) <span class="sc">|&gt;</span></span>
<span id="cb454-7"><a href="data-import-and-consolidation.html#cb454-7" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(HR)) <span class="sc">|&gt;</span>    <span class="co"># sorted by number of &quot;Home run&quot;</span></span>
<span id="cb454-8"><a href="data-import-and-consolidation.html#cb454-8" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)    <span class="co"># Take from row 1 to 10</span></span>
<span id="cb454-9"><a href="data-import-and-consolidation.html#cb454-9" tabindex="-1"></a></span>
<span id="cb454-10"><a href="data-import-and-consolidation.html#cb454-10" tabindex="-1"></a>top_jugadores <span class="ot">&lt;-</span> top_jugadores <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb454-11"><a href="data-import-and-consolidation.html#cb454-11" tabindex="-1"></a></span>
<span id="cb454-12"><a href="data-import-and-consolidation.html#cb454-12" tabindex="-1"></a><span class="co"># List of all baseball players from recent years</span></span>
<span id="cb454-13"><a href="data-import-and-consolidation.html#cb454-13" tabindex="-1"></a>maestra <span class="ot">&lt;-</span> Master <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb454-14"><a href="data-import-and-consolidation.html#cb454-14" tabindex="-1"></a></span>
<span id="cb454-15"><a href="data-import-and-consolidation.html#cb454-15" tabindex="-1"></a><span class="co"># Awards won by players</span></span>
<span id="cb454-16"><a href="data-import-and-consolidation.html#cb454-16" tabindex="-1"></a>premios <span class="ot">&lt;-</span> AwardsPlayers <span class="sc">|&gt;</span></span>
<span id="cb454-17"><a href="data-import-and-consolidation.html#cb454-17" tabindex="-1"></a>  <span class="fu">filter</span>(yearID <span class="sc">==</span> <span class="dv">2016</span>) <span class="sc">|&gt;</span> </span>
<span id="cb454-18"><a href="data-import-and-consolidation.html#cb454-18" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span></code></pre></div>
<ol start="94" style="list-style-type: decimal">
<li>Using the <code>top_jugadores</code> object and the <code>Maestra</code> object, report the following fields <code>playerID</code>, <code>nameFirst</code>, <code>nameLast</code>, <code>HR</code> of the top 10 players of 2016.</li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="data-import-and-consolidation.html#cb455-1" tabindex="-1"></a>top_10 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(top_jugadores, maestra, <span class="at">by =</span> <span class="st">&quot;playerID&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb455-2"><a href="data-import-and-consolidation.html#cb455-2" tabindex="-1"></a>  <span class="fu">select</span>(playerID, nameFirst, nameLast, HR)</span>
<span id="cb455-3"><a href="data-import-and-consolidation.html#cb455-3" tabindex="-1"></a></span>
<span id="cb455-4"><a href="data-import-and-consolidation.html#cb455-4" tabindex="-1"></a>top_10</span></code></pre></div>
</details>
<ol start="95" style="list-style-type: decimal">
<li>Report the ID and names of the top 10 players who have won at least one prize, <code>premios</code> object, in 2016.</li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="data-import-and-consolidation.html#cb456-1" tabindex="-1"></a><span class="fu">semi_join</span>(top_10, premios, <span class="at">by =</span> <span class="st">&quot;playerID&quot;</span>)</span></code></pre></div>
</details>
<ol start="96" style="list-style-type: decimal">
<li>Report the ID and names of the players who won at least one prize in 2016, but are not part of the top 10.</li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="data-import-and-consolidation.html#cb457-1" tabindex="-1"></a><span class="co"># First we calculate all prizes of those who are not top 10:</span></span>
<span id="cb457-2"><a href="data-import-and-consolidation.html#cb457-2" tabindex="-1"></a>ID_de_premiados_no_top <span class="ot">&lt;-</span> <span class="fu">anti_join</span>(premios, top_10, <span class="at">by =</span> <span class="st">&quot;playerID&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb457-3"><a href="data-import-and-consolidation.html#cb457-3" tabindex="-1"></a>  <span class="fu">select</span>(playerID)</span>
<span id="cb457-4"><a href="data-import-and-consolidation.html#cb457-4" tabindex="-1"></a></span>
<span id="cb457-5"><a href="data-import-and-consolidation.html#cb457-5" tabindex="-1"></a><span class="co"># As a player could have obtained several prizes we obtain unique values</span></span>
<span id="cb457-6"><a href="data-import-and-consolidation.html#cb457-6" tabindex="-1"></a>ID_de_premiados_no_top <span class="ot">&lt;-</span> <span class="fu">unique</span>(ID_de_premiados_no_top)</span>
<span id="cb457-7"><a href="data-import-and-consolidation.html#cb457-7" tabindex="-1"></a></span>
<span id="cb457-8"><a href="data-import-and-consolidation.html#cb457-8" tabindex="-1"></a><span class="co"># Then we cross with the master to obtain the names</span></span>
<span id="cb457-9"><a href="data-import-and-consolidation.html#cb457-9" tabindex="-1"></a>nombres_de_otros <span class="ot">&lt;-</span> <span class="fu">left_join</span>(ID_de_premiados_no_top, maestra, <span class="at">by =</span> <span class="st">&quot;playerID&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb457-10"><a href="data-import-and-consolidation.html#cb457-10" tabindex="-1"></a>  <span class="fu">select</span>(playerID, nameFirst, nameLast)</span>
<span id="cb457-11"><a href="data-import-and-consolidation.html#cb457-11" tabindex="-1"></a></span>
<span id="cb457-12"><a href="data-import-and-consolidation.html#cb457-12" tabindex="-1"></a>nombres_de_otros</span></code></pre></div>
</details>
<ol start="97" style="list-style-type: decimal">
<li>Store the tables from the following web page: <a href="http://www.stevetheump.com/Payrolls.htm" class="uri">http://www.stevetheump.com/Payrolls.htm</a> which contains the payroll that each US baseball team pays as of February 2020 in the <code>html</code> object. Then, access the nodes using <code>html_nodes("table")</code> and store it in the <code>nodos</code> object. Finally, report node 4 in <code>html_table</code> format.</li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="data-import-and-consolidation.html#cb458-1" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;http://www.stevetheump.com/Payrolls.htm&quot;</span></span>
<span id="cb458-2"><a href="data-import-and-consolidation.html#cb458-2" tabindex="-1"></a>html <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url)</span>
<span id="cb458-3"><a href="data-import-and-consolidation.html#cb458-3" tabindex="-1"></a></span>
<span id="cb458-4"><a href="data-import-and-consolidation.html#cb458-4" tabindex="-1"></a>nodos <span class="ot">&lt;-</span> html <span class="sc">|&gt;</span> </span>
<span id="cb458-5"><a href="data-import-and-consolidation.html#cb458-5" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&quot;table&quot;</span>)</span>
<span id="cb458-6"><a href="data-import-and-consolidation.html#cb458-6" tabindex="-1"></a></span>
<span id="cb458-7"><a href="data-import-and-consolidation.html#cb458-7" tabindex="-1"></a>nodos[[<span class="dv">4</span>]] <span class="sc">|&gt;</span> </span>
<span id="cb458-8"><a href="data-import-and-consolidation.html#cb458-8" tabindex="-1"></a>  <span class="fu">html_table</span>()</span></code></pre></div>
</details>
<ol start="98" style="list-style-type: decimal">
<li>From the <code>nodos</code> object created in the previous exercise, store node 4 in the <code>planilla_2019</code> object and node 5 in the <code>planilla_2018</code> object. Now format both tables so that the headers are: equipo (team), planilla_2019 or planilla_2018 according to the table. Finally, do a crossing of both tables by team name using <code>full_join()</code>.</li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="data-import-and-consolidation.html#cb459-1" tabindex="-1"></a>planilla_2019 <span class="ot">&lt;-</span> nodos[[<span class="dv">4</span>]] <span class="sc">|&gt;</span> </span>
<span id="cb459-2"><a href="data-import-and-consolidation.html#cb459-2" tabindex="-1"></a>  <span class="fu">html_table</span>()</span>
<span id="cb459-3"><a href="data-import-and-consolidation.html#cb459-3" tabindex="-1"></a></span>
<span id="cb459-4"><a href="data-import-and-consolidation.html#cb459-4" tabindex="-1"></a>planilla_2018 <span class="ot">&lt;-</span> nodos[[<span class="dv">5</span>]] <span class="sc">|&gt;</span> </span>
<span id="cb459-5"><a href="data-import-and-consolidation.html#cb459-5" tabindex="-1"></a>  <span class="fu">html_table</span>()</span>
<span id="cb459-6"><a href="data-import-and-consolidation.html#cb459-6" tabindex="-1"></a></span>
<span id="cb459-7"><a href="data-import-and-consolidation.html#cb459-7" tabindex="-1"></a><span class="do">####### Payroll 2019: ################</span></span>
<span id="cb459-8"><a href="data-import-and-consolidation.html#cb459-8" tabindex="-1"></a><span class="co">#We eliminate row 15 which is the league average:</span></span>
<span id="cb459-9"><a href="data-import-and-consolidation.html#cb459-9" tabindex="-1"></a>planilla_2019 <span class="ot">&lt;-</span> planilla_2019[<span class="sc">-</span><span class="dv">15</span>, ]</span>
<span id="cb459-10"><a href="data-import-and-consolidation.html#cb459-10" tabindex="-1"></a></span>
<span id="cb459-11"><a href="data-import-and-consolidation.html#cb459-11" tabindex="-1"></a><span class="co">#We filter the requested columns:</span></span>
<span id="cb459-12"><a href="data-import-and-consolidation.html#cb459-12" tabindex="-1"></a>planilla_2019 <span class="ot">&lt;-</span> planilla_2019 <span class="sc">|&gt;</span> </span>
<span id="cb459-13"><a href="data-import-and-consolidation.html#cb459-13" tabindex="-1"></a>  <span class="fu">select</span>(X2, X4) <span class="sc">|&gt;</span> </span>
<span id="cb459-14"><a href="data-import-and-consolidation.html#cb459-14" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">equipo =</span> X2, <span class="at">planilla_2019 =</span> X4)</span>
<span id="cb459-15"><a href="data-import-and-consolidation.html#cb459-15" tabindex="-1"></a></span>
<span id="cb459-16"><a href="data-import-and-consolidation.html#cb459-16" tabindex="-1"></a><span class="co"># We eliminate row 1 since it is the source header</span></span>
<span id="cb459-17"><a href="data-import-and-consolidation.html#cb459-17" tabindex="-1"></a>planilla_2019 <span class="ot">&lt;-</span> planilla_2019[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb459-18"><a href="data-import-and-consolidation.html#cb459-18" tabindex="-1"></a></span>
<span id="cb459-19"><a href="data-import-and-consolidation.html#cb459-19" tabindex="-1"></a><span class="do">####### Payroll 2018: ################</span></span>
<span id="cb459-20"><a href="data-import-and-consolidation.html#cb459-20" tabindex="-1"></a><span class="co"># We select the two columns that interest us and </span></span>
<span id="cb459-21"><a href="data-import-and-consolidation.html#cb459-21" tabindex="-1"></a><span class="co">#change name to headers</span></span>
<span id="cb459-22"><a href="data-import-and-consolidation.html#cb459-22" tabindex="-1"></a>planilla_2018 <span class="ot">&lt;-</span> planilla_2018 <span class="sc">|&gt;</span> </span>
<span id="cb459-23"><a href="data-import-and-consolidation.html#cb459-23" tabindex="-1"></a>  <span class="fu">select</span>(Team, Payroll) <span class="sc">|&gt;</span> </span>
<span id="cb459-24"><a href="data-import-and-consolidation.html#cb459-24" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">equipo =</span> Team, <span class="at">planilla_2018 =</span> Payroll)</span>
<span id="cb459-25"><a href="data-import-and-consolidation.html#cb459-25" tabindex="-1"></a></span>
<span id="cb459-26"><a href="data-import-and-consolidation.html#cb459-26" tabindex="-1"></a><span class="do">####### Full join: ################</span></span>
<span id="cb459-27"><a href="data-import-and-consolidation.html#cb459-27" tabindex="-1"></a><span class="fu">full_join</span>(planilla_2018, planilla_2019, <span class="at">by =</span> <span class="st">&quot;equipo&quot;</span>)</span></code></pre></div>
</details>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-leek2015" class="csl-entry">
Leek, Jeff. 2015. <em>The Elements of Data Analytic</em>. Leanpub. <a href="https://leanpub.com/datastyle">https://leanpub.com/datastyle</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="string-processing-and-text-mining.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": true,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": null
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": null,
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
