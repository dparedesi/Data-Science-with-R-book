<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 String processing and text mining | Data Science with R</title>
  <meta name="description" content="A comprehensive guide to data science using R, covering fundamentals, visualization, statistics, machine learning with tidymodels, and generative AI integration. Second Edition by Daniel Paredes." />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 String processing and text mining | Data Science with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A comprehensive guide to data science using R, covering fundamentals, visualization, statistics, machine learning with tidymodels, and generative AI integration. Second Edition by Daniel Paredes." />
  <meta name="github-repo" content="dparedesi/Data-Science-with-R-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 String processing and text mining | Data Science with R" />
  
  <meta name="twitter:description" content="A comprehensive guide to data science using R, covering fundamentals, visualization, statistics, machine learning with tidymodels, and generative AI integration. Second Edition by Daniel Paredes." />
  

<meta name="author" content="Author: Mg. Daniel Paredes Inilupu" />


<meta name="date" content="2025-12-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-import-and-consolidation.html"/>
<link rel="next" href="introduction-2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics: Sin Vista -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VJJ963010J"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-VJJ963010J');
</script>

<!-- Global site tag (gtag.js) - Google Analytics: Vista -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-165839710-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-165839710-1');
</script>

<!-- Global site tag (gtag.js) - Google Analytics: Agentedec4mbio -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-17876479-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-17876479-1');
</script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Science with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="acknowledgments.html"><a href="acknowledgments.html"><i class="fa fa-check"></i>Acknowledgments</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#why-r"><i class="fa fa-check"></i>Why R?</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#installing-r"><i class="fa fa-check"></i>Installing R</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#installing-rstudio"><i class="fa fa-check"></i>Installing RStudio</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#rstudio-sections"><i class="fa fa-check"></i>RStudio Sections</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#testing-rstudio"><i class="fa fa-check"></i>Testing RStudio</a></li>
</ul></li>
<li class="part"><span><b>I Fundamentals and Key Tools</b></span></li>
<li class="chapter" data-level="1" data-path="objects.html"><a href="objects.html"><i class="fa fa-check"></i><b>1</b> Objects</a>
<ul>
<li class="chapter" data-level="1.1" data-path="objects.html"><a href="objects.html#what-are-objects-in-r"><i class="fa fa-check"></i><b>1.1</b> What are objects in R?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="objects.html"><a href="objects.html#r-as-an-object-oriented-language"><i class="fa fa-check"></i><b>1.1.1</b> R as an object-oriented language</a></li>
<li class="chapter" data-level="1.1.2" data-path="objects.html"><a href="objects.html#the-power-of-abstraction"><i class="fa fa-check"></i><b>1.1.2</b> The power of abstraction</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="objects.html"><a href="objects.html#variables-the-first-objects-on-your-journey"><i class="fa fa-check"></i><b>1.2</b> Variables: The first objects on your journey</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="objects.html"><a href="objects.html#creating-variables-in-r"><i class="fa fa-check"></i><b>1.2.1</b> Creating variables in R</a></li>
<li class="chapter" data-level="1.2.2" data-path="objects.html"><a href="objects.html#operations-with-variables"><i class="fa fa-check"></i><b>1.2.2</b> Operations with variables</a></li>
<li class="chapter" data-level="1.2.3" data-path="objects.html"><a href="objects.html#best-practices-for-naming-variables"><i class="fa fa-check"></i><b>1.2.3</b> Best practices for naming variables</a></li>
<li class="chapter" data-level="1.2.4" data-path="objects.html"><a href="objects.html#data-types"><i class="fa fa-check"></i><b>1.2.4</b> Data types</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="objects.html"><a href="objects.html#object-types-for-complex-data"><i class="fa fa-check"></i><b>1.3</b> Object types for complex data</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="objects.html"><a href="objects.html#vectors-organizing-information-of-the-same-type"><i class="fa fa-check"></i><b>1.3.1</b> Vectors: organizing information of the same type</a></li>
<li class="chapter" data-level="1.3.2" data-path="objects.html"><a href="objects.html#lists-grouping-objects-of-different-types"><i class="fa fa-check"></i><b>1.3.2</b> Lists: grouping objects of different types</a></li>
<li class="chapter" data-level="1.3.3" data-path="objects.html"><a href="objects.html#matrices-organizing-data-in-rows-and-columns"><i class="fa fa-check"></i><b>1.3.3</b> Matrices: organizing data in rows and columns</a></li>
<li class="chapter" data-level="1.3.4" data-path="objects.html"><a href="objects.html#arrays-multidimensional-matrices"><i class="fa fa-check"></i><b>1.3.4</b> Arrays: multidimensional matrices</a></li>
<li class="chapter" data-level="1.3.5" data-path="objects.html"><a href="objects.html#factors-representing-categorical-data"><i class="fa fa-check"></i><b>1.3.5</b> Factors: representing categorical data</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="objects.html"><a href="objects.html#the-universe-of-objects-in-r"><i class="fa fa-check"></i><b>1.4</b> The Universe of Objects in R</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="objects.html"><a href="objects.html#philosophy-of-objects-in-r"><i class="fa fa-check"></i><b>1.4.1</b> Philosophy of objects in R</a></li>
<li class="chapter" data-level="1.4.2" data-path="objects.html"><a href="objects.html#comparison-with-other-languages"><i class="fa fa-check"></i><b>1.4.2</b> Comparison with other languages</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="objects.html"><a href="objects.html#exercises"><i class="fa fa-check"></i><b>1.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>2</b> Functions</a>
<ul>
<li class="chapter" data-level="2.1" data-path="functions.html"><a href="functions.html#introduction-to-the-world-of-functions"><i class="fa fa-check"></i><b>2.1</b> Introduction to the world of functions</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="functions.html"><a href="functions.html#what-are-functions"><i class="fa fa-check"></i><b>2.1.1</b> What are functions?</a></li>
<li class="chapter" data-level="2.1.2" data-path="functions.html"><a href="functions.html#why-use-functions"><i class="fa fa-check"></i><b>2.1.2</b> Why use functions?</a></li>
<li class="chapter" data-level="2.1.3" data-path="functions.html"><a href="functions.html#first-functions-exploring-basic-r-functions"><i class="fa fa-check"></i><b>2.1.3</b> First functions: exploring basic R functions</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="functions.html"><a href="functions.html#anatomy-of-a-function"><i class="fa fa-check"></i><b>2.2</b> Anatomy of a function</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="functions.html"><a href="functions.html#arguments-the-ingredients-of-the-function"><i class="fa fa-check"></i><b>2.2.1</b> Arguments: the ingredients of the function</a></li>
<li class="chapter" data-level="2.2.2" data-path="functions.html"><a href="functions.html#body-the-instructions-of-the-function"><i class="fa fa-check"></i><b>2.2.2</b> Body: the instructions of the function</a></li>
<li class="chapter" data-level="2.2.3" data-path="functions.html"><a href="functions.html#return-value-the-result-of-the-function"><i class="fa fa-check"></i><b>2.2.3</b> Return value: the result of the function</a></li>
<li class="chapter" data-level="2.2.4" data-path="functions.html"><a href="functions.html#examples-creating-simple-functions-step-by-step"><i class="fa fa-check"></i><b>2.2.4</b> Examples: creating simple functions step by step</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="functions.html"><a href="functions.html#mastering-the-use-of-functions"><i class="fa fa-check"></i><b>2.3</b> Mastering the use of functions</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="functions.html"><a href="functions.html#functions-with-a-variable-number-of-arguments-...-adapting-to-different-situations"><i class="fa fa-check"></i><b>2.3.1</b> Functions with a variable number of arguments (<code>...</code>): Adapting to different situations</a></li>
<li class="chapter" data-level="2.3.2" data-path="functions.html"><a href="functions.html#variable-scope-local-and-global-variables"><i class="fa fa-check"></i><b>2.3.2</b> Variable scope: local and global variables</a></li>
<li class="chapter" data-level="2.3.3" data-path="functions.html"><a href="functions.html#examples-functions-to-calculate-taxes-discounts-etc."><i class="fa fa-check"></i><b>2.3.3</b> Examples: functions to calculate taxes, discounts, etc.</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="functions.html"><a href="functions.html#higher-order-functions"><i class="fa fa-check"></i><b>2.4</b> Higher-order functions</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="functions.html"><a href="functions.html#lapply-and-sapply-applying-a-function-to-each-element"><i class="fa fa-check"></i><b>2.4.1</b> <code>lapply()</code> and <code>sapply()</code>: applying a function to each element</a></li>
<li class="chapter" data-level="2.4.2" data-path="functions.html"><a href="functions.html#apply-applying-a-function-to-rows-or-columns"><i class="fa fa-check"></i><b>2.4.2</b> <code>apply()</code>: applying a function to rows or columns</a></li>
<li class="chapter" data-level="2.4.3" data-path="functions.html"><a href="functions.html#mapply-applying-a-function-to-multiple-arguments"><i class="fa fa-check"></i><b>2.4.3</b> <code>mapply()</code>: applying a function to multiple arguments</a></li>
<li class="chapter" data-level="2.4.4" data-path="functions.html"><a href="functions.html#examples-data-analysis-with-higher-order-functions"><i class="fa fa-check"></i><b>2.4.4</b> Examples: data analysis with higher-order functions</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="functions.html"><a href="functions.html#closures-functions-with-memory"><i class="fa fa-check"></i><b>2.5</b> Closures: functions with memory</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="functions.html"><a href="functions.html#concept-functions-that-remember"><i class="fa fa-check"></i><b>2.5.1</b> Concept: functions that “remember”</a></li>
<li class="chapter" data-level="2.5.2" data-path="functions.html"><a href="functions.html#applications-creating-counters-functions-with-internal-state"><i class="fa fa-check"></i><b>2.5.2</b> Applications: creating counters, functions with internal state</a></li>
<li class="chapter" data-level="2.5.3" data-path="functions.html"><a href="functions.html#examples-simulating-a-game-creating-an-operation-history"><i class="fa fa-check"></i><b>2.5.3</b> Examples: simulating a game, creating an operation history</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="functions.html"><a href="functions.html#debugging-and-error-handling-solving-the-mysteries-of-your-code"><i class="fa fa-check"></i><b>2.6</b> Debugging and error handling: solving the mysteries of your code</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="functions.html"><a href="functions.html#identifying-errors-common-error-messages-in-r"><i class="fa fa-check"></i><b>2.6.1</b> Identifying errors: common error messages in R</a></li>
<li class="chapter" data-level="2.6.2" data-path="functions.html"><a href="functions.html#debugging-tools-debug-traceback"><i class="fa fa-check"></i><b>2.6.2</b> Debugging tools: <code>debug()</code>, <code>traceback()</code></a></li>
<li class="chapter" data-level="2.6.3" data-path="functions.html"><a href="functions.html#error-handling-trycatch"><i class="fa fa-check"></i><b>2.6.3</b> Error handling: <code>tryCatch()</code></a></li>
<li class="chapter" data-level="2.6.4" data-path="functions.html"><a href="functions.html#examples-debugging-functions-with-errors-handling-exceptions"><i class="fa fa-check"></i><b>2.6.4</b> Examples: debugging functions with errors, handling exceptions</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="functions.html"><a href="functions.html#exercises-1"><i class="fa fa-check"></i><b>2.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-frames.html"><a href="data-frames.html"><i class="fa fa-check"></i><b>3</b> Data Frames</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-frames.html"><a href="data-frames.html#introduction-to-data-frames"><i class="fa fa-check"></i><b>3.1</b> Introduction to Data Frames</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-frames.html"><a href="data-frames.html#what-are-data-frames"><i class="fa fa-check"></i><b>3.1.1</b> What are data frames?</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-frames.html"><a href="data-frames.html#why-data-frames"><i class="fa fa-check"></i><b>3.1.2</b> Why data frames?</a></li>
<li class="chapter" data-level="3.1.3" data-path="data-frames.html"><a href="data-frames.html#data-frames-in-action-exploring-information-about-the-united-states"><i class="fa fa-check"></i><b>3.1.3</b> Data Frames in action: exploring information about the United States</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-frames.html"><a href="data-frames.html#creating-data-frames-building-your-database-for-the-move"><i class="fa fa-check"></i><b>3.2</b> Creating Data Frames: Building your database for the move</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-frames.html"><a href="data-frames.html#importing-data-from-files-csv-excel"><i class="fa fa-check"></i><b>3.2.1</b> Importing data from files: CSV, Excel</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-frames.html"><a href="data-frames.html#creating-data-frames-manually"><i class="fa fa-check"></i><b>3.2.2</b> Creating data frames manually</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-frames.html"><a href="data-frames.html#examples"><i class="fa fa-check"></i><b>3.2.3</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-frames.html"><a href="data-frames.html#exploring-data-frames-discovering-the-secrets-of-your-data"><i class="fa fa-check"></i><b>3.3</b> Exploring Data Frames: Discovering the secrets of your data</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-frames.html"><a href="data-frames.html#accessing-rows-columns-and-cells"><i class="fa fa-check"></i><b>3.3.1</b> Accessing rows, columns, and cells</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-frames.html"><a href="data-frames.html#functions-for-exploring-data-frames"><i class="fa fa-check"></i><b>3.3.2</b> Functions for exploring data frames</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-frames.html"><a href="data-frames.html#examples-exploring-data-frames-with-move-information"><i class="fa fa-check"></i><b>3.3.3</b> Examples: exploring data frames with move information</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-frames.html"><a href="data-frames.html#manipulating-data-frames-transforming-your-data"><i class="fa fa-check"></i><b>3.4</b> Manipulating Data Frames: Transforming your data</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-frames.html"><a href="data-frames.html#introduction-to-the-pipeline-operator"><i class="fa fa-check"></i><b>3.4.1</b> Introduction to the pipeline operator (<code>|&gt;</code>)</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-frames.html"><a href="data-frames.html#transforming-a-table-with-mutate"><i class="fa fa-check"></i><b>3.4.2</b> Transforming a table with <code>mutate()</code></a></li>
<li class="chapter" data-level="3.4.3" data-path="data-frames.html"><a href="data-frames.html#filtering-data-selecting-cities-that-interest-you"><i class="fa fa-check"></i><b>3.4.3</b> Filtering data: selecting cities that interest you</a></li>
<li class="chapter" data-level="3.4.4" data-path="data-frames.html"><a href="data-frames.html#sorting-data-finding-the-safest-cities"><i class="fa fa-check"></i><b>3.4.4</b> Sorting data: finding the safest cities</a></li>
<li class="chapter" data-level="3.4.5" data-path="data-frames.html"><a href="data-frames.html#aggregating-and-summarizing-data-obtaining-general-overview"><i class="fa fa-check"></i><b>3.4.5</b> Aggregating and summarizing data: obtaining general overview</a></li>
<li class="chapter" data-level="3.4.6" data-path="data-frames.html"><a href="data-frames.html#joining-data-frames-combining-information"><i class="fa fa-check"></i><b>3.4.6</b> Joining data frames: combining information</a></li>
<li class="chapter" data-level="3.4.7" data-path="data-frames.html"><a href="data-frames.html#examples-1"><i class="fa fa-check"></i><b>3.4.7</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-frames.html"><a href="data-frames.html#exercises-2"><i class="fa fa-check"></i><b>3.5</b> Exercises</a></li>
<li class="chapter" data-level="3.6" data-path="data-frames.html"><a href="data-frames.html#data-frames-in-plots"><i class="fa fa-check"></i><b>3.6</b> Data frames in plots</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="data-frames.html"><a href="data-frames.html#scatter-plots"><i class="fa fa-check"></i><b>3.6.1</b> Scatter plots</a></li>
<li class="chapter" data-level="3.6.2" data-path="data-frames.html"><a href="data-frames.html#histograms"><i class="fa fa-check"></i><b>3.6.2</b> Histograms</a></li>
<li class="chapter" data-level="3.6.3" data-path="data-frames.html"><a href="data-frames.html#box-plot"><i class="fa fa-check"></i><b>3.6.3</b> Box plot</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="data-frames.html"><a href="data-frames.html#data-interpretation"><i class="fa fa-check"></i><b>3.7</b> Data interpretation</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="data-frames.html"><a href="data-frames.html#quartiles"><i class="fa fa-check"></i><b>3.7.1</b> Quartiles</a></li>
<li class="chapter" data-level="3.7.2" data-path="data-frames.html"><a href="data-frames.html#interpretation-of-box-plot"><i class="fa fa-check"></i><b>3.7.2</b> Interpretation of box plot</a></li>
<li class="chapter" data-level="3.7.3" data-path="data-frames.html"><a href="data-frames.html#examples-2"><i class="fa fa-check"></i><b>3.7.3</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="data-frames.html"><a href="data-frames.html#exercises-3"><i class="fa fa-check"></i><b>3.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="advanced-techniques.html"><a href="advanced-techniques.html"><i class="fa fa-check"></i><b>4</b> Advanced Techniques</a>
<ul>
<li class="chapter" data-level="4.1" data-path="advanced-techniques.html"><a href="advanced-techniques.html#metaprogramming-writing-code-that-writes-code"><i class="fa fa-check"></i><b>4.1</b> Metaprogramming: writing code that writes code</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="advanced-techniques.html"><a href="advanced-techniques.html#manipulating-expressions-the-art-of-sculpting-code"><i class="fa fa-check"></i><b>4.1.1</b> Manipulating expressions: The art of sculpting code</a></li>
<li class="chapter" data-level="4.1.2" data-path="advanced-techniques.html"><a href="advanced-techniques.html#examples-3"><i class="fa fa-check"></i><b>4.1.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="advanced-techniques.html"><a href="advanced-techniques.html#functional-programming-a-new-paradigm"><i class="fa fa-check"></i><b>4.2</b> Functional programming: a new paradigm</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="advanced-techniques.html"><a href="advanced-techniques.html#basic-principles-of-functional-programming"><i class="fa fa-check"></i><b>4.2.1</b> Basic principles of functional programming</a></li>
<li class="chapter" data-level="4.2.2" data-path="advanced-techniques.html"><a href="advanced-techniques.html#higher-order-functions-in-r"><i class="fa fa-check"></i><b>4.2.2</b> Higher-order functions in R</a></li>
<li class="chapter" data-level="4.2.3" data-path="advanced-techniques.html"><a href="advanced-techniques.html#examples-4"><i class="fa fa-check"></i><b>4.2.3</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="advanced-techniques.html"><a href="advanced-techniques.html#r6-the-future-of-oop-in-r"><i class="fa fa-check"></i><b>4.3</b> R6: The future of OOP in R</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="advanced-techniques.html"><a href="advanced-techniques.html#the-r6-package-classes-methods-encapsulation-and-inheritance"><i class="fa fa-check"></i><b>4.3.1</b> The R6 package: Classes, methods, encapsulation, and inheritance</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="advanced-techniques.html"><a href="advanced-techniques.html#exercises-4"><i class="fa fa-check"></i><b>4.4</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>II Data Visualization and Summarization</b></span></li>
<li class="chapter" data-level="5" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html"><i class="fa fa-check"></i><b>5</b> Ggplot and dplyr</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#creating-the-ggplot-object"><i class="fa fa-check"></i><b>5.1</b> Creating the ggplot object</a></li>
<li class="chapter" data-level="5.2" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#aesthetic-mapping-layer"><i class="fa fa-check"></i><b>5.2</b> Aesthetic mapping layer</a></li>
<li class="chapter" data-level="5.3" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#geoms-layer"><i class="fa fa-check"></i><b>5.3</b> Geoms layer</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#tweaking-aes-and-geoms"><i class="fa fa-check"></i><b>5.3.1</b> Tweaking aes and geoms</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#scale-layer"><i class="fa fa-check"></i><b>5.4</b> Scale layer</a></li>
<li class="chapter" data-level="5.5" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#label-title-and-legend-layer"><i class="fa fa-check"></i><b>5.5</b> Label, title and legend layer</a></li>
<li class="chapter" data-level="5.6" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#reference-lines"><i class="fa fa-check"></i><b>5.6</b> Reference lines</a></li>
<li class="chapter" data-level="5.7" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#changing-the-plot-style"><i class="fa fa-check"></i><b>5.7</b> Changing the plot style</a></li>
<li class="chapter" data-level="5.8" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#summarizing-data-with-dplyr"><i class="fa fa-check"></i><b>5.8</b> Summarizing data with dplyr</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#summarize-function"><i class="fa fa-check"></i><b>5.8.1</b> Summarize function</a></li>
<li class="chapter" data-level="5.8.2" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#group-by-function"><i class="fa fa-check"></i><b>5.8.2</b> Group By Function</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="ggplot-and-dplyr.html"><a href="ggplot-and-dplyr.html#exercises-5"><i class="fa fa-check"></i><b>5.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="gapminder.html"><a href="gapminder.html"><i class="fa fa-check"></i><b>6</b> Gapminder</a>
<ul>
<li class="chapter" data-level="6.1" data-path="gapminder.html"><a href="gapminder.html#initial-gapminder-plots"><i class="fa fa-check"></i><b>6.1</b> Initial gapminder plots</a></li>
<li class="chapter" data-level="6.2" data-path="gapminder.html"><a href="gapminder.html#facets"><i class="fa fa-check"></i><b>6.2</b> Facets</a></li>
<li class="chapter" data-level="6.3" data-path="gapminder.html"><a href="gapminder.html#time-series"><i class="fa fa-check"></i><b>6.3</b> Time series</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="gapminder.html"><a href="gapminder.html#individual-time-series"><i class="fa fa-check"></i><b>6.3.1</b> Individual time series</a></li>
<li class="chapter" data-level="6.3.2" data-path="gapminder.html"><a href="gapminder.html#multiple-time-series"><i class="fa fa-check"></i><b>6.3.2</b> Multiple time series</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="gapminder.html"><a href="gapminder.html#exercises-6"><i class="fa fa-check"></i><b>6.4</b> Exercises</a></li>
<li class="chapter" data-level="6.5" data-path="gapminder.html"><a href="gapminder.html#histograms-with-ggplot"><i class="fa fa-check"></i><b>6.5</b> Histograms with ggplot</a></li>
<li class="chapter" data-level="6.6" data-path="gapminder.html"><a href="gapminder.html#box-plots-with-ggplot"><i class="fa fa-check"></i><b>6.6</b> Box plots with ggplot</a></li>
<li class="chapter" data-level="6.7" data-path="gapminder.html"><a href="gapminder.html#comparison-of-distributions"><i class="fa fa-check"></i><b>6.7</b> Comparison of distributions</a></li>
<li class="chapter" data-level="6.8" data-path="gapminder.html"><a href="gapminder.html#exercises-7"><i class="fa fa-check"></i><b>6.8</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>III Statistics</b></span></li>
<li class="chapter" data-level="" data-path="introduction-to-probabilities.html"><a href="introduction-to-probabilities.html"><i class="fa fa-check"></i>Introduction to Probabilities</a></li>
<li class="chapter" data-level="7" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html"><i class="fa fa-check"></i><b>7</b> Discrete Probabilities</a>
<ul>
<li class="chapter" data-level="7.1" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#calculation-using-the-mathematical-definition"><i class="fa fa-check"></i><b>7.1</b> Calculation using the mathematical definition</a></li>
<li class="chapter" data-level="7.2" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#monte-carlo-simulation-for-discrete-variables"><i class="fa fa-check"></i><b>7.2</b> Monte Carlo Simulation for Discrete Variables</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#other-functions-to-create-vectors"><i class="fa fa-check"></i><b>7.2.1</b> Other functions to create vectors</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#exercises-8"><i class="fa fa-check"></i><b>7.3</b> Exercises</a></li>
<li class="chapter" data-level="7.4" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#combinations-and-permutations"><i class="fa fa-check"></i><b>7.4</b> Combinations and Permutations</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#permutations"><i class="fa fa-check"></i><b>7.4.1</b> Permutations</a></li>
<li class="chapter" data-level="7.4.2" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#combinations"><i class="fa fa-check"></i><b>7.4.2</b> Combinations</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#sufficient-experiments-with-monte-carlo-simulation"><i class="fa fa-check"></i><b>7.5</b> Sufficient Experiments with Monte Carlo Simulation</a></li>
<li class="chapter" data-level="7.6" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#case-birthdays-in-classrooms"><i class="fa fa-check"></i><b>7.6</b> Case: Birthdays in Classrooms</a></li>
<li class="chapter" data-level="7.7" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#exercises-9"><i class="fa fa-check"></i><b>7.7</b> Exercises</a></li>
<li class="chapter" data-level="7.8" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#integrative-exercise"><i class="fa fa-check"></i><b>7.8</b> Integrative Exercise</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="discrete-probabilities.html"><a href="discrete-probabilities.html#monty-hall-problem"><i class="fa fa-check"></i><b>7.8.1</b> Monty Hall Problem</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="continuous-probabilities.html"><a href="continuous-probabilities.html"><i class="fa fa-check"></i><b>8</b> Continuous Probabilities</a>
<ul>
<li class="chapter" data-level="8.1" data-path="continuous-probabilities.html"><a href="continuous-probabilities.html#empirical-distribution"><i class="fa fa-check"></i><b>8.1</b> Empirical Distribution</a></li>
<li class="chapter" data-level="8.2" data-path="continuous-probabilities.html"><a href="continuous-probabilities.html#theoretical-distribution"><i class="fa fa-check"></i><b>8.2</b> Theoretical Distribution</a></li>
<li class="chapter" data-level="8.3" data-path="continuous-probabilities.html"><a href="continuous-probabilities.html#exercises-10"><i class="fa fa-check"></i><b>8.3</b> Exercises</a></li>
<li class="chapter" data-level="8.4" data-path="continuous-probabilities.html"><a href="continuous-probabilities.html#monte-carlo-simulation-for-continuous-variables"><i class="fa fa-check"></i><b>8.4</b> Monte Carlo Simulation for Continuous Variables</a></li>
<li class="chapter" data-level="8.5" data-path="continuous-probabilities.html"><a href="continuous-probabilities.html#exercises-11"><i class="fa fa-check"></i><b>8.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i><b>9</b> Statistical Inference</a>
<ul>
<li class="chapter" data-level="9.1" data-path="statistical-inference.html"><a href="statistical-inference.html#expected-value"><i class="fa fa-check"></i><b>9.1</b> Expected Value</a></li>
<li class="chapter" data-level="9.2" data-path="statistical-inference.html"><a href="statistical-inference.html#central-limit-theorem"><i class="fa fa-check"></i><b>9.2</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="9.3" data-path="statistical-inference.html"><a href="statistical-inference.html#exercises-12"><i class="fa fa-check"></i><b>9.3</b> Exercises</a></li>
<li class="chapter" data-level="9.4" data-path="statistical-inference.html"><a href="statistical-inference.html#parameter-estimation-method"><i class="fa fa-check"></i><b>9.4</b> Parameter Estimation Method</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="statistical-inference.html"><a href="statistical-inference.html#margin-of-error"><i class="fa fa-check"></i><b>9.4.1</b> Margin of Error</a></li>
<li class="chapter" data-level="9.4.2" data-path="statistical-inference.html"><a href="statistical-inference.html#confidence-intervals"><i class="fa fa-check"></i><b>9.4.2</b> Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="statistical-inference.html"><a href="statistical-inference.html#spread-estimation"><i class="fa fa-check"></i><b>9.5</b> Spread Estimation</a></li>
<li class="chapter" data-level="9.6" data-path="statistical-inference.html"><a href="statistical-inference.html#estimates-outside-election-polls"><i class="fa fa-check"></i><b>9.6</b> Estimates Outside Election Polls</a></li>
<li class="chapter" data-level="9.7" data-path="statistical-inference.html"><a href="statistical-inference.html#exercises-13"><i class="fa fa-check"></i><b>9.7</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>IV Data Wrangling</b></span></li>
<li class="chapter" data-level="" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="10" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html"><i class="fa fa-check"></i><b>10</b> Data import and consolidation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#importing-from-files"><i class="fa fa-check"></i><b>10.1</b> Importing from files</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#working-directory"><i class="fa fa-check"></i><b>10.1.1</b> Working Directory</a></li>
<li class="chapter" data-level="10.1.2" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#readr-and-readxl-packages"><i class="fa fa-check"></i><b>10.1.2</b> readr and readxl packages</a></li>
<li class="chapter" data-level="10.1.3" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#importing-files-from-the-internet"><i class="fa fa-check"></i><b>10.1.3</b> Importing files from the internet</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#tidy-data"><i class="fa fa-check"></i><b>10.2</b> Tidy data</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#transforming-to-tidy-data"><i class="fa fa-check"></i><b>10.2.1</b> Transforming to tidy data</a></li>
<li class="chapter" data-level="10.2.2" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#separate-function"><i class="fa fa-check"></i><b>10.2.2</b> separate function</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#exercises-14"><i class="fa fa-check"></i><b>10.3</b> Exercises</a></li>
<li class="chapter" data-level="10.4" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#joining-tables"><i class="fa fa-check"></i><b>10.4</b> Joining tables</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#join-functions"><i class="fa fa-check"></i><b>10.4.1</b> Join functions</a></li>
<li class="chapter" data-level="10.4.2" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#joining-without-a-common-identifier"><i class="fa fa-check"></i><b>10.4.2</b> Joining without a common identifier</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#web-scraping"><i class="fa fa-check"></i><b>10.5</b> Web Scraping</a></li>
<li class="chapter" data-level="10.6" data-path="data-import-and-consolidation.html"><a href="data-import-and-consolidation.html#exercises-15"><i class="fa fa-check"></i><b>10.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html"><i class="fa fa-check"></i><b>11</b> String processing and text mining</a>
<ul>
<li class="chapter" data-level="11.1" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#basic-functions"><i class="fa fa-check"></i><b>11.1</b> Basic functions</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#replacing-characters"><i class="fa fa-check"></i><b>11.1.1</b> Replacing characters</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#regular-expressions"><i class="fa fa-check"></i><b>11.2</b> Regular expressions</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#alternation"><i class="fa fa-check"></i><b>11.2.1</b> Alternation</a></li>
<li class="chapter" data-level="11.2.2" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#anchoring"><i class="fa fa-check"></i><b>11.2.2</b> Anchoring</a></li>
<li class="chapter" data-level="11.2.3" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#repetitions"><i class="fa fa-check"></i><b>11.2.3</b> Repetitions</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#from-strings-to-dates"><i class="fa fa-check"></i><b>11.3</b> From strings to dates</a></li>
<li class="chapter" data-level="11.4" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#exercises-16"><i class="fa fa-check"></i><b>11.4</b> Exercises</a></li>
<li class="chapter" data-level="11.5" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#text-mining-word-cloud"><i class="fa fa-check"></i><b>11.5</b> Text Mining: Word Cloud</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#importing-data"><i class="fa fa-check"></i><b>11.5.1</b> Importing data</a></li>
<li class="chapter" data-level="11.5.2" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#text-cleaning"><i class="fa fa-check"></i><b>11.5.2</b> Text cleaning</a></li>
<li class="chapter" data-level="11.5.3" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#creating-the-corpus"><i class="fa fa-check"></i><b>11.5.3</b> Creating the Corpus</a></li>
<li class="chapter" data-level="11.5.4" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#nd-data-cleaning"><i class="fa fa-check"></i><b>11.5.4</b> 2nd Data Cleaning</a></li>
<li class="chapter" data-level="11.5.5" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#word-frequency"><i class="fa fa-check"></i><b>11.5.5</b> Word frequency</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#text-mining-sentiment-analysis"><i class="fa fa-check"></i><b>11.6</b> Text Mining: Sentiment Analysis</a></li>
<li class="chapter" data-level="11.7" data-path="string-processing-and-text-mining.html"><a href="string-processing-and-text-mining.html#exercises-17"><i class="fa fa-check"></i><b>11.7</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>V Machine learning</b></span></li>
<li class="chapter" data-level="" data-path="introduction-2.html"><a href="introduction-2.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="12" data-path="supervised-learning.html"><a href="supervised-learning.html"><i class="fa fa-check"></i><b>12</b> Supervised Learning</a>
<ul>
<li class="chapter" data-level="12.1" data-path="supervised-learning.html"><a href="supervised-learning.html#classification-and-regression"><i class="fa fa-check"></i><b>12.1</b> Classification and Regression</a></li>
<li class="chapter" data-level="12.2" data-path="supervised-learning.html"><a href="supervised-learning.html#knn-k-nearest-neighbors"><i class="fa fa-check"></i><b>12.2</b> kNN: k-Nearest Neighbors</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="supervised-learning.html"><a href="supervised-learning.html#two-variables-as-input"><i class="fa fa-check"></i><b>12.2.1</b> Two variables as input</a></li>
<li class="chapter" data-level="12.2.2" data-path="supervised-learning.html"><a href="supervised-learning.html#multiple-variables-as-input"><i class="fa fa-check"></i><b>12.2.2</b> Multiple variables as input</a></li>
<li class="chapter" data-level="12.2.3" data-path="supervised-learning.html"><a href="supervised-learning.html#diverse-values-of-k"><i class="fa fa-check"></i><b>12.2.3</b> Diverse values of k</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="supervised-learning.html"><a href="supervised-learning.html#tidymodels-framework"><i class="fa fa-check"></i><b>12.3</b> tidymodels Framework</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="supervised-learning.html"><a href="supervised-learning.html#creation-of-training-and-test-data"><i class="fa fa-check"></i><b>12.3.1</b> Creation of training and test data</a></li>
<li class="chapter" data-level="12.3.2" data-path="supervised-learning.html"><a href="supervised-learning.html#training-our-prediction-algorithm"><i class="fa fa-check"></i><b>12.3.2</b> Training our prediction algorithm</a></li>
<li class="chapter" data-level="12.3.3" data-path="supervised-learning.html"><a href="supervised-learning.html#data-pre-processing-with-recipes"><i class="fa fa-check"></i><b>12.3.3</b> Data Pre-processing with Recipes</a></li>
<li class="chapter" data-level="12.3.4" data-path="supervised-learning.html"><a href="supervised-learning.html#creating-a-workflow"><i class="fa fa-check"></i><b>12.3.4</b> Creating a Workflow</a></li>
<li class="chapter" data-level="12.3.5" data-path="supervised-learning.html"><a href="supervised-learning.html#parameter-tuning-with-cross-validation"><i class="fa fa-check"></i><b>12.3.5</b> Parameter Tuning with Cross-Validation</a></li>
<li class="chapter" data-level="12.3.6" data-path="supervised-learning.html"><a href="supervised-learning.html#finalizing-the-model"><i class="fa fa-check"></i><b>12.3.6</b> Finalizing the Model</a></li>
<li class="chapter" data-level="12.3.7" data-path="supervised-learning.html"><a href="supervised-learning.html#testing-the-prediction-model"><i class="fa fa-check"></i><b>12.3.7</b> Testing the prediction model</a></li>
<li class="chapter" data-level="12.3.8" data-path="supervised-learning.html"><a href="supervised-learning.html#model-evaluation-with-yardstick"><i class="fa fa-check"></i><b>12.3.8</b> Model Evaluation with yardstick</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="supervised-learning.html"><a href="supervised-learning.html#confusion-matrix"><i class="fa fa-check"></i><b>12.4</b> Confusion Matrix</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="supervised-learning.html"><a href="supervised-learning.html#accuracy"><i class="fa fa-check"></i><b>12.4.1</b> Accuracy</a></li>
<li class="chapter" data-level="12.4.2" data-path="supervised-learning.html"><a href="supervised-learning.html#sensitivity"><i class="fa fa-check"></i><b>12.4.2</b> Sensitivity</a></li>
<li class="chapter" data-level="12.4.3" data-path="supervised-learning.html"><a href="supervised-learning.html#specificity"><i class="fa fa-check"></i><b>12.4.3</b> Specificity</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="supervised-learning.html"><a href="supervised-learning.html#exercises-18"><i class="fa fa-check"></i><b>12.5</b> Exercises</a></li>
<li class="chapter" data-level="12.6" data-path="supervised-learning.html"><a href="supervised-learning.html#simple-linear-regression"><i class="fa fa-check"></i><b>12.6</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="12.7" data-path="supervised-learning.html"><a href="supervised-learning.html#multiple-linear-regression"><i class="fa fa-check"></i><b>12.7</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="12.8" data-path="supervised-learning.html"><a href="supervised-learning.html#standard-method-for-evaluating-accuracy"><i class="fa fa-check"></i><b>12.8</b> Standard Method for Evaluating Accuracy</a></li>
<li class="chapter" data-level="12.9" data-path="supervised-learning.html"><a href="supervised-learning.html#selection-of-the-most-optimal-model"><i class="fa fa-check"></i><b>12.9</b> Selection of the Most Optimal Model</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="supervised-learning.html"><a href="supervised-learning.html#k-nearest-neighbors-model"><i class="fa fa-check"></i><b>12.9.1</b> k-Nearest Neighbors Model</a></li>
<li class="chapter" data-level="12.9.2" data-path="supervised-learning.html"><a href="supervised-learning.html#generalized-linear-model---glm"><i class="fa fa-check"></i><b>12.9.2</b> Generalized Linear Model - GLM</a></li>
<li class="chapter" data-level="12.9.3" data-path="supervised-learning.html"><a href="supervised-learning.html#random-forest-model"><i class="fa fa-check"></i><b>12.9.3</b> Random Forest Model</a></li>
<li class="chapter" data-level="12.9.4" data-path="supervised-learning.html"><a href="supervised-learning.html#support-vector-machine-model---svm"><i class="fa fa-check"></i><b>12.9.4</b> Support Vector Machine Model - SVM</a></li>
<li class="chapter" data-level="12.9.5" data-path="supervised-learning.html"><a href="supervised-learning.html#naive-bayes-model"><i class="fa fa-check"></i><b>12.9.5</b> Naive Bayes Model</a></li>
<li class="chapter" data-level="12.9.6" data-path="supervised-learning.html"><a href="supervised-learning.html#model-comparison"><i class="fa fa-check"></i><b>12.9.6</b> Model Comparison</a></li>
<li class="chapter" data-level="12.9.7" data-path="supervised-learning.html"><a href="supervised-learning.html#predicting-using-the-best-model"><i class="fa fa-check"></i><b>12.9.7</b> Predicting using the best model</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="supervised-learning.html"><a href="supervised-learning.html#exercises-19"><i class="fa fa-check"></i><b>12.10</b> Exercises</a></li>
<li class="chapter" data-level="12.11" data-path="supervised-learning.html"><a href="supervised-learning.html#ethics-bias-in-algorithmic-decision-making"><i class="fa fa-check"></i><b>12.11</b> Ethics: Bias in Algorithmic Decision Making</a>
<ul>
<li class="chapter" data-level="12.11.1" data-path="supervised-learning.html"><a href="supervised-learning.html#the-risk-of-proxy-variables"><i class="fa fa-check"></i><b>12.11.1</b> The Risk of Proxy Variables</a></li>
<li class="chapter" data-level="12.11.2" data-path="supervised-learning.html"><a href="supervised-learning.html#feedback-loops"><i class="fa fa-check"></i><b>12.11.2</b> Feedback Loops</a></li>
<li class="chapter" data-level="12.11.3" data-path="supervised-learning.html"><a href="supervised-learning.html#what-can-we-do"><i class="fa fa-check"></i><b>12.11.3</b> What can we do?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html"><i class="fa fa-check"></i><b>13</b> Unsupervised Learning</a>
<ul>
<li class="chapter" data-level="13.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#k-means-clustering"><i class="fa fa-check"></i><b>13.1</b> K-Means Clustering</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#clustering-with-k-2"><i class="fa fa-check"></i><b>13.1.1</b> Clustering with k = 2</a></li>
<li class="chapter" data-level="13.1.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#clustering-with-k-3"><i class="fa fa-check"></i><b>13.1.2</b> Clustering with k &gt;= 3</a></li>
<li class="chapter" data-level="13.1.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#determination-of-optimal-clusters"><i class="fa fa-check"></i><b>13.1.3</b> Determination of Optimal Clusters</a></li>
<li class="chapter" data-level="13.1.4" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#k-means-for-more-than-2-variables"><i class="fa fa-check"></i><b>13.1.4</b> k-means for more than 2 variables</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#hierarchical-clustering"><i class="fa fa-check"></i><b>13.2</b> Hierarchical Clustering</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#clustering-with-two-variables"><i class="fa fa-check"></i><b>13.2.1</b> Clustering with two variables</a></li>
<li class="chapter" data-level="13.2.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#determination-of-optimal-clusters-1"><i class="fa fa-check"></i><b>13.2.2</b> Determination of Optimal Clusters</a></li>
<li class="chapter" data-level="13.2.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#obtain-the-grouping"><i class="fa fa-check"></i><b>13.2.3</b> Obtain the grouping</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#dimensionality-reduction"><i class="fa fa-check"></i><b>13.3</b> Dimensionality Reduction</a></li>
<li class="chapter" data-level="13.4" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#exercises-20"><i class="fa fa-check"></i><b>13.4</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>VI Real Cases</b></span></li>
<li class="chapter" data-level="" data-path="introduction-3.html"><a href="introduction-3.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="14" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html"><i class="fa fa-check"></i><b>14</b> Case Study: Real Estate Market Analysis</a>
<ul>
<li class="chapter" data-level="14.1" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#objectives"><i class="fa fa-check"></i><b>14.1</b> Objectives</a></li>
<li class="chapter" data-level="14.2" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#loading-libraries"><i class="fa fa-check"></i><b>14.2</b> Loading Libraries</a></li>
<li class="chapter" data-level="14.3" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#exploring-the-data"><i class="fa fa-check"></i><b>14.3</b> Exploring the Data</a></li>
<li class="chapter" data-level="14.4" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#data-cleaning"><i class="fa fa-check"></i><b>14.4</b> Data Cleaning</a></li>
<li class="chapter" data-level="14.5" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#exploratory-analysis"><i class="fa fa-check"></i><b>14.5</b> Exploratory Analysis</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#market-volume-over-time"><i class="fa fa-check"></i><b>14.5.1</b> Market Volume Over Time</a></li>
<li class="chapter" data-level="14.5.2" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#comparing-cities"><i class="fa fa-check"></i><b>14.5.2</b> Comparing Cities</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#creating-indicators"><i class="fa fa-check"></i><b>14.6</b> Creating Indicators</a></li>
<li class="chapter" data-level="14.7" data-path="case-study-real-estate-market-analysis.html"><a href="case-study-real-estate-market-analysis.html#conclusions"><i class="fa fa-check"></i><b>14.7</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="google-analytics-from-r.html"><a href="google-analytics-from-r.html"><i class="fa fa-check"></i><b>15</b> Google Analytics from R</a>
<ul>
<li class="chapter" data-level="15.1" data-path="google-analytics-from-r.html"><a href="google-analytics-from-r.html#problem"><i class="fa fa-check"></i><b>15.1</b> Problem</a></li>
<li class="chapter" data-level="15.2" data-path="google-analytics-from-r.html"><a href="google-analytics-from-r.html#access-to-data"><i class="fa fa-check"></i><b>15.2</b> Access to data</a></li>
<li class="chapter" data-level="15.3" data-path="google-analytics-from-r.html"><a href="google-analytics-from-r.html#visualization"><i class="fa fa-check"></i><b>15.3</b> Visualization</a></li>
<li class="chapter" data-level="15.4" data-path="google-analytics-from-r.html"><a href="google-analytics-from-r.html#conclusion"><i class="fa fa-check"></i><b>15.4</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="genai-intro.html"><a href="genai-intro.html"><i class="fa fa-check"></i><b>16</b> Data Science in the Age of AI</a>
<ul>
<li class="chapter" data-level="16.1" data-path="genai-intro.html"><a href="genai-intro.html#what-is-a-large-language-model"><i class="fa fa-check"></i><b>16.1</b> What is a Large Language Model?</a></li>
<li class="chapter" data-level="16.2" data-path="genai-intro.html"><a href="genai-intro.html#coding-with-ai-the-pair-programmer"><i class="fa fa-check"></i><b>16.2</b> Coding with AI: The “Pair Programmer”</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="genai-intro.html"><a href="genai-intro.html#explaining-complex-code"><i class="fa fa-check"></i><b>16.2.1</b> 1. Explaining Complex Code</a></li>
<li class="chapter" data-level="16.2.2" data-path="genai-intro.html"><a href="genai-intro.html#generating-boilerplate"><i class="fa fa-check"></i><b>16.2.2</b> 2. Generating Boilerplate</a></li>
<li class="chapter" data-level="16.2.3" data-path="genai-intro.html"><a href="genai-intro.html#regex-the-ultimate-use-case"><i class="fa fa-check"></i><b>16.2.3</b> 3. Regex: The Ultimate Use Case</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="genai-intro.html"><a href="genai-intro.html#ethics-risks-in-the-ai-era"><i class="fa fa-check"></i><b>16.3</b> Ethics &amp; Risks in the AI Era</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="genai-intro.html"><a href="genai-intro.html#hallucinations-fabrication"><i class="fa fa-check"></i><b>16.3.1</b> 1. Hallucinations &amp; Fabrication</a></li>
<li class="chapter" data-level="16.3.2" data-path="genai-intro.html"><a href="genai-intro.html#the-reproducibility-crisis"><i class="fa fa-check"></i><b>16.3.2</b> 2. The Reproducibility Crisis</a></li>
<li class="chapter" data-level="16.3.3" data-path="genai-intro.html"><a href="genai-intro.html#data-privacy-ip"><i class="fa fa-check"></i><b>16.3.3</b> 3. Data Privacy &amp; IP</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="genai-api.html"><a href="genai-api.html"><i class="fa fa-check"></i><b>17</b> LLMs as an Analysis Engine</a>
<ul>
<li class="chapter" data-level="17.1" data-path="genai-api.html"><a href="genai-api.html#the-evolution-of-nlp"><i class="fa fa-check"></i><b>17.1</b> The Evolution of NLP</a></li>
<li class="chapter" data-level="17.2" data-path="genai-api.html"><a href="genai-api.html#interacting-with-apis-from-r"><i class="fa fa-check"></i><b>17.2</b> Interacting with APIs from R</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="genai-api.html"><a href="genai-api.html#prerequisite-api-keys"><i class="fa fa-check"></i><b>17.2.1</b> Prerequisite: API Keys</a></li>
<li class="chapter" data-level="17.2.2" data-path="genai-api.html"><a href="genai-api.html#making-a-request"><i class="fa fa-check"></i><b>17.2.2</b> Making a Request</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="genai-api.html"><a href="genai-api.html#zero-shot-classification"><i class="fa fa-check"></i><b>17.3</b> Zero-Shot Classification</a></li>
<li class="chapter" data-level="17.4" data-path="genai-api.html"><a href="genai-api.html#text-cleaning-with-llms"><i class="fa fa-check"></i><b>17.4</b> Text Cleaning with LLMs</a></li>
<li class="chapter" data-level="17.5" data-path="genai-api.html"><a href="genai-api.html#summary"><i class="fa fa-check"></i><b>17.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="ethics-checklist.html"><a href="ethics-checklist.html"><i class="fa fa-check"></i><b>18</b> Appendix A: Responsible AI Checklist</a>
<ul>
<li class="chapter" data-level="18.1" data-path="ethics-checklist.html"><a href="ethics-checklist.html#data-quality-lineage"><i class="fa fa-check"></i><b>18.1</b> 1. Data Quality &amp; lineage</a></li>
<li class="chapter" data-level="18.2" data-path="ethics-checklist.html"><a href="ethics-checklist.html#fairness-bias"><i class="fa fa-check"></i><b>18.2</b> 2. Fairness &amp; Bias</a></li>
<li class="chapter" data-level="18.3" data-path="ethics-checklist.html"><a href="ethics-checklist.html#transparency-explainability"><i class="fa fa-check"></i><b>18.3</b> 3. Transparency &amp; Explainability</a></li>
<li class="chapter" data-level="18.4" data-path="ethics-checklist.html"><a href="ethics-checklist.html#genai-specifics"><i class="fa fa-check"></i><b>18.4</b> 4. GenAI Specifics</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="string-processing-and-text-mining" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number">Chapter 11</span> String processing and text mining<a href="string-processing-and-text-mining.html#string-processing-and-text-mining" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="basic-functions" class="section level2 hasAnchor" number="11.1">
<h2><span class="header-section-number">11.1</span> Basic functions<a href="string-processing-and-text-mining.html#basic-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have already learned how to import data and consolidate it. However, we cannot yet work with this data. We have to validate through string processing and ensure a minimum quality to be able to perform our analyses.</p>
<p>For example, in the previous chapter we imported data from Wikipedia, however we did not focus on whether we could already perform operations or visualizations with our data.</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="string-processing-and-text-mining.html#cb460-1" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb460-2"><a href="string-processing-and-text-mining.html#cb460-2" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://es.wikipedia.org/wiki/Anexo:Pa%C3%ADses_hispanos_por_poblaci%C3%B3n&quot;</span></span>
<span id="cb460-3"><a href="string-processing-and-text-mining.html#cb460-3" tabindex="-1"></a><span class="co">#url &lt;- &quot;https://es.wikipedia.org/wiki/Distribuci%C3%B3n_geogr%C3%A1fica_del_idioma_espa%C3%B1ol&quot; #as a back up URL</span></span>
<span id="cb460-4"><a href="string-processing-and-text-mining.html#cb460-4" tabindex="-1"></a>html_data <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url)</span>
<span id="cb460-5"><a href="string-processing-and-text-mining.html#cb460-5" tabindex="-1"></a></span>
<span id="cb460-6"><a href="string-processing-and-text-mining.html#cb460-6" tabindex="-1"></a>web_tables <span class="ot">&lt;-</span> html_data <span class="sc">|&gt;</span></span>
<span id="cb460-7"><a href="string-processing-and-text-mining.html#cb460-7" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&quot;body&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb460-8"><a href="string-processing-and-text-mining.html#cb460-8" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&quot;table&quot;</span>)</span>
<span id="cb460-9"><a href="string-processing-and-text-mining.html#cb460-9" tabindex="-1"></a></span>
<span id="cb460-10"><a href="string-processing-and-text-mining.html#cb460-10" tabindex="-1"></a>raw_table <span class="ot">&lt;-</span> web_tables[[<span class="dv">2</span>]] <span class="sc">|&gt;</span></span>
<span id="cb460-11"><a href="string-processing-and-text-mining.html#cb460-11" tabindex="-1"></a>  <span class="fu">html_table</span>()</span>
<span id="cb460-12"><a href="string-processing-and-text-mining.html#cb460-12" tabindex="-1"></a></span>
<span id="cb460-13"><a href="string-processing-and-text-mining.html#cb460-13" tabindex="-1"></a>raw_table <span class="ot">&lt;-</span> raw_table <span class="sc">|&gt;</span> </span>
<span id="cb460-14"><a href="string-processing-and-text-mining.html#cb460-14" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">&quot;N&quot;</span>, <span class="st">&quot;pais&quot;</span>, <span class="st">&quot;poblacion&quot;</span>, <span class="st">&quot;prop_poblacion&quot;</span>, <span class="st">&quot;cambio_medio&quot;</span>, <span class="st">&quot;link&quot;</span>)) </span>
<span id="cb460-15"><a href="string-processing-and-text-mining.html#cb460-15" tabindex="-1"></a></span>
<span id="cb460-16"><a href="string-processing-and-text-mining.html#cb460-16" tabindex="-1"></a>raw_table <span class="ot">&lt;-</span> raw_table <span class="sc">|&gt;</span></span>
<span id="cb460-17"><a href="string-processing-and-text-mining.html#cb460-17" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb460-18"><a href="string-processing-and-text-mining.html#cb460-18" tabindex="-1"></a></span>
<span id="cb460-19"><a href="string-processing-and-text-mining.html#cb460-19" tabindex="-1"></a>raw_table <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>)</span></code></pre></div>
<p>We may not have noticed, but we can observe columns with spaces or commas where there should be numbers. We can validate this not only by analyzing the class of the column, but also if we try to calculate the average of that variable.</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="string-processing-and-text-mining.html#cb461-1" tabindex="-1"></a><span class="fu">class</span>(raw_table<span class="sc">$</span>poblacion)</span>
<span id="cb461-2"><a href="string-processing-and-text-mining.html#cb461-2" tabindex="-1"></a></span>
<span id="cb461-3"><a href="string-processing-and-text-mining.html#cb461-3" tabindex="-1"></a><span class="fu">mean</span>(raw_table<span class="sc">$</span>poblacion)</span></code></pre></div>
<p>We cannot do a direct conversion to number either because white spaces and commas are characters.</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="string-processing-and-text-mining.html#cb462-1" tabindex="-1"></a><span class="fu">as.numeric</span>(raw_table<span class="sc">$</span>poblacion)</span></code></pre></div>
<p>There are so frequent and so many possible use cases that there are already multiple functions for processing strings included in the tidyverse library. Likewise, there is more than one way to process strings. It will always depend on how the raw data is found.</p>
<div id="replacing-characters" class="section level3 hasAnchor" number="11.1.1">
<h3><span class="header-section-number">11.1.1</span> Replacing characters<a href="string-processing-and-text-mining.html#replacing-characters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One of the basic functions that we will use the most will be replacing characters. We apply this function when we are sure that this change will not compromise the rest of the data. We have spaces and we have commas. So we could start by replacing one of the two to normalize them using the <code>str_replace_all(string, pattern, replacement)</code> function. In the pattern attribute we will use <code>\\s</code>, which comes from <code>space</code>. We are going to learn first to modify the data stored in a vector and then we will replicate it to our entire table.</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="string-processing-and-text-mining.html#cb463-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb463-2"><a href="string-processing-and-text-mining.html#cb463-2" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb463-3"><a href="string-processing-and-text-mining.html#cb463-3" tabindex="-1"></a></span>
<span id="cb463-4"><a href="string-processing-and-text-mining.html#cb463-4" tabindex="-1"></a>population_vector <span class="ot">&lt;-</span> tabla_en_bruto<span class="sc">$</span>poblacion</span>
<span id="cb463-5"><a href="string-processing-and-text-mining.html#cb463-5" tabindex="-1"></a></span>
<span id="cb463-6"><a href="string-processing-and-text-mining.html#cb463-6" tabindex="-1"></a>population_vector <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(population_vector, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">s&quot;</span>, <span class="st">&quot;,&quot;</span>)</span>
<span id="cb463-7"><a href="string-processing-and-text-mining.html#cb463-7" tabindex="-1"></a></span>
<span id="cb463-8"><a href="string-processing-and-text-mining.html#cb463-8" tabindex="-1"></a>population_vector</span></code></pre></div>
<p>We have purposely taken all the values to be separated by commas because now we can easily use the <code>parse_number(vector)</code> function which not only replaces the commas with empty strings, but also removes any non-numeric value before the first number, which facilitates us if we had monetary values, and also converts the value from character type to numeric type.</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="string-processing-and-text-mining.html#cb464-1" tabindex="-1"></a>population_vector <span class="ot">&lt;-</span> <span class="fu">parse_number</span>(population_vector)</span>
<span id="cb464-2"><a href="string-processing-and-text-mining.html#cb464-2" tabindex="-1"></a></span>
<span id="cb464-3"><a href="string-processing-and-text-mining.html#cb464-3" tabindex="-1"></a><span class="co"># Additional example in case we had a monetary value:</span></span>
<span id="cb464-4"><a href="string-processing-and-text-mining.html#cb464-4" tabindex="-1"></a><span class="fu">parse_number</span>(<span class="st">&quot;$345,153&quot;</span>)</span></code></pre></div>
<p>This vector now allows us to perform mathematical operations or visualization of the distribution.</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="string-processing-and-text-mining.html#cb465-1" tabindex="-1"></a><span class="co"># Convert to millions</span></span>
<span id="cb465-2"><a href="string-processing-and-text-mining.html#cb465-2" tabindex="-1"></a>population_vector <span class="ot">&lt;-</span> population_vector<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span></span>
<span id="cb465-3"><a href="string-processing-and-text-mining.html#cb465-3" tabindex="-1"></a></span>
<span id="cb465-4"><a href="string-processing-and-text-mining.html#cb465-4" tabindex="-1"></a><span class="co"># We remove the last value which is the world population:</span></span>
<span id="cb465-5"><a href="string-processing-and-text-mining.html#cb465-5" tabindex="-1"></a>length_val <span class="ot">&lt;-</span> <span class="fu">length</span>(population_vector)</span>
<span id="cb465-6"><a href="string-processing-and-text-mining.html#cb465-6" tabindex="-1"></a>population_vector <span class="ot">&lt;-</span> population_vector[<span class="sc">-</span>length_val]</span>
<span id="cb465-7"><a href="string-processing-and-text-mining.html#cb465-7" tabindex="-1"></a></span>
<span id="cb465-8"><a href="string-processing-and-text-mining.html#cb465-8" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb465-9"><a href="string-processing-and-text-mining.html#cb465-9" tabindex="-1"></a><span class="fu">boxplot</span>(population_vector)</span></code></pre></div>
<p>We already know which functions to use to transform the fields of our case. However, we have applied them to vectors. To mutate the columns of our table in raw form we will use the function <code>mutate(across(columns, function))</code> using the pipeline operator <code>|&gt;</code>. Let’s apply the first change of spaces by commas and not only to column 3, population, but also to column 5, medium change.</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="string-processing-and-text-mining.html#cb466-1" tabindex="-1"></a>raw_table <span class="sc">|&gt;</span> </span>
<span id="cb466-2"><a href="string-processing-and-text-mining.html#cb466-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>), <span class="sc">~</span><span class="fu">str_replace_all</span>(., <span class="st">&quot;</span><span class="sc">\\</span><span class="st">s&quot;</span>, <span class="st">&quot;,&quot;</span>)))</span></code></pre></div>
<p>We have removed from the <code>str_replace_all</code> function the <code>string</code> attribute and replaced it with a dot <code>.</code>. And that dot <code>.</code> indicates that it will evaluate for each column <code>c(3,5)</code> of our table.</p>
<p>Now, let’s apply the parse_number function that we applied previously.</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="string-processing-and-text-mining.html#cb467-1" tabindex="-1"></a>raw_table <span class="sc">|&gt;</span> </span>
<span id="cb467-2"><a href="string-processing-and-text-mining.html#cb467-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>), <span class="sc">~</span><span class="fu">str_replace_all</span>(., <span class="st">&quot;</span><span class="sc">\\</span><span class="st">s&quot;</span>, <span class="st">&quot;,&quot;</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb467-3"><a href="string-processing-and-text-mining.html#cb467-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>), <span class="sc">~</span><span class="fu">parse_number</span>(.)))</span></code></pre></div>
</div>
</div>
<div id="regular-expressions" class="section level2 hasAnchor" number="11.2">
<h2><span class="header-section-number">11.2</span> Regular expressions<a href="string-processing-and-text-mining.html#regular-expressions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A <a href="https://stringr.tidyverse.org/articles/regular-expressions.html">regular expression</a><a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a> (or regex as it is known in English) is a pattern that describes a set of strings. We have already used regex in the previous section using only the pattern <code>\\s</code>. However, usually we will have many more use cases that will require a pattern that can convert a wider range of cases.</p>
<p>Although we could analyze all possible use cases available in the documentation, we learn faster by use cases. Let’s analyze a case that will allow us to learn some patterns little by little.</p>
<p>In the <code>dslabs</code> library we found and used previously the height data, <code>heights</code>, of students from a university expressed in inches.</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="string-processing-and-text-mining.html#cb468-1" tabindex="-1"></a><span class="fu">library</span>(dslabs)</span>
<span id="cb468-2"><a href="string-processing-and-text-mining.html#cb468-2" tabindex="-1"></a><span class="fu">data</span>(heights)</span>
<span id="cb468-3"><a href="string-processing-and-text-mining.html#cb468-3" tabindex="-1"></a></span>
<span id="cb468-4"><a href="string-processing-and-text-mining.html#cb468-4" tabindex="-1"></a>heights <span class="sc">|&gt;</span> </span>
<span id="cb468-5"><a href="string-processing-and-text-mining.html#cb468-5" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb468-6"><a href="string-processing-and-text-mining.html#cb468-6" tabindex="-1"></a><span class="co">#&gt;       sex height</span></span>
<span id="cb468-7"><a href="string-processing-and-text-mining.html#cb468-7" tabindex="-1"></a><span class="co">#&gt; 1    Male     75</span></span>
<span id="cb468-8"><a href="string-processing-and-text-mining.html#cb468-8" tabindex="-1"></a><span class="co">#&gt; 2    Male     70</span></span>
<span id="cb468-9"><a href="string-processing-and-text-mining.html#cb468-9" tabindex="-1"></a><span class="co">#&gt; 3    Male     68</span></span>
<span id="cb468-10"><a href="string-processing-and-text-mining.html#cb468-10" tabindex="-1"></a><span class="co">#&gt; 4    Male     74</span></span>
<span id="cb468-11"><a href="string-processing-and-text-mining.html#cb468-11" tabindex="-1"></a><span class="co">#&gt; 5    Male     61</span></span>
<span id="cb468-12"><a href="string-processing-and-text-mining.html#cb468-12" tabindex="-1"></a><span class="co">#&gt; 6  Female     65</span></span>
<span id="cb468-13"><a href="string-processing-and-text-mining.html#cb468-13" tabindex="-1"></a><span class="co">#&gt; 7  Female     66</span></span>
<span id="cb468-14"><a href="string-processing-and-text-mining.html#cb468-14" tabindex="-1"></a><span class="co">#&gt; 8  Female     62</span></span>
<span id="cb468-15"><a href="string-processing-and-text-mining.html#cb468-15" tabindex="-1"></a><span class="co">#&gt; 9  Female     66</span></span>
<span id="cb468-16"><a href="string-processing-and-text-mining.html#cb468-16" tabindex="-1"></a><span class="co">#&gt; 10   Male     67</span></span></code></pre></div>
<p>These data were ready to be analyzed. However, that was not how it came from the source. The students had to fill out a survey and even when they were asked for their height in inches, they completed their height in inches, feet, centimeters, writing numbers, letters, etc. We can see the initial data from the form in the <code>reported_heights</code> data frame.</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="string-processing-and-text-mining.html#cb469-1" tabindex="-1"></a>reported_heights <span class="sc">|&gt;</span> </span>
<span id="cb469-2"><a href="string-processing-and-text-mining.html#cb469-2" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb469-3"><a href="string-processing-and-text-mining.html#cb469-3" tabindex="-1"></a><span class="co">#&gt;             time_stamp    sex height</span></span>
<span id="cb469-4"><a href="string-processing-and-text-mining.html#cb469-4" tabindex="-1"></a><span class="co">#&gt; 1  2014-09-02 13:40:36   Male     75</span></span>
<span id="cb469-5"><a href="string-processing-and-text-mining.html#cb469-5" tabindex="-1"></a><span class="co">#&gt; 2  2014-09-02 13:46:59   Male     70</span></span>
<span id="cb469-6"><a href="string-processing-and-text-mining.html#cb469-6" tabindex="-1"></a><span class="co">#&gt; 3  2014-09-02 13:59:20   Male     68</span></span>
<span id="cb469-7"><a href="string-processing-and-text-mining.html#cb469-7" tabindex="-1"></a><span class="co">#&gt; 4  2014-09-02 14:51:53   Male     74</span></span>
<span id="cb469-8"><a href="string-processing-and-text-mining.html#cb469-8" tabindex="-1"></a><span class="co">#&gt; 5  2014-09-02 15:16:15   Male     61</span></span>
<span id="cb469-9"><a href="string-processing-and-text-mining.html#cb469-9" tabindex="-1"></a><span class="co">#&gt; 6  2014-09-02 15:16:16 Female     65</span></span>
<span id="cb469-10"><a href="string-processing-and-text-mining.html#cb469-10" tabindex="-1"></a><span class="co">#&gt; 7  2014-09-02 15:16:19 Female     66</span></span>
<span id="cb469-11"><a href="string-processing-and-text-mining.html#cb469-11" tabindex="-1"></a><span class="co">#&gt; 8  2014-09-02 15:16:21 Female     62</span></span>
<span id="cb469-12"><a href="string-processing-and-text-mining.html#cb469-12" tabindex="-1"></a><span class="co">#&gt; 9  2014-09-02 15:16:21 Female     66</span></span>
<span id="cb469-13"><a href="string-processing-and-text-mining.html#cb469-13" tabindex="-1"></a><span class="co">#&gt; 10 2014-09-02 15:16:22   Male     67</span></span></code></pre></div>
<p>Although we might think that they entered the data correctly, we do not have to trust and it is always better to validate the quality of our data. There are multiple ways to validate, as we can see below:</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="string-processing-and-text-mining.html#cb470-1" tabindex="-1"></a>heights <span class="ot">&lt;-</span> reported_heights<span class="sc">$</span>height</span>
<span id="cb470-2"><a href="string-processing-and-text-mining.html#cb470-2" tabindex="-1"></a></span>
<span id="cb470-3"><a href="string-processing-and-text-mining.html#cb470-3" tabindex="-1"></a><span class="co"># Validation option 1: Random sample</span></span>
<span id="cb470-4"><a href="string-processing-and-text-mining.html#cb470-4" tabindex="-1"></a><span class="fu">sample</span>(heights, <span class="dv">100</span>)</span>
<span id="cb470-5"><a href="string-processing-and-text-mining.html#cb470-5" tabindex="-1"></a><span class="co">#&gt;   [1] &quot;5&#39; 11\&quot;&quot; &quot;170&quot;     &quot;72&quot;      &quot;72&quot;      &quot;71&quot;      &quot;70.8661&quot; &quot;5.57&quot;   </span></span>
<span id="cb470-6"><a href="string-processing-and-text-mining.html#cb470-6" tabindex="-1"></a><span class="co">#&gt;   [8] &quot;61&quot;      &quot;66&quot;      &quot;5&#39;10&#39;&#39;&quot;  &quot;70&quot;      &quot;74&quot;      &quot;73&quot;      &quot;175&quot;    </span></span>
<span id="cb470-7"><a href="string-processing-and-text-mining.html#cb470-7" tabindex="-1"></a><span class="co">#&gt;  [15] &quot;2&quot;       &quot;69&quot;      &quot;72&quot;      &quot;66&quot;      &quot;68&quot;      &quot;75&quot;      &quot;5.5&quot;    </span></span>
<span id="cb470-8"><a href="string-processing-and-text-mining.html#cb470-8" tabindex="-1"></a><span class="co">#&gt;  [22] &quot;0&quot;       &quot;71&quot;      &quot;69&quot;      &quot;67&quot;      &quot;73.22&quot;   &quot;5&#39;7.5&#39;&#39;&quot; &quot;68&quot;     </span></span>
<span id="cb470-9"><a href="string-processing-and-text-mining.html#cb470-9" tabindex="-1"></a><span class="co">#&gt;  [29] &quot;62&quot;      &quot;64&quot;      &quot;70&quot;      &quot;71&quot;      &quot;67&quot;      &quot;61&quot;      &quot;67&quot;     </span></span>
<span id="cb470-10"><a href="string-processing-and-text-mining.html#cb470-10" tabindex="-1"></a><span class="co">#&gt;  [36] &quot;163&quot;     &quot;69&quot;      &quot;5.11&quot;    &quot;6&quot;       &quot;77&quot;      &quot;68&quot;      &quot;5.51&quot;   </span></span>
<span id="cb470-11"><a href="string-processing-and-text-mining.html#cb470-11" tabindex="-1"></a><span class="co">#&gt;  [43] &quot;67&quot;      &quot;68&quot;      &quot;176&quot;     &quot;67&quot;      &quot;67&quot;      &quot;67&quot;      &quot;68&quot;     </span></span>
<span id="cb470-12"><a href="string-processing-and-text-mining.html#cb470-12" tabindex="-1"></a><span class="co">#&gt;  [50] &quot;60&quot;      &quot;70&quot;      &quot;158&quot;     &quot;73.2&quot;    &quot;65&quot;      &quot;168&quot;     &quot;66&quot;     </span></span>
<span id="cb470-13"><a href="string-processing-and-text-mining.html#cb470-13" tabindex="-1"></a><span class="co">#&gt;  [57] &quot;65&quot;      &quot;70&quot;      &quot;69&quot;      &quot;71&quot;      &quot;66&quot;      &quot;67.3&quot;    &quot;69&quot;     </span></span>
<span id="cb470-14"><a href="string-processing-and-text-mining.html#cb470-14" tabindex="-1"></a><span class="co">#&gt;  [64] &quot;66&quot;      &quot;66&quot;      &quot;70&quot;      &quot;70.5&quot;    &quot;70&quot;      &quot;69&quot;      &quot;74&quot;     </span></span>
<span id="cb470-15"><a href="string-processing-and-text-mining.html#cb470-15" tabindex="-1"></a><span class="co">#&gt;  [71] &quot;72&quot;      &quot;68&quot;      &quot;70&quot;      &quot;5,8&quot;     &quot;51&quot;      &quot;69&quot;      &quot;69&quot;     </span></span>
<span id="cb470-16"><a href="string-processing-and-text-mining.html#cb470-16" tabindex="-1"></a><span class="co">#&gt;  [78] &quot;65&quot;      &quot;69&quot;      &quot;180&quot;     &quot;68&quot;      &quot;67&quot;      &quot;68&quot;      &quot;68.4&quot;   </span></span>
<span id="cb470-17"><a href="string-processing-and-text-mining.html#cb470-17" tabindex="-1"></a><span class="co">#&gt;  [85] &quot;70.86&quot;   &quot;72.45&quot;   &quot;67&quot;      &quot;69&quot;      &quot;5.8&quot;     &quot;180&quot;     &quot;183&quot;    </span></span>
<span id="cb470-18"><a href="string-processing-and-text-mining.html#cb470-18" tabindex="-1"></a><span class="co">#&gt;  [92] &quot;180&quot;     &quot;167&quot;     &quot;175&quot;     &quot;74&quot;      &quot;68&quot;      &quot;72&quot;      &quot;67&quot;     </span></span>
<span id="cb470-19"><a href="string-processing-and-text-mining.html#cb470-19" tabindex="-1"></a><span class="co">#&gt;  [99] &quot;63&quot;      &quot;72.05&quot;</span></span>
<span id="cb470-20"><a href="string-processing-and-text-mining.html#cb470-20" tabindex="-1"></a></span>
<span id="cb470-21"><a href="string-processing-and-text-mining.html#cb470-21" tabindex="-1"></a><span class="co"># Validation option 2: convert to numbers and count if there are NAs</span></span>
<span id="cb470-22"><a href="string-processing-and-text-mining.html#cb470-22" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(heights)</span>
<span id="cb470-23"><a href="string-processing-and-text-mining.html#cb470-23" tabindex="-1"></a><span class="co">#&gt; Warning: NAs introduced by coercion</span></span>
<span id="cb470-24"><a href="string-processing-and-text-mining.html#cb470-24" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(x))</span>
<span id="cb470-25"><a href="string-processing-and-text-mining.html#cb470-25" tabindex="-1"></a><span class="co">#&gt; [1] 81</span></span>
<span id="cb470-26"><a href="string-processing-and-text-mining.html#cb470-26" tabindex="-1"></a></span>
<span id="cb470-27"><a href="string-processing-and-text-mining.html#cb470-27" tabindex="-1"></a><span class="co"># Validation option 3: add column of those that cannot be converted to number:</span></span>
<span id="cb470-28"><a href="string-processing-and-text-mining.html#cb470-28" tabindex="-1"></a>reported_heights <span class="sc">|&gt;</span> </span>
<span id="cb470-29"><a href="string-processing-and-text-mining.html#cb470-29" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estatuta_numero =</span> <span class="fu">as.numeric</span>(height)) <span class="sc">|&gt;</span> </span>
<span id="cb470-30"><a href="string-processing-and-text-mining.html#cb470-30" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(estatuta_numero)) <span class="sc">|&gt;</span> </span>
<span id="cb470-31"><a href="string-processing-and-text-mining.html#cb470-31" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb470-32"><a href="string-processing-and-text-mining.html#cb470-32" tabindex="-1"></a><span class="co">#&gt; Warning: There was 1 warning in `mutate()`.</span></span>
<span id="cb470-33"><a href="string-processing-and-text-mining.html#cb470-33" tabindex="-1"></a><span class="co">#&gt; ℹ In argument: `estatuta_numero = as.numeric(height)`.</span></span>
<span id="cb470-34"><a href="string-processing-and-text-mining.html#cb470-34" tabindex="-1"></a><span class="co">#&gt; Caused by warning:</span></span>
<span id="cb470-35"><a href="string-processing-and-text-mining.html#cb470-35" tabindex="-1"></a><span class="co">#&gt; ! NAs introduced by coercion</span></span>
<span id="cb470-36"><a href="string-processing-and-text-mining.html#cb470-36" tabindex="-1"></a><span class="co">#&gt;             time_stamp    sex                 height estatuta_numero</span></span>
<span id="cb470-37"><a href="string-processing-and-text-mining.html#cb470-37" tabindex="-1"></a><span class="co">#&gt; 1  2014-09-02 15:16:28   Male                  5&#39; 4&quot;              NA</span></span>
<span id="cb470-38"><a href="string-processing-and-text-mining.html#cb470-38" tabindex="-1"></a><span class="co">#&gt; 2  2014-09-02 15:16:37 Female                  165cm              NA</span></span>
<span id="cb470-39"><a href="string-processing-and-text-mining.html#cb470-39" tabindex="-1"></a><span class="co">#&gt; 3  2014-09-02 15:16:52   Male                    5&#39;7              NA</span></span>
<span id="cb470-40"><a href="string-processing-and-text-mining.html#cb470-40" tabindex="-1"></a><span class="co">#&gt; 4  2014-09-02 15:16:56   Male                  &gt;9000              NA</span></span>
<span id="cb470-41"><a href="string-processing-and-text-mining.html#cb470-41" tabindex="-1"></a><span class="co">#&gt; 5  2014-09-02 15:16:56   Male                   5&#39;7&quot;              NA</span></span>
<span id="cb470-42"><a href="string-processing-and-text-mining.html#cb470-42" tabindex="-1"></a><span class="co">#&gt; 6  2014-09-02 15:17:09 Female                   5&#39;3&quot;              NA</span></span>
<span id="cb470-43"><a href="string-processing-and-text-mining.html#cb470-43" tabindex="-1"></a><span class="co">#&gt; 7  2014-09-02 15:18:00   Male 5 feet and 8.11 inches              NA</span></span>
<span id="cb470-44"><a href="string-processing-and-text-mining.html#cb470-44" tabindex="-1"></a><span class="co">#&gt; 8  2014-09-02 15:19:48   Male                   5&#39;11              NA</span></span>
<span id="cb470-45"><a href="string-processing-and-text-mining.html#cb470-45" tabindex="-1"></a><span class="co">#&gt; 9  2014-09-04 00:46:45   Male                  5&#39;9&#39;&#39;              NA</span></span>
<span id="cb470-46"><a href="string-processing-and-text-mining.html#cb470-46" tabindex="-1"></a><span class="co">#&gt; 10 2014-09-04 10:29:44   Male                 5&#39;10&#39;&#39;              NA</span></span></code></pre></div>
<p>We might want to choose to eliminate these NA data as they are not significant with respect to the total of 1,095 data points. However, there are several of these data points that follow a determined pattern and instead of being discarded could be converted to the scale we have in the rest of the data. For example, there are people who entered their height as 5’7”, which, for those who remember the conversion, can be converted because 1 foot is 12 inches. So <span class="math inline">\(5*12+7=67\)</span>. And so, like that case, we can detect patterns, but we have, again, to be careful in detecting the exact pattern and not a very generic one that can change other use cases. If everyone followed the same pattern <span class="math inline">\(x&#39;y&#39;&#39;\)</span> or <span class="math inline">\(x&#39;y\)</span> it would be much easier to convert it to inches by calculating <span class="math inline">\(x*12+y\)</span>.</p>
<p>Let’s start by extracting our column to a single character vector with all the values that do not convert automatically to number or were entered in inches. We detect this if they measure more than 5 and up to 7 feet (from 1.5m to 2.1 meters). After that we will create the transformations little by little.</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="string-processing-and-text-mining.html#cb471-1" tabindex="-1"></a>heights_error <span class="ot">&lt;-</span> reported_heights <span class="sc">|&gt;</span> </span>
<span id="cb471-2"><a href="string-processing-and-text-mining.html#cb471-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(<span class="fu">as.numeric</span>(height)) <span class="sc">|</span> <span class="co"># Does not convert to number</span></span>
<span id="cb471-3"><a href="string-processing-and-text-mining.html#cb471-3" tabindex="-1"></a>         (<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">as.numeric</span>(height)) <span class="sc">&amp;</span> <span class="fu">as.numeric</span>(height) <span class="sc">&gt;=</span> <span class="dv">5</span> <span class="sc">&amp;</span></span>
<span id="cb471-4"><a href="string-processing-and-text-mining.html#cb471-4" tabindex="-1"></a>            <span class="fu">as.numeric</span>(height) <span class="sc">&lt;=</span> <span class="dv">7</span> ) <span class="co"># or entered in feet and not inches</span></span>
<span id="cb471-5"><a href="string-processing-and-text-mining.html#cb471-5" tabindex="-1"></a>        ) <span class="sc">|&gt;</span> </span>
<span id="cb471-6"><a href="string-processing-and-text-mining.html#cb471-6" tabindex="-1"></a>  <span class="fu">pull</span>(height)</span>
<span id="cb471-7"><a href="string-processing-and-text-mining.html#cb471-7" tabindex="-1"></a></span>
<span id="cb471-8"><a href="string-processing-and-text-mining.html#cb471-8" tabindex="-1"></a><span class="fu">length</span>(heights_error)</span>
<span id="cb471-9"><a href="string-processing-and-text-mining.html#cb471-9" tabindex="-1"></a><span class="co">#&gt; [1] 168</span></span></code></pre></div>
<p>Adding the condition of having entered in feet we have 168 errors. We cannot ignore 15.3% of errors.</p>
<p>We will use the <code>str_detect(string, pattern)</code> function that will allow us to detect if a string matches a certain pattern. The result will be a logical value: <code>TRUE</code> or <code>FALSE</code> that we can use as an index to obtain the values that match in our vector.</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="string-processing-and-text-mining.html#cb472-1" tabindex="-1"></a>indice <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(heights_error, <span class="st">&quot;feet&quot;</span>)</span>
<span id="cb472-2"><a href="string-processing-and-text-mining.html#cb472-2" tabindex="-1"></a></span>
<span id="cb472-3"><a href="string-processing-and-text-mining.html#cb472-3" tabindex="-1"></a>heights_error[indice] <span class="co"># Match the pattern</span></span>
<span id="cb472-4"><a href="string-processing-and-text-mining.html#cb472-4" tabindex="-1"></a><span class="co">#&gt; [1] &quot;5 feet and 8.11 inches&quot; &quot;5 feet 7inches&quot;         &quot;5 feet 6 inches&quot;</span></span>
<span id="cb472-5"><a href="string-processing-and-text-mining.html#cb472-5" tabindex="-1"></a>heights_error[<span class="sc">!</span>indice] <span class="sc">|&gt;</span> <span class="co"># Do not match the pattern</span></span>
<span id="cb472-6"><a href="string-processing-and-text-mining.html#cb472-6" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">40</span>) </span>
<span id="cb472-7"><a href="string-processing-and-text-mining.html#cb472-7" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;6&quot;                      &quot;5&#39; 4\&quot;&quot;                 &quot;5.3&quot;                   </span></span>
<span id="cb472-8"><a href="string-processing-and-text-mining.html#cb472-8" tabindex="-1"></a><span class="co">#&gt;  [4] &quot;165cm&quot;                  &quot;6&quot;                      &quot;5&#39;7&quot;                   </span></span>
<span id="cb472-9"><a href="string-processing-and-text-mining.html#cb472-9" tabindex="-1"></a><span class="co">#&gt;  [7] &quot;&gt;9000&quot;                  &quot;5&#39;7\&quot;&quot;                  &quot;5&#39;3\&quot;&quot;                 </span></span>
<span id="cb472-10"><a href="string-processing-and-text-mining.html#cb472-10" tabindex="-1"></a><span class="co">#&gt; [10] &quot;5.25&quot;                   &quot;5&#39;11&quot;                   &quot;5.5&quot;                   </span></span>
<span id="cb472-11"><a href="string-processing-and-text-mining.html#cb472-11" tabindex="-1"></a><span class="co">#&gt; [13] &quot;5&#39;9&#39;&#39;&quot;                  &quot;6&quot;                      &quot;6.5&quot;                   </span></span>
<span id="cb472-12"><a href="string-processing-and-text-mining.html#cb472-12" tabindex="-1"></a><span class="co">#&gt; [16] &quot;5&#39;10&#39;&#39;&quot;                 &quot;5.8&quot;                    &quot;5&quot;                     </span></span>
<span id="cb472-13"><a href="string-processing-and-text-mining.html#cb472-13" tabindex="-1"></a><span class="co">#&gt; [19] &quot;5.6&quot;                    &quot;5,3&quot;                    &quot;6&#39;&quot;                    </span></span>
<span id="cb472-14"><a href="string-processing-and-text-mining.html#cb472-14" tabindex="-1"></a><span class="co">#&gt; [22] &quot;6&quot;                      &quot;5.9&quot;                    &quot;6,8&quot;                   </span></span>
<span id="cb472-15"><a href="string-processing-and-text-mining.html#cb472-15" tabindex="-1"></a><span class="co">#&gt; [25] &quot;5&#39; 10&quot;                  &quot;5.5&quot;                    &quot;6.2&quot;                   </span></span>
<span id="cb472-16"><a href="string-processing-and-text-mining.html#cb472-16" tabindex="-1"></a><span class="co">#&gt; [28] &quot;Five foot eight inches&quot; &quot;6.2&quot;                    &quot;5.8&quot;                   </span></span>
<span id="cb472-17"><a href="string-processing-and-text-mining.html#cb472-17" tabindex="-1"></a><span class="co">#&gt; [31] &quot;5.1&quot;                    &quot;5.11&quot;                   &quot;5&#39;5\&quot;&quot;                 </span></span>
<span id="cb472-18"><a href="string-processing-and-text-mining.html#cb472-18" tabindex="-1"></a><span class="co">#&gt; [34] &quot;5&#39;2\&quot;&quot;                  &quot;5.75&quot;                   &quot;5,4&quot;                   </span></span>
<span id="cb472-19"><a href="string-processing-and-text-mining.html#cb472-19" tabindex="-1"></a><span class="co">#&gt; [37] &quot;7&quot;                      &quot;5.4&quot;                    &quot;6.1&quot;                   </span></span>
<span id="cb472-20"><a href="string-processing-and-text-mining.html#cb472-20" tabindex="-1"></a><span class="co">#&gt; [40] &quot;5&#39;3&quot;</span></span></code></pre></div>
<div id="alternation" class="section level3 hasAnchor" number="11.2.1">
<h3><span class="header-section-number">11.2.1</span> Alternation<a href="string-processing-and-text-mining.html#alternation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>|</code> is the alternation operator that will choose between one or more possible values. In our case, we have indicated to detect if there is the word “feet”, but we also have “ft” and “foot” to refer to the same thing in our data. Thus, we can create the pattern “feet” or “ft” or “foot”.</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="string-processing-and-text-mining.html#cb473-1" tabindex="-1"></a>indice <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(heights_error, <span class="st">&quot;feet|ft|foot&quot;</span>)</span>
<span id="cb473-2"><a href="string-processing-and-text-mining.html#cb473-2" tabindex="-1"></a></span>
<span id="cb473-3"><a href="string-processing-and-text-mining.html#cb473-3" tabindex="-1"></a>heights_error[indice] <span class="co"># Match</span></span>
<span id="cb473-4"><a href="string-processing-and-text-mining.html#cb473-4" tabindex="-1"></a><span class="co">#&gt; [1] &quot;5 feet and 8.11 inches&quot; &quot;Five foot eight inches&quot; &quot;5 feet 7inches&quot;        </span></span>
<span id="cb473-5"><a href="string-processing-and-text-mining.html#cb473-5" tabindex="-1"></a><span class="co">#&gt; [4] &quot;5ft 9 inches&quot;           &quot;5 ft 9 inches&quot;          &quot;5 feet 6 inches&quot;</span></span></code></pre></div>
<p>In the same way we can find the variations for inches and other symbols that we can remove:</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="string-processing-and-text-mining.html#cb474-1" tabindex="-1"></a>indice <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(heights_error, <span class="st">&quot;inches|in|&#39;&#39;|</span><span class="sc">\&quot;</span><span class="st">|cm|and&quot;</span>)</span>
<span id="cb474-2"><a href="string-processing-and-text-mining.html#cb474-2" tabindex="-1"></a></span>
<span id="cb474-3"><a href="string-processing-and-text-mining.html#cb474-3" tabindex="-1"></a>heights_error[indice] <span class="co"># Match</span></span>
<span id="cb474-4"><a href="string-processing-and-text-mining.html#cb474-4" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;5&#39; 4\&quot;&quot;                 &quot;165cm&quot;                  &quot;5&#39;7\&quot;&quot;                 </span></span>
<span id="cb474-5"><a href="string-processing-and-text-mining.html#cb474-5" tabindex="-1"></a><span class="co">#&gt;  [4] &quot;5&#39;3\&quot;&quot;                  &quot;5 feet and 8.11 inches&quot; &quot;5&#39;9&#39;&#39;&quot;                 </span></span>
<span id="cb474-6"><a href="string-processing-and-text-mining.html#cb474-6" tabindex="-1"></a><span class="co">#&gt;  [7] &quot;5&#39;10&#39;&#39;&quot;                 &quot;Five foot eight inches&quot; &quot;5&#39;5\&quot;&quot;                 </span></span>
<span id="cb474-7"><a href="string-processing-and-text-mining.html#cb474-7" tabindex="-1"></a><span class="co">#&gt; [10] &quot;5&#39;2\&quot;&quot;                  &quot;5&#39;10&#39;&#39;&quot;                 &quot;5&#39;3&#39;&#39;&quot;                 </span></span>
<span id="cb474-8"><a href="string-processing-and-text-mining.html#cb474-8" tabindex="-1"></a><span class="co">#&gt; [13] &quot;5&#39;7&#39;&#39;&quot;                  &quot;5&#39;3\&quot;&quot;                  &quot;5&#39;6&#39;&#39;&quot;                 </span></span>
<span id="cb474-9"><a href="string-processing-and-text-mining.html#cb474-9" tabindex="-1"></a><span class="co">#&gt; [16] &quot;5&#39;7.5&#39;&#39;&quot;                &quot;5&#39;7.5&#39;&#39;&quot;                &quot;5&#39;2\&quot;&quot;                 </span></span>
<span id="cb474-10"><a href="string-processing-and-text-mining.html#cb474-10" tabindex="-1"></a><span class="co">#&gt; [19] &quot;5&#39; 7.78\&quot;&quot;              &quot;5 feet 7inches&quot;         &quot;5&#39;8\&quot;&quot;                 </span></span>
<span id="cb474-11"><a href="string-processing-and-text-mining.html#cb474-11" tabindex="-1"></a><span class="co">#&gt; [22] &quot;5&#39;11\&quot;&quot;                 &quot;5&#39;7\&quot;&quot;                  &quot;5&#39; 11\&quot;&quot;               </span></span>
<span id="cb474-12"><a href="string-processing-and-text-mining.html#cb474-12" tabindex="-1"></a><span class="co">#&gt; [25] &quot;6&#39;1\&quot;&quot;                  &quot;69\&quot;&quot;                   &quot;5&#39; 7\&quot;&quot;                </span></span>
<span id="cb474-13"><a href="string-processing-and-text-mining.html#cb474-13" tabindex="-1"></a><span class="co">#&gt; [28] &quot;5&#39;10&#39;&#39;&quot;                 &quot;5ft 9 inches&quot;           &quot;5 ft 9 inches&quot;         </span></span>
<span id="cb474-14"><a href="string-processing-and-text-mining.html#cb474-14" tabindex="-1"></a><span class="co">#&gt; [31] &quot;5&#39;11&#39;&#39;&quot;                 &quot;5&#39;8\&quot;&quot;                  &quot;5 feet 6 inches&quot;       </span></span>
<span id="cb474-15"><a href="string-processing-and-text-mining.html#cb474-15" tabindex="-1"></a><span class="co">#&gt; [34] &quot;5&#39;10&#39;&#39;&quot;                 &quot;6&#39;3\&quot;&quot;                  &quot;5&#39;5&#39;&#39;&quot;                 </span></span>
<span id="cb474-16"><a href="string-processing-and-text-mining.html#cb474-16" tabindex="-1"></a><span class="co">#&gt; [37] &quot;5&#39;7\&quot;&quot;                  &quot;6&#39;4\&quot;&quot;                  &quot;170 cm&quot;</span></span></code></pre></div>
<p>In this case we have entered <code>''</code> to detect those who entered that symbol to denote inches and <code>\"</code> in case they used double quotes. In this latter case we have used <code>\</code> so that it does not generate an error when interpreting as closing the string.</p>
<p>We could already start replacing based on the detected patterns:</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="string-processing-and-text-mining.html#cb475-1" tabindex="-1"></a>heights_error <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(heights_error, <span class="st">&quot;feet|ft|foot&quot;</span>, <span class="st">&quot;&#39;&quot;</span>)</span>
<span id="cb475-2"><a href="string-processing-and-text-mining.html#cb475-2" tabindex="-1"></a>heights_error <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(heights_error, <span class="st">&quot;inches|in|&#39;&#39;|</span><span class="sc">\&quot;</span><span class="st">|cm|and&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb475-3"><a href="string-processing-and-text-mining.html#cb475-3" tabindex="-1"></a></span>
<span id="cb475-4"><a href="string-processing-and-text-mining.html#cb475-4" tabindex="-1"></a>heights_error <span class="sc">|&gt;</span> </span>
<span id="cb475-5"><a href="string-processing-and-text-mining.html#cb475-5" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">30</span>)</span>
<span id="cb475-6"><a href="string-processing-and-text-mining.html#cb475-6" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;6&quot;             &quot;5&#39; 4&quot;          &quot;5.3&quot;           &quot;165&quot;          </span></span>
<span id="cb475-7"><a href="string-processing-and-text-mining.html#cb475-7" tabindex="-1"></a><span class="co">#&gt;  [5] &quot;6&quot;             &quot;5&#39;7&quot;           &quot;&gt;9000&quot;         &quot;5&#39;7&quot;          </span></span>
<span id="cb475-8"><a href="string-processing-and-text-mining.html#cb475-8" tabindex="-1"></a><span class="co">#&gt;  [9] &quot;5&#39;3&quot;           &quot;5 &#39;  8.11 &quot;    &quot;5.25&quot;          &quot;5&#39;11&quot;         </span></span>
<span id="cb475-9"><a href="string-processing-and-text-mining.html#cb475-9" tabindex="-1"></a><span class="co">#&gt; [13] &quot;5.5&quot;           &quot;5&#39;9&quot;           &quot;6&quot;             &quot;6.5&quot;          </span></span>
<span id="cb475-10"><a href="string-processing-and-text-mining.html#cb475-10" tabindex="-1"></a><span class="co">#&gt; [17] &quot;5&#39;10&quot;          &quot;5.8&quot;           &quot;5&quot;             &quot;5.6&quot;          </span></span>
<span id="cb475-11"><a href="string-processing-and-text-mining.html#cb475-11" tabindex="-1"></a><span class="co">#&gt; [21] &quot;5,3&quot;           &quot;6&#39;&quot;            &quot;6&quot;             &quot;5.9&quot;          </span></span>
<span id="cb475-12"><a href="string-processing-and-text-mining.html#cb475-12" tabindex="-1"></a><span class="co">#&gt; [25] &quot;6,8&quot;           &quot;5&#39; 10&quot;         &quot;5.5&quot;           &quot;6.2&quot;          </span></span>
<span id="cb475-13"><a href="string-processing-and-text-mining.html#cb475-13" tabindex="-1"></a><span class="co">#&gt; [29] &quot;Five &#39; eight &quot; &quot;6.2&quot;</span></span></code></pre></div>
<p>As an additional effort, we could also look to solve that some people have written words instead of numbers. For this we create a function that replaces each word with a number and apply it to the vector:</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="string-processing-and-text-mining.html#cb476-1" tabindex="-1"></a>words_to_number <span class="ot">&lt;-</span> <span class="cf">function</span>(s){</span>
<span id="cb476-2"><a href="string-processing-and-text-mining.html#cb476-2" tabindex="-1"></a>  <span class="fu">str_to_lower</span>(s) <span class="sc">|&gt;</span>  </span>
<span id="cb476-3"><a href="string-processing-and-text-mining.html#cb476-3" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">&quot;zero&quot;</span>, <span class="st">&quot;0&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb476-4"><a href="string-processing-and-text-mining.html#cb476-4" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">&quot;one&quot;</span>, <span class="st">&quot;1&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb476-5"><a href="string-processing-and-text-mining.html#cb476-5" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">&quot;two&quot;</span>, <span class="st">&quot;2&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb476-6"><a href="string-processing-and-text-mining.html#cb476-6" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">&quot;three&quot;</span>, <span class="st">&quot;3&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb476-7"><a href="string-processing-and-text-mining.html#cb476-7" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">&quot;four&quot;</span>, <span class="st">&quot;4&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb476-8"><a href="string-processing-and-text-mining.html#cb476-8" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">&quot;five&quot;</span>, <span class="st">&quot;5&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb476-9"><a href="string-processing-and-text-mining.html#cb476-9" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">&quot;six&quot;</span>, <span class="st">&quot;6&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb476-10"><a href="string-processing-and-text-mining.html#cb476-10" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">&quot;seven&quot;</span>, <span class="st">&quot;7&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb476-11"><a href="string-processing-and-text-mining.html#cb476-11" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">&quot;eight&quot;</span>, <span class="st">&quot;8&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb476-12"><a href="string-processing-and-text-mining.html#cb476-12" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">&quot;nine&quot;</span>, <span class="st">&quot;9&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb476-13"><a href="string-processing-and-text-mining.html#cb476-13" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">&quot;ten&quot;</span>, <span class="st">&quot;10&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb476-14"><a href="string-processing-and-text-mining.html#cb476-14" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">&quot;eleven&quot;</span>, <span class="st">&quot;11&quot;</span>)</span>
<span id="cb476-15"><a href="string-processing-and-text-mining.html#cb476-15" tabindex="-1"></a>}</span>
<span id="cb476-16"><a href="string-processing-and-text-mining.html#cb476-16" tabindex="-1"></a></span>
<span id="cb476-17"><a href="string-processing-and-text-mining.html#cb476-17" tabindex="-1"></a>heights_error <span class="ot">&lt;-</span> <span class="fu">words_to_number</span>(heights_error)</span>
<span id="cb476-18"><a href="string-processing-and-text-mining.html#cb476-18" tabindex="-1"></a>heights_error <span class="sc">|&gt;</span> </span>
<span id="cb476-19"><a href="string-processing-and-text-mining.html#cb476-19" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">30</span>)</span>
<span id="cb476-20"><a href="string-processing-and-text-mining.html#cb476-20" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;6&quot;          &quot;5&#39; 4&quot;       &quot;5.3&quot;        &quot;165&quot;        &quot;6&quot;         </span></span>
<span id="cb476-21"><a href="string-processing-and-text-mining.html#cb476-21" tabindex="-1"></a><span class="co">#&gt;  [6] &quot;5&#39;7&quot;        &quot;&gt;9000&quot;      &quot;5&#39;7&quot;        &quot;5&#39;3&quot;        &quot;5 &#39;  8.11 &quot;</span></span>
<span id="cb476-22"><a href="string-processing-and-text-mining.html#cb476-22" tabindex="-1"></a><span class="co">#&gt; [11] &quot;5.25&quot;       &quot;5&#39;11&quot;       &quot;5.5&quot;        &quot;5&#39;9&quot;        &quot;6&quot;         </span></span>
<span id="cb476-23"><a href="string-processing-and-text-mining.html#cb476-23" tabindex="-1"></a><span class="co">#&gt; [16] &quot;6.5&quot;        &quot;5&#39;10&quot;       &quot;5.8&quot;        &quot;5&quot;          &quot;5.6&quot;       </span></span>
<span id="cb476-24"><a href="string-processing-and-text-mining.html#cb476-24" tabindex="-1"></a><span class="co">#&gt; [21] &quot;5,3&quot;        &quot;6&#39;&quot;         &quot;6&quot;          &quot;5.9&quot;        &quot;6,8&quot;       </span></span>
<span id="cb476-25"><a href="string-processing-and-text-mining.html#cb476-25" tabindex="-1"></a><span class="co">#&gt; [26] &quot;5&#39; 10&quot;      &quot;5.5&quot;        &quot;6.2&quot;        &quot;5 &#39; 8 &quot;     &quot;6.2&quot;</span></span></code></pre></div>
</div>
<div id="anchoring" class="section level3 hasAnchor" number="11.2.2">
<h3><span class="header-section-number">11.2.2</span> Anchoring<a href="string-processing-and-text-mining.html#anchoring" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that it is more standardized we can start with regex with more generic characteristics. For example, there is a person who has entered <code>6'</code>. It would be convenient to have everything in the form feet plus inches. With which we should have <code>6'0</code>. To achieve this we have to create a regex according to this generic situation. We will use the symbol <code>^</code> to anchor our validation to “start with” and the symbol <code>$</code> to match with the end of the string. Before replacing, let’s first see who matches.</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="string-processing-and-text-mining.html#cb477-1" tabindex="-1"></a>indice <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(heights_error, <span class="st">&quot;^6&#39;$&quot;</span>)</span>
<span id="cb477-2"><a href="string-processing-and-text-mining.html#cb477-2" tabindex="-1"></a></span>
<span id="cb477-3"><a href="string-processing-and-text-mining.html#cb477-3" tabindex="-1"></a>heights_error[indice] <span class="co"># Match</span></span>
<span id="cb477-4"><a href="string-processing-and-text-mining.html#cb477-4" tabindex="-1"></a><span class="co">#&gt; [1] &quot;6&#39;&quot;</span></span></code></pre></div>
<p>This regex indicates that it starts with <code>6'</code> and that the expression ends there. We could still make it more generic to address those who, in the future, write 5 inches (1.52m) or 6 inches (1.82m). For this we will use brackets and inside them we will put all the values that we will accept.</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="string-processing-and-text-mining.html#cb478-1" tabindex="-1"></a>indice <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(heights_error, <span class="st">&quot;^[56]&#39;$&quot;</span>)</span>
<span id="cb478-2"><a href="string-processing-and-text-mining.html#cb478-2" tabindex="-1"></a></span>
<span id="cb478-3"><a href="string-processing-and-text-mining.html#cb478-3" tabindex="-1"></a>heights_error[indice] <span class="co"># Match</span></span>
<span id="cb478-4"><a href="string-processing-and-text-mining.html#cb478-4" tabindex="-1"></a><span class="co">#&gt; [1] &quot;6&#39;&quot;</span></span></code></pre></div>
<p>There is still only one result, but our regex is more generic now and we can already use it to replace. Before replacing in our vector we are going to do a test to learn how to create what we need from a pattern.</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="string-processing-and-text-mining.html#cb479-1" tabindex="-1"></a>prueba <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;5&#39;&quot;</span>, <span class="st">&quot;6&#39;&quot;</span>)</span>
<span id="cb479-2"><a href="string-processing-and-text-mining.html#cb479-2" tabindex="-1"></a></span>
<span id="cb479-3"><a href="string-processing-and-text-mining.html#cb479-3" tabindex="-1"></a><span class="fu">str_replace_all</span>(prueba, <span class="st">&quot;^([56])&#39;$&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">1&#39;0&quot;</span>)</span>
<span id="cb479-4"><a href="string-processing-and-text-mining.html#cb479-4" tabindex="-1"></a><span class="co">#&gt; [1] &quot;5&#39;0&quot; &quot;6&#39;0&quot;</span></span></code></pre></div>
<p>We have placed between parentheses to indicate that what is inside is our first value and we use <code>\\1</code> to refer to that first value. So we are indicating to write the first value, then a quote <code>'</code>, and then a zero <code>0</code>.</p>
<p>Now we are ready to apply to our entire vector. We are going to make the change to consider not only 5 and 6, but up to the value of 7 inches (2.1m). Likewise, we are going to take the cases in which there is only a number without the foot symbol <code>'</code>.</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="string-processing-and-text-mining.html#cb480-1" tabindex="-1"></a>heights_error <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(heights_error, <span class="st">&quot;^([5-7])&#39;$&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">1&#39;0&quot;</span>)</span>
<span id="cb480-2"><a href="string-processing-and-text-mining.html#cb480-2" tabindex="-1"></a>heights_error <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(heights_error, <span class="st">&quot;^([5-7])$&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">1&#39;0&quot;</span>)</span>
<span id="cb480-3"><a href="string-processing-and-text-mining.html#cb480-3" tabindex="-1"></a></span>
<span id="cb480-4"><a href="string-processing-and-text-mining.html#cb480-4" tabindex="-1"></a>heights_error <span class="sc">|&gt;</span> </span>
<span id="cb480-5"><a href="string-processing-and-text-mining.html#cb480-5" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">30</span>)</span>
<span id="cb480-6"><a href="string-processing-and-text-mining.html#cb480-6" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;6&#39;0&quot;        &quot;5&#39; 4&quot;       &quot;5.3&quot;        &quot;165&quot;        &quot;6&#39;0&quot;       </span></span>
<span id="cb480-7"><a href="string-processing-and-text-mining.html#cb480-7" tabindex="-1"></a><span class="co">#&gt;  [6] &quot;5&#39;7&quot;        &quot;&gt;9000&quot;      &quot;5&#39;7&quot;        &quot;5&#39;3&quot;        &quot;5 &#39;  8.11 &quot;</span></span>
<span id="cb480-8"><a href="string-processing-and-text-mining.html#cb480-8" tabindex="-1"></a><span class="co">#&gt; [11] &quot;5.25&quot;       &quot;5&#39;11&quot;       &quot;5.5&quot;        &quot;5&#39;9&quot;        &quot;6&#39;0&quot;       </span></span>
<span id="cb480-9"><a href="string-processing-and-text-mining.html#cb480-9" tabindex="-1"></a><span class="co">#&gt; [16] &quot;6.5&quot;        &quot;5&#39;10&quot;       &quot;5.8&quot;        &quot;5&#39;0&quot;        &quot;5.6&quot;       </span></span>
<span id="cb480-10"><a href="string-processing-and-text-mining.html#cb480-10" tabindex="-1"></a><span class="co">#&gt; [21] &quot;5,3&quot;        &quot;6&#39;0&quot;        &quot;6&#39;0&quot;        &quot;5.9&quot;        &quot;6,8&quot;       </span></span>
<span id="cb480-11"><a href="string-processing-and-text-mining.html#cb480-11" tabindex="-1"></a><span class="co">#&gt; [26] &quot;5&#39; 10&quot;      &quot;5.5&quot;        &quot;6.2&quot;        &quot;5 &#39; 8 &quot;     &quot;6.2&quot;</span></span></code></pre></div>
</div>
<div id="repetitions" class="section level3 hasAnchor" number="11.2.3">
<h3><span class="header-section-number">11.2.3</span> Repetitions<a href="string-processing-and-text-mining.html#repetitions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can control how many times a pattern matches using repetition operators:</p>
<table>
<caption><span id="tab:date-format">TABLE 10.1: </span> Repetition operators:</caption>
<colgroup>
<col width="16%" />
<col width="83%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Operator</th>
<th align="left">Number of times</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>?</code></td>
<td align="left">0 or 1 time</td>
</tr>
<tr class="even">
<td align="left"><code>+</code></td>
<td align="left">1 or more times</td>
</tr>
<tr class="odd">
<td align="left"><code>*</code></td>
<td align="left">0 or more times</td>
</tr>
</tbody>
</table>
<p>For example, to find all cases where instead of using the foot symbol <code>'</code> they entered a comma, a period, or a space we will use the following pattern:</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="string-processing-and-text-mining.html#cb481-1" tabindex="-1"></a>pattern <span class="ot">&lt;-</span> <span class="st">&quot;^([4-7])</span><span class="sc">\\</span><span class="st">s*[,</span><span class="sc">\\</span><span class="st">.]</span><span class="sc">\\</span><span class="st">s*(</span><span class="sc">\\</span><span class="st">d*)$&quot;</span></span></code></pre></div>
<p>Let’s read the pattern:</p>
<ol style="list-style-type: decimal">
<li>The string starts with a digit ranging from 4 to 7.</li>
<li><code>\\s</code> means that it is followed by a white space, but we use <code>*</code> to indicate that this character appears 0 or more times.</li>
<li>After that space we will look for any of the following characters: <code>,</code>, a period <code>\\.</code> (to which we put double backslash because the period alone in a pattern means “any value”).</li>
<li>We use <code>\\s*</code> again to look for zero or more white spaces.</li>
<li>Finally we indicate that the string ends there with a digit, to denote that look for any digit we use <code>\\d</code>, d for digit. And we add asterisk so that it keeps one or more digits that it finds.</li>
</ol>
<p>In summary: it starts with a number, then symbols and then a digit. Between the symbols there could be white spaces. That is our pattern.</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="string-processing-and-text-mining.html#cb482-1" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(heights_error, <span class="st">&quot;^([4-7])</span><span class="sc">\\</span><span class="st">s*[,</span><span class="sc">\\</span><span class="st">.]</span><span class="sc">\\</span><span class="st">s*(</span><span class="sc">\\</span><span class="st">d*)$&quot;</span>)</span>
<span id="cb482-2"><a href="string-processing-and-text-mining.html#cb482-2" tabindex="-1"></a></span>
<span id="cb482-3"><a href="string-processing-and-text-mining.html#cb482-3" tabindex="-1"></a>heights_error[index] <span class="co"># Match</span></span>
<span id="cb482-4"><a href="string-processing-and-text-mining.html#cb482-4" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;5.3&quot;   &quot;5.25&quot;  &quot;5.5&quot;   &quot;6.5&quot;   &quot;5.8&quot;   &quot;5.6&quot;   &quot;5,3&quot;   &quot;5.9&quot;   &quot;6,8&quot;  </span></span>
<span id="cb482-5"><a href="string-processing-and-text-mining.html#cb482-5" tabindex="-1"></a><span class="co">#&gt; [10] &quot;5.5&quot;   &quot;6.2&quot;   &quot;6.2&quot;   &quot;5.8&quot;   &quot;5.1&quot;   &quot;5.11&quot;  &quot;5.75&quot;  &quot;5,4&quot;   &quot;5.4&quot;  </span></span>
<span id="cb482-6"><a href="string-processing-and-text-mining.html#cb482-6" tabindex="-1"></a><span class="co">#&gt; [19] &quot;6.1&quot;   &quot;5.6&quot;   &quot;5.6&quot;   &quot;5.4&quot;   &quot;5.9&quot;   &quot;5.6&quot;   &quot;5.6&quot;   &quot;5.5&quot;   &quot;5.2&quot;  </span></span>
<span id="cb482-7"><a href="string-processing-and-text-mining.html#cb482-7" tabindex="-1"></a><span class="co">#&gt; [28] &quot;5.5&quot;   &quot;5.5&quot;   &quot;6.5&quot;   &quot;5,8&quot;   &quot;5.11&quot;  &quot;5.5&quot;   &quot;6.7&quot;   &quot;5.1&quot;   &quot;5.6&quot;  </span></span>
<span id="cb482-8"><a href="string-processing-and-text-mining.html#cb482-8" tabindex="-1"></a><span class="co">#&gt; [37] &quot;5.5&quot;   &quot;5.2&quot;   &quot;5.6&quot;   &quot;5.7&quot;   &quot;5.9&quot;   &quot;6.5&quot;   &quot;5.11&quot;  &quot;5 .11&quot; &quot;5.7&quot;  </span></span>
<span id="cb482-9"><a href="string-processing-and-text-mining.html#cb482-9" tabindex="-1"></a><span class="co">#&gt; [46] &quot;5.5&quot;   &quot;5.8&quot;   &quot;5.8&quot;   &quot;5.1&quot;   &quot;5.11&quot;  &quot;5.7&quot;   &quot;5.9&quot;   &quot;5.2&quot;   &quot;5.5&quot;  </span></span>
<span id="cb482-10"><a href="string-processing-and-text-mining.html#cb482-10" tabindex="-1"></a><span class="co">#&gt; [55] &quot;5.51&quot;  &quot;5.8&quot;   &quot;5.7&quot;   &quot;6.1&quot;   &quot;5.69&quot;  &quot;5.7&quot;   &quot;5.25&quot;  &quot;5.5&quot;   &quot;5.1&quot;  </span></span>
<span id="cb482-11"><a href="string-processing-and-text-mining.html#cb482-11" tabindex="-1"></a><span class="co">#&gt; [64] &quot;6.3&quot;   &quot;5.5&quot;   &quot;5.7&quot;   &quot;5.57&quot;  &quot;5.7&quot;</span></span></code></pre></div>
<p>We already found the values that match the pattern, so we are ready to replace.</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="string-processing-and-text-mining.html#cb483-1" tabindex="-1"></a>heights_error <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(</span>
<span id="cb483-2"><a href="string-processing-and-text-mining.html#cb483-2" tabindex="-1"></a>                        heights_error, </span>
<span id="cb483-3"><a href="string-processing-and-text-mining.html#cb483-3" tabindex="-1"></a>                        <span class="st">&quot;^([4-7])</span><span class="sc">\\</span><span class="st">s*[,</span><span class="sc">\\</span><span class="st">.]</span><span class="sc">\\</span><span class="st">s*(</span><span class="sc">\\</span><span class="st">d*)$&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">1.</span><span class="sc">\\</span><span class="st">2&#39;0&quot;</span></span>
<span id="cb483-4"><a href="string-processing-and-text-mining.html#cb483-4" tabindex="-1"></a>                   )</span>
<span id="cb483-5"><a href="string-processing-and-text-mining.html#cb483-5" tabindex="-1"></a></span>
<span id="cb483-6"><a href="string-processing-and-text-mining.html#cb483-6" tabindex="-1"></a>heights_error <span class="sc">|&gt;</span> </span>
<span id="cb483-7"><a href="string-processing-and-text-mining.html#cb483-7" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">30</span>)</span>
<span id="cb483-8"><a href="string-processing-and-text-mining.html#cb483-8" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;6&#39;0&quot;        &quot;5&#39; 4&quot;       &quot;5.3&#39;0&quot;      &quot;165&quot;        &quot;6&#39;0&quot;       </span></span>
<span id="cb483-9"><a href="string-processing-and-text-mining.html#cb483-9" tabindex="-1"></a><span class="co">#&gt;  [6] &quot;5&#39;7&quot;        &quot;&gt;9000&quot;      &quot;5&#39;7&quot;        &quot;5&#39;3&quot;        &quot;5 &#39;  8.11 &quot;</span></span>
<span id="cb483-10"><a href="string-processing-and-text-mining.html#cb483-10" tabindex="-1"></a><span class="co">#&gt; [11] &quot;5.25&#39;0&quot;     &quot;5&#39;11&quot;       &quot;5.5&#39;0&quot;      &quot;5&#39;9&quot;        &quot;6&#39;0&quot;       </span></span>
<span id="cb483-11"><a href="string-processing-and-text-mining.html#cb483-11" tabindex="-1"></a><span class="co">#&gt; [16] &quot;6.5&#39;0&quot;      &quot;5&#39;10&quot;       &quot;5.8&#39;0&quot;      &quot;5&#39;0&quot;        &quot;5.6&#39;0&quot;     </span></span>
<span id="cb483-12"><a href="string-processing-and-text-mining.html#cb483-12" tabindex="-1"></a><span class="co">#&gt; [21] &quot;5.3&#39;0&quot;      &quot;6&#39;0&quot;        &quot;6&#39;0&quot;        &quot;5.9&#39;0&quot;      &quot;6.8&#39;0&quot;     </span></span>
<span id="cb483-13"><a href="string-processing-and-text-mining.html#cb483-13" tabindex="-1"></a><span class="co">#&gt; [26] &quot;5&#39; 10&quot;      &quot;5.5&#39;0&quot;      &quot;6.2&#39;0&quot;      &quot;5 &#39; 8 &quot;     &quot;6.2&#39;0&quot;</span></span></code></pre></div>
<p>Another pattern we see now is when before or after the foot symbol <code>'</code> there is a white space. Let’s make the change with what we learned and include cases where there are decimals:</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="string-processing-and-text-mining.html#cb484-1" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(heights_error, </span>
<span id="cb484-2"><a href="string-processing-and-text-mining.html#cb484-2" tabindex="-1"></a>                     <span class="st">&quot;^([4-7]</span><span class="sc">\\</span><span class="st">.?</span><span class="sc">\\</span><span class="st">d*)</span><span class="sc">\\</span><span class="st">s*&#39;</span><span class="sc">\\</span><span class="st">s*(</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">.?</span><span class="sc">\\</span><span class="st">d*)</span><span class="sc">\\</span><span class="st">s*$&quot;</span>)</span>
<span id="cb484-3"><a href="string-processing-and-text-mining.html#cb484-3" tabindex="-1"></a></span>
<span id="cb484-4"><a href="string-processing-and-text-mining.html#cb484-4" tabindex="-1"></a>heights_error[index] <span class="sc">|&gt;</span> <span class="co"># Match</span></span>
<span id="cb484-5"><a href="string-processing-and-text-mining.html#cb484-5" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">30</span>)</span>
<span id="cb484-6"><a href="string-processing-and-text-mining.html#cb484-6" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;6&#39;0&quot;        &quot;5&#39; 4&quot;       &quot;5.3&#39;0&quot;      &quot;6&#39;0&quot;        &quot;5&#39;7&quot;       </span></span>
<span id="cb484-7"><a href="string-processing-and-text-mining.html#cb484-7" tabindex="-1"></a><span class="co">#&gt;  [6] &quot;5&#39;7&quot;        &quot;5&#39;3&quot;        &quot;5 &#39;  8.11 &quot; &quot;5.25&#39;0&quot;     &quot;5&#39;11&quot;      </span></span>
<span id="cb484-8"><a href="string-processing-and-text-mining.html#cb484-8" tabindex="-1"></a><span class="co">#&gt; [11] &quot;5.5&#39;0&quot;      &quot;5&#39;9&quot;        &quot;6&#39;0&quot;        &quot;6.5&#39;0&quot;      &quot;5&#39;10&quot;      </span></span>
<span id="cb484-9"><a href="string-processing-and-text-mining.html#cb484-9" tabindex="-1"></a><span class="co">#&gt; [16] &quot;5.8&#39;0&quot;      &quot;5&#39;0&quot;        &quot;5.6&#39;0&quot;      &quot;5.3&#39;0&quot;      &quot;6&#39;0&quot;       </span></span>
<span id="cb484-10"><a href="string-processing-and-text-mining.html#cb484-10" tabindex="-1"></a><span class="co">#&gt; [21] &quot;6&#39;0&quot;        &quot;5.9&#39;0&quot;      &quot;6.8&#39;0&quot;      &quot;5&#39; 10&quot;      &quot;5.5&#39;0&quot;     </span></span>
<span id="cb484-11"><a href="string-processing-and-text-mining.html#cb484-11" tabindex="-1"></a><span class="co">#&gt; [26] &quot;6.2&#39;0&quot;      &quot;5 &#39; 8 &quot;     &quot;6.2&#39;0&quot;      &quot;5.8&#39;0&quot;      &quot;5.1&#39;0&quot;</span></span>
<span id="cb484-12"><a href="string-processing-and-text-mining.html#cb484-12" tabindex="-1"></a></span>
<span id="cb484-13"><a href="string-processing-and-text-mining.html#cb484-13" tabindex="-1"></a>heights_error <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(</span>
<span id="cb484-14"><a href="string-processing-and-text-mining.html#cb484-14" tabindex="-1"></a>                      heights_error, </span>
<span id="cb484-15"><a href="string-processing-and-text-mining.html#cb484-15" tabindex="-1"></a>                      <span class="st">&quot;^([4-7]</span><span class="sc">\\</span><span class="st">.?</span><span class="sc">\\</span><span class="st">d*)</span><span class="sc">\\</span><span class="st">s*&#39;</span><span class="sc">\\</span><span class="st">s*(</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">.?</span><span class="sc">\\</span><span class="st">d*)</span><span class="sc">\\</span><span class="st">s*$&quot;</span>,</span>
<span id="cb484-16"><a href="string-processing-and-text-mining.html#cb484-16" tabindex="-1"></a>                      <span class="st">&quot;</span><span class="sc">\\</span><span class="st">1&#39;</span><span class="sc">\\</span><span class="st">2&quot;</span></span>
<span id="cb484-17"><a href="string-processing-and-text-mining.html#cb484-17" tabindex="-1"></a>                   )</span>
<span id="cb484-18"><a href="string-processing-and-text-mining.html#cb484-18" tabindex="-1"></a></span>
<span id="cb484-19"><a href="string-processing-and-text-mining.html#cb484-19" tabindex="-1"></a>heights_error <span class="sc">|&gt;</span> </span>
<span id="cb484-20"><a href="string-processing-and-text-mining.html#cb484-20" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">30</span>)</span>
<span id="cb484-21"><a href="string-processing-and-text-mining.html#cb484-21" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;6&#39;0&quot;    &quot;5&#39;4&quot;    &quot;5.3&#39;0&quot;  &quot;165&quot;    &quot;6&#39;0&quot;    &quot;5&#39;7&quot;    &quot;&gt;9000&quot;  &quot;5&#39;7&quot;   </span></span>
<span id="cb484-22"><a href="string-processing-and-text-mining.html#cb484-22" tabindex="-1"></a><span class="co">#&gt;  [9] &quot;5&#39;3&quot;    &quot;5&#39;8.11&quot; &quot;5.25&#39;0&quot; &quot;5&#39;11&quot;   &quot;5.5&#39;0&quot;  &quot;5&#39;9&quot;    &quot;6&#39;0&quot;    &quot;6.5&#39;0&quot; </span></span>
<span id="cb484-23"><a href="string-processing-and-text-mining.html#cb484-23" tabindex="-1"></a><span class="co">#&gt; [17] &quot;5&#39;10&quot;   &quot;5.8&#39;0&quot;  &quot;5&#39;0&quot;    &quot;5.6&#39;0&quot;  &quot;5.3&#39;0&quot;  &quot;6&#39;0&quot;    &quot;6&#39;0&quot;    &quot;5.9&#39;0&quot; </span></span>
<span id="cb484-24"><a href="string-processing-and-text-mining.html#cb484-24" tabindex="-1"></a><span class="co">#&gt; [25] &quot;6.8&#39;0&quot;  &quot;5&#39;10&quot;   &quot;5.5&#39;0&quot;  &quot;6.2&#39;0&quot;  &quot;5&#39;8&quot;    &quot;6.2&#39;0&quot;</span></span></code></pre></div>
<p>Likewise, we have the pattern in which they entered: feet + space + inches without any symbol. Let’s make the change with what we learned.</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="string-processing-and-text-mining.html#cb485-1" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(heights_error, <span class="st">&quot;^([4-7])</span><span class="sc">\\</span><span class="st">s+(</span><span class="sc">\\</span><span class="st">d*)</span><span class="sc">\\</span><span class="st">s*$&quot;</span>)</span>
<span id="cb485-2"><a href="string-processing-and-text-mining.html#cb485-2" tabindex="-1"></a></span>
<span id="cb485-3"><a href="string-processing-and-text-mining.html#cb485-3" tabindex="-1"></a>heights_error[index] <span class="co"># Match</span></span>
<span id="cb485-4"><a href="string-processing-and-text-mining.html#cb485-4" tabindex="-1"></a><span class="co">#&gt; [1] &quot;5 11&quot; &quot;6 04&quot;</span></span>
<span id="cb485-5"><a href="string-processing-and-text-mining.html#cb485-5" tabindex="-1"></a></span>
<span id="cb485-6"><a href="string-processing-and-text-mining.html#cb485-6" tabindex="-1"></a>heights_error <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(</span>
<span id="cb485-7"><a href="string-processing-and-text-mining.html#cb485-7" tabindex="-1"></a>                      heights_error, </span>
<span id="cb485-8"><a href="string-processing-and-text-mining.html#cb485-8" tabindex="-1"></a>                      <span class="st">&quot;^([4-7])</span><span class="sc">\\</span><span class="st">s+(</span><span class="sc">\\</span><span class="st">d*)</span><span class="sc">\\</span><span class="st">s*$&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">1&#39;</span><span class="sc">\\</span><span class="st">2&quot;</span></span>
<span id="cb485-9"><a href="string-processing-and-text-mining.html#cb485-9" tabindex="-1"></a>                   )</span>
<span id="cb485-10"><a href="string-processing-and-text-mining.html#cb485-10" tabindex="-1"></a></span>
<span id="cb485-11"><a href="string-processing-and-text-mining.html#cb485-11" tabindex="-1"></a>heights_error <span class="sc">|&gt;</span> </span>
<span id="cb485-12"><a href="string-processing-and-text-mining.html#cb485-12" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">30</span>)</span>
<span id="cb485-13"><a href="string-processing-and-text-mining.html#cb485-13" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;6&#39;0&quot;    &quot;5&#39;4&quot;    &quot;5.3&#39;0&quot;  &quot;165&quot;    &quot;6&#39;0&quot;    &quot;5&#39;7&quot;    &quot;&gt;9000&quot;  &quot;5&#39;7&quot;   </span></span>
<span id="cb485-14"><a href="string-processing-and-text-mining.html#cb485-14" tabindex="-1"></a><span class="co">#&gt;  [9] &quot;5&#39;3&quot;    &quot;5&#39;8.11&quot; &quot;5.25&#39;0&quot; &quot;5&#39;11&quot;   &quot;5.5&#39;0&quot;  &quot;5&#39;9&quot;    &quot;6&#39;0&quot;    &quot;6.5&#39;0&quot; </span></span>
<span id="cb485-15"><a href="string-processing-and-text-mining.html#cb485-15" tabindex="-1"></a><span class="co">#&gt; [17] &quot;5&#39;10&quot;   &quot;5.8&#39;0&quot;  &quot;5&#39;0&quot;    &quot;5.6&#39;0&quot;  &quot;5.3&#39;0&quot;  &quot;6&#39;0&quot;    &quot;6&#39;0&quot;    &quot;5.9&#39;0&quot; </span></span>
<span id="cb485-16"><a href="string-processing-and-text-mining.html#cb485-16" tabindex="-1"></a><span class="co">#&gt; [25] &quot;6.8&#39;0&quot;  &quot;5&#39;10&quot;   &quot;5.5&#39;0&quot;  &quot;6.2&#39;0&quot;  &quot;5&#39;8&quot;    &quot;6.2&#39;0&quot;</span></span></code></pre></div>
<p>We are ready to put all the patterns together and the power of patterns is that they can serve us for future exercises. Thus, we will create a function where we will place each change that we can verify to a string.</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="string-processing-and-text-mining.html#cb486-1" tabindex="-1"></a>format_errors <span class="ot">&lt;-</span> <span class="cf">function</span>(cadena){</span>
<span id="cb486-2"><a href="string-processing-and-text-mining.html#cb486-2" tabindex="-1"></a>  cadena <span class="sc">|&gt;</span> </span>
<span id="cb486-3"><a href="string-processing-and-text-mining.html#cb486-3" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">&quot;feet|ft|foot&quot;</span>, <span class="st">&quot;&#39;&quot;</span>) <span class="sc">|&gt;</span> <span class="co"># Change feet for &#39;</span></span>
<span id="cb486-4"><a href="string-processing-and-text-mining.html#cb486-4" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">&quot;inches|in|&#39;&#39;|</span><span class="sc">\&quot;</span><span class="st">|cm|and&quot;</span>, <span class="st">&quot;&quot;</span>) <span class="sc">|&gt;</span> <span class="co"># Remove symbols</span></span>
<span id="cb486-5"><a href="string-processing-and-text-mining.html#cb486-5" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">&quot;^([5-7])&#39;$&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">1&#39;0&quot;</span>) <span class="sc">|&gt;</span> <span class="co"># Adds 0 to 5&#39;, 6&#39; or 7&#39;</span></span>
<span id="cb486-6"><a href="string-processing-and-text-mining.html#cb486-6" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">&quot;^([5-7])$&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">1&#39;0&quot;</span>) <span class="sc">|&gt;</span> <span class="co"># Adds 0 to 5, 6 or 7</span></span>
<span id="cb486-7"><a href="string-processing-and-text-mining.html#cb486-7" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">&quot;^([4-7])</span><span class="sc">\\</span><span class="st">s*[,</span><span class="sc">\\</span><span class="st">.]</span><span class="sc">\\</span><span class="st">s*(</span><span class="sc">\\</span><span class="st">d*)$&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">1.</span><span class="sc">\\</span><span class="st">2&#39;0&quot;</span>) <span class="sc">|&gt;</span> <span class="co"># Change 5.3&#39; to 5.3&#39;0</span></span>
<span id="cb486-8"><a href="string-processing-and-text-mining.html#cb486-8" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">&quot;^([4-7]</span><span class="sc">\\</span><span class="st">.?</span><span class="sc">\\</span><span class="st">d*)</span><span class="sc">\\</span><span class="st">s*&#39;</span><span class="sc">\\</span><span class="st">s*(</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">.?</span><span class="sc">\\</span><span class="st">d*)</span><span class="sc">\\</span><span class="st">s*$&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">1&#39;</span><span class="sc">\\</span><span class="st">2&quot;</span>) <span class="sc">|&gt;</span> <span class="co">#Removes spaces in middle</span></span>
<span id="cb486-9"><a href="string-processing-and-text-mining.html#cb486-9" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">&quot;^([4-7])</span><span class="sc">\\</span><span class="st">s+(</span><span class="sc">\\</span><span class="st">d*)</span><span class="sc">\\</span><span class="st">s*$&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">1&#39;</span><span class="sc">\\</span><span class="st">2&quot;</span>) <span class="sc">|&gt;</span> <span class="co"># Adds &#39;</span></span>
<span id="cb486-10"><a href="string-processing-and-text-mining.html#cb486-10" tabindex="-1"></a>    <span class="fu">str_replace</span>(<span class="st">&quot;^([12])</span><span class="sc">\\</span><span class="st">s*,</span><span class="sc">\\</span><span class="st">s*(</span><span class="sc">\\</span><span class="st">d*)$&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">1.</span><span class="sc">\\</span><span class="st">2&quot;</span>) <span class="sc">|&gt;</span> <span class="co"># Changes decimals from commas to dots</span></span>
<span id="cb486-11"><a href="string-processing-and-text-mining.html#cb486-11" tabindex="-1"></a>    <span class="fu">str_trim</span>() <span class="co">#Removes spaces at start and end</span></span>
<span id="cb486-12"><a href="string-processing-and-text-mining.html#cb486-12" tabindex="-1"></a>}</span></code></pre></div>
<p>Thus, we have created two functions that could be useful to us if we were to work with surveys of the same type again.</p>
<p>Before applying it to our entire table let’s extract the values to a vector again to apply the created functions.</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="string-processing-and-text-mining.html#cb487-1" tabindex="-1"></a>heights_error <span class="ot">&lt;-</span> reported_heights <span class="sc">|&gt;</span> </span>
<span id="cb487-2"><a href="string-processing-and-text-mining.html#cb487-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(<span class="fu">as.numeric</span>(height)) <span class="sc">|</span> <span class="co"># Does not convert to number</span></span>
<span id="cb487-3"><a href="string-processing-and-text-mining.html#cb487-3" tabindex="-1"></a>         (<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">as.numeric</span>(height)) <span class="sc">&amp;</span> <span class="fu">as.numeric</span>(height) <span class="sc">&gt;=</span> <span class="dv">5</span> <span class="sc">&amp;</span></span>
<span id="cb487-4"><a href="string-processing-and-text-mining.html#cb487-4" tabindex="-1"></a>            <span class="fu">as.numeric</span>(height) <span class="sc">&lt;=</span> <span class="dv">7</span> ) <span class="co"># or entered in feet and not inches</span></span>
<span id="cb487-5"><a href="string-processing-and-text-mining.html#cb487-5" tabindex="-1"></a>        ) <span class="sc">|&gt;</span> </span>
<span id="cb487-6"><a href="string-processing-and-text-mining.html#cb487-6" tabindex="-1"></a>  <span class="fu">pull</span>(height)</span></code></pre></div>
<p>Now let’s apply the created functions:</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="string-processing-and-text-mining.html#cb488-1" tabindex="-1"></a>formatted_heights <span class="ot">&lt;-</span> heights_error <span class="sc">|&gt;</span> </span>
<span id="cb488-2"><a href="string-processing-and-text-mining.html#cb488-2" tabindex="-1"></a>  <span class="fu">words_to_number</span>() <span class="sc">|&gt;</span> </span>
<span id="cb488-3"><a href="string-processing-and-text-mining.html#cb488-3" tabindex="-1"></a>  <span class="fu">format_errors</span>()</span>
<span id="cb488-4"><a href="string-processing-and-text-mining.html#cb488-4" tabindex="-1"></a></span>
<span id="cb488-5"><a href="string-processing-and-text-mining.html#cb488-5" tabindex="-1"></a>pattern <span class="ot">&lt;-</span> <span class="st">&quot;^([4-7]</span><span class="sc">\\</span><span class="st">.?</span><span class="sc">\\</span><span class="st">d*)</span><span class="sc">\\</span><span class="st">s*&#39;</span><span class="sc">\\</span><span class="st">s*(</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">.?</span><span class="sc">\\</span><span class="st">d*)</span><span class="sc">\\</span><span class="st">s*$&quot;</span></span>
<span id="cb488-6"><a href="string-processing-and-text-mining.html#cb488-6" tabindex="-1"></a>indice <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(formatted_heights, pattern)</span>
<span id="cb488-7"><a href="string-processing-and-text-mining.html#cb488-7" tabindex="-1"></a>formatted_heights[<span class="sc">!</span>indice] <span class="co"># Do not match the pattern</span></span>
<span id="cb488-8"><a href="string-processing-and-text-mining.html#cb488-8" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;165&quot;       &quot;&gt;9000&quot;     &quot;2&#39;33&quot;      &quot;1.70&quot;      &quot;yyy&quot;       &quot;6*12&quot;     </span></span>
<span id="cb488-9"><a href="string-processing-and-text-mining.html#cb488-9" tabindex="-1"></a><span class="co">#&gt;  [7] &quot;69&quot;        &quot;708,661&quot;   &quot;649,606&quot;   &quot;728,346&quot;   &quot;170&quot;       &quot;7,283,465&quot;</span></span></code></pre></div>
<p>We have managed to reduce from 168 errors of 1095 records, 15.3% of errors, to 12 errors of 1095, 1% of errors. We can now apply to our initial table.</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="string-processing-and-text-mining.html#cb489-1" tabindex="-1"></a><span class="co"># Apply created formulas</span></span>
<span id="cb489-2"><a href="string-processing-and-text-mining.html#cb489-2" tabindex="-1"></a>heights <span class="ot">&lt;-</span> reported_heights <span class="sc">|&gt;</span> </span>
<span id="cb489-3"><a href="string-processing-and-text-mining.html#cb489-3" tabindex="-1"></a>  <span class="fu">mutate</span>(height) <span class="sc">|&gt;</span> </span>
<span id="cb489-4"><a href="string-processing-and-text-mining.html#cb489-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">height =</span> <span class="fu">words_to_number</span>(height) <span class="sc">|&gt;</span> <span class="fu">format_errors</span>())</span>
<span id="cb489-5"><a href="string-processing-and-text-mining.html#cb489-5" tabindex="-1"></a></span>
<span id="cb489-6"><a href="string-processing-and-text-mining.html#cb489-6" tabindex="-1"></a><span class="co"># Get random samples to validate quality</span></span>
<span id="cb489-7"><a href="string-processing-and-text-mining.html#cb489-7" tabindex="-1"></a>random_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(heights)) </span>
<span id="cb489-8"><a href="string-processing-and-text-mining.html#cb489-8" tabindex="-1"></a>heights[random_indices, ] <span class="sc">|&gt;</span> </span>
<span id="cb489-9"><a href="string-processing-and-text-mining.html#cb489-9" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">15</span>)</span>
<span id="cb489-10"><a href="string-processing-and-text-mining.html#cb489-10" tabindex="-1"></a><span class="co">#&gt;               time_stamp    sex height</span></span>
<span id="cb489-11"><a href="string-processing-and-text-mining.html#cb489-11" tabindex="-1"></a><span class="co">#&gt; 38   2014-09-02 15:16:31 Female  66.75</span></span>
<span id="cb489-12"><a href="string-processing-and-text-mining.html#cb489-12" tabindex="-1"></a><span class="co">#&gt; 712  2015-10-05 16:26:29   Male     69</span></span>
<span id="cb489-13"><a href="string-processing-and-text-mining.html#cb489-13" tabindex="-1"></a><span class="co">#&gt; 132  2014-09-02 15:16:59 Female     62</span></span>
<span id="cb489-14"><a href="string-processing-and-text-mining.html#cb489-14" tabindex="-1"></a><span class="co">#&gt; 1079 2017-07-14 09:30:26   Male     65</span></span>
<span id="cb489-15"><a href="string-processing-and-text-mining.html#cb489-15" tabindex="-1"></a><span class="co">#&gt; 917  2016-01-27 06:29:41 Female     64</span></span>
<span id="cb489-16"><a href="string-processing-and-text-mining.html#cb489-16" tabindex="-1"></a><span class="co">#&gt; 929  2016-02-03 10:30:58   Male  68.89</span></span>
<span id="cb489-17"><a href="string-processing-and-text-mining.html#cb489-17" tabindex="-1"></a><span class="co">#&gt; 163  2014-09-02 15:17:16 Female     64</span></span>
<span id="cb489-18"><a href="string-processing-and-text-mining.html#cb489-18" tabindex="-1"></a><span class="co">#&gt; 397  2014-12-15 14:05:22 Female    5&#39;3</span></span>
<span id="cb489-19"><a href="string-processing-and-text-mining.html#cb489-19" tabindex="-1"></a><span class="co">#&gt; 634  2015-07-18 04:37:21   Male    175</span></span>
<span id="cb489-20"><a href="string-processing-and-text-mining.html#cb489-20" tabindex="-1"></a><span class="co">#&gt; 921  2016-01-27 11:48:40   Male   73.2</span></span>
<span id="cb489-21"><a href="string-processing-and-text-mining.html#cb489-21" tabindex="-1"></a><span class="co">#&gt; 494  2015-03-05 15:28:38   Male    168</span></span>
<span id="cb489-22"><a href="string-processing-and-text-mining.html#cb489-22" tabindex="-1"></a><span class="co">#&gt; 107  2014-09-02 15:16:51 Female     61</span></span>
<span id="cb489-23"><a href="string-processing-and-text-mining.html#cb489-23" tabindex="-1"></a><span class="co">#&gt; 728  2015-11-09 11:17:08   Male     72</span></span>
<span id="cb489-24"><a href="string-processing-and-text-mining.html#cb489-24" tabindex="-1"></a><span class="co">#&gt; 370  2014-11-24 15:26:02   Male     67</span></span>
<span id="cb489-25"><a href="string-processing-and-text-mining.html#cb489-25" tabindex="-1"></a><span class="co">#&gt; 805  2016-01-25 08:16:19   Male     67</span></span></code></pre></div>
<p>We still have to do some conversions. However, since they follow a determined pattern we can use the <code>extract(source_column, new_columns, pattern, remove_source)</code> function to confirm creating new columns for each value of our pattern.</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="string-processing-and-text-mining.html#cb490-1" tabindex="-1"></a>pattern <span class="ot">&lt;-</span> <span class="st">&quot;^([4-7]</span><span class="sc">\\</span><span class="st">.?</span><span class="sc">\\</span><span class="st">d*)</span><span class="sc">\\</span><span class="st">s*&#39;</span><span class="sc">\\</span><span class="st">s*(</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">.?</span><span class="sc">\\</span><span class="st">d*)</span><span class="sc">\\</span><span class="st">s*$&quot;</span></span>
<span id="cb490-2"><a href="string-processing-and-text-mining.html#cb490-2" tabindex="-1"></a></span>
<span id="cb490-3"><a href="string-processing-and-text-mining.html#cb490-3" tabindex="-1"></a>heights <span class="sc">|&gt;</span> </span>
<span id="cb490-4"><a href="string-processing-and-text-mining.html#cb490-4" tabindex="-1"></a>  <span class="fu">extract</span>(height, <span class="fu">c</span>(<span class="st">&quot;feet&quot;</span>, <span class="st">&quot;inches&quot;</span>), <span class="at">regex =</span> pattern, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb490-5"><a href="string-processing-and-text-mining.html#cb490-5" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">15</span>)</span>
<span id="cb490-6"><a href="string-processing-and-text-mining.html#cb490-6" tabindex="-1"></a><span class="co">#&gt;             time_stamp    sex height feet inches</span></span>
<span id="cb490-7"><a href="string-processing-and-text-mining.html#cb490-7" tabindex="-1"></a><span class="co">#&gt; 1  2014-09-02 13:40:36   Male     75 &lt;NA&gt;   &lt;NA&gt;</span></span>
<span id="cb490-8"><a href="string-processing-and-text-mining.html#cb490-8" tabindex="-1"></a><span class="co">#&gt; 2  2014-09-02 13:46:59   Male     70 &lt;NA&gt;   &lt;NA&gt;</span></span>
<span id="cb490-9"><a href="string-processing-and-text-mining.html#cb490-9" tabindex="-1"></a><span class="co">#&gt; 3  2014-09-02 13:59:20   Male     68 &lt;NA&gt;   &lt;NA&gt;</span></span>
<span id="cb490-10"><a href="string-processing-and-text-mining.html#cb490-10" tabindex="-1"></a><span class="co">#&gt; 4  2014-09-02 14:51:53   Male     74 &lt;NA&gt;   &lt;NA&gt;</span></span>
<span id="cb490-11"><a href="string-processing-and-text-mining.html#cb490-11" tabindex="-1"></a><span class="co">#&gt; 5  2014-09-02 15:16:15   Male     61 &lt;NA&gt;   &lt;NA&gt;</span></span>
<span id="cb490-12"><a href="string-processing-and-text-mining.html#cb490-12" tabindex="-1"></a><span class="co">#&gt; 6  2014-09-02 15:16:16 Female     65 &lt;NA&gt;   &lt;NA&gt;</span></span>
<span id="cb490-13"><a href="string-processing-and-text-mining.html#cb490-13" tabindex="-1"></a><span class="co">#&gt; 7  2014-09-02 15:16:19 Female     66 &lt;NA&gt;   &lt;NA&gt;</span></span>
<span id="cb490-14"><a href="string-processing-and-text-mining.html#cb490-14" tabindex="-1"></a><span class="co">#&gt; 8  2014-09-02 15:16:21 Female     62 &lt;NA&gt;   &lt;NA&gt;</span></span>
<span id="cb490-15"><a href="string-processing-and-text-mining.html#cb490-15" tabindex="-1"></a><span class="co">#&gt; 9  2014-09-02 15:16:21 Female     66 &lt;NA&gt;   &lt;NA&gt;</span></span>
<span id="cb490-16"><a href="string-processing-and-text-mining.html#cb490-16" tabindex="-1"></a><span class="co">#&gt; 10 2014-09-02 15:16:22   Male     67 &lt;NA&gt;   &lt;NA&gt;</span></span>
<span id="cb490-17"><a href="string-processing-and-text-mining.html#cb490-17" tabindex="-1"></a><span class="co">#&gt; 11 2014-09-02 15:16:22   Male     72 &lt;NA&gt;   &lt;NA&gt;</span></span>
<span id="cb490-18"><a href="string-processing-and-text-mining.html#cb490-18" tabindex="-1"></a><span class="co">#&gt; 12 2014-09-02 15:16:23   Male    6&#39;0    6      0</span></span>
<span id="cb490-19"><a href="string-processing-and-text-mining.html#cb490-19" tabindex="-1"></a><span class="co">#&gt; 13 2014-09-02 15:16:23   Male     69 &lt;NA&gt;   &lt;NA&gt;</span></span>
<span id="cb490-20"><a href="string-processing-and-text-mining.html#cb490-20" tabindex="-1"></a><span class="co">#&gt; 14 2014-09-02 15:16:26   Male     68 &lt;NA&gt;   &lt;NA&gt;</span></span>
<span id="cb490-21"><a href="string-processing-and-text-mining.html#cb490-21" tabindex="-1"></a><span class="co">#&gt; 15 2014-09-02 15:16:26   Male     69 &lt;NA&gt;   &lt;NA&gt;</span></span></code></pre></div>
<p>Now that we have the data that matches the pattern in two other columns, and we know they are numbers, we can convert everything to number.</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="string-processing-and-text-mining.html#cb491-1" tabindex="-1"></a>heights <span class="sc">|&gt;</span> </span>
<span id="cb491-2"><a href="string-processing-and-text-mining.html#cb491-2" tabindex="-1"></a>  <span class="fu">extract</span>(height, <span class="fu">c</span>(<span class="st">&quot;feet&quot;</span>, <span class="st">&quot;inches&quot;</span>), <span class="at">regex =</span> pattern, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb491-3"><a href="string-processing-and-text-mining.html#cb491-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;feet&quot;</span>, <span class="st">&quot;inches&quot;</span>), <span class="sc">~</span><span class="fu">as.numeric</span>(.))) <span class="sc">|&gt;</span> </span>
<span id="cb491-4"><a href="string-processing-and-text-mining.html#cb491-4" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">15</span>)</span>
<span id="cb491-5"><a href="string-processing-and-text-mining.html#cb491-5" tabindex="-1"></a><span class="co">#&gt; Warning: There was 1 warning in `mutate()`.</span></span>
<span id="cb491-6"><a href="string-processing-and-text-mining.html#cb491-6" tabindex="-1"></a><span class="co">#&gt; ℹ In argument: `across(c(&quot;height&quot;, &quot;feet&quot;, &quot;inches&quot;), ~as.numeric(.))`.</span></span>
<span id="cb491-7"><a href="string-processing-and-text-mining.html#cb491-7" tabindex="-1"></a><span class="co">#&gt; Caused by warning:</span></span>
<span id="cb491-8"><a href="string-processing-and-text-mining.html#cb491-8" tabindex="-1"></a><span class="co">#&gt; ! NAs introduced by coercion</span></span>
<span id="cb491-9"><a href="string-processing-and-text-mining.html#cb491-9" tabindex="-1"></a><span class="co">#&gt;             time_stamp    sex height feet inches</span></span>
<span id="cb491-10"><a href="string-processing-and-text-mining.html#cb491-10" tabindex="-1"></a><span class="co">#&gt; 1  2014-09-02 13:40:36   Male     75   NA     NA</span></span>
<span id="cb491-11"><a href="string-processing-and-text-mining.html#cb491-11" tabindex="-1"></a><span class="co">#&gt; 2  2014-09-02 13:46:59   Male     70   NA     NA</span></span>
<span id="cb491-12"><a href="string-processing-and-text-mining.html#cb491-12" tabindex="-1"></a><span class="co">#&gt; 3  2014-09-02 13:59:20   Male     68   NA     NA</span></span>
<span id="cb491-13"><a href="string-processing-and-text-mining.html#cb491-13" tabindex="-1"></a><span class="co">#&gt; 4  2014-09-02 14:51:53   Male     74   NA     NA</span></span>
<span id="cb491-14"><a href="string-processing-and-text-mining.html#cb491-14" tabindex="-1"></a><span class="co">#&gt; 5  2014-09-02 15:16:15   Male     61   NA     NA</span></span>
<span id="cb491-15"><a href="string-processing-and-text-mining.html#cb491-15" tabindex="-1"></a><span class="co">#&gt; 6  2014-09-02 15:16:16 Female     65   NA     NA</span></span>
<span id="cb491-16"><a href="string-processing-and-text-mining.html#cb491-16" tabindex="-1"></a><span class="co">#&gt; 7  2014-09-02 15:16:19 Female     66   NA     NA</span></span>
<span id="cb491-17"><a href="string-processing-and-text-mining.html#cb491-17" tabindex="-1"></a><span class="co">#&gt; 8  2014-09-02 15:16:21 Female     62   NA     NA</span></span>
<span id="cb491-18"><a href="string-processing-and-text-mining.html#cb491-18" tabindex="-1"></a><span class="co">#&gt; 9  2014-09-02 15:16:21 Female     66   NA     NA</span></span>
<span id="cb491-19"><a href="string-processing-and-text-mining.html#cb491-19" tabindex="-1"></a><span class="co">#&gt; 10 2014-09-02 15:16:22   Male     67   NA     NA</span></span>
<span id="cb491-20"><a href="string-processing-and-text-mining.html#cb491-20" tabindex="-1"></a><span class="co">#&gt; 11 2014-09-02 15:16:22   Male     72   NA     NA</span></span>
<span id="cb491-21"><a href="string-processing-and-text-mining.html#cb491-21" tabindex="-1"></a><span class="co">#&gt; 12 2014-09-02 15:16:23   Male     NA    6      0</span></span>
<span id="cb491-22"><a href="string-processing-and-text-mining.html#cb491-22" tabindex="-1"></a><span class="co">#&gt; 13 2014-09-02 15:16:23   Male     69   NA     NA</span></span>
<span id="cb491-23"><a href="string-processing-and-text-mining.html#cb491-23" tabindex="-1"></a><span class="co">#&gt; 14 2014-09-02 15:16:26   Male     68   NA     NA</span></span>
<span id="cb491-24"><a href="string-processing-and-text-mining.html#cb491-24" tabindex="-1"></a><span class="co">#&gt; 15 2014-09-02 15:16:26   Male     69   NA     NA</span></span></code></pre></div>
<p>Now that our columns are numeric we can perform operations to calculate height.</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="string-processing-and-text-mining.html#cb492-1" tabindex="-1"></a>heights <span class="sc">|&gt;</span> </span>
<span id="cb492-2"><a href="string-processing-and-text-mining.html#cb492-2" tabindex="-1"></a>  <span class="fu">extract</span>(height, <span class="fu">c</span>(<span class="st">&quot;feet&quot;</span>, <span class="st">&quot;inches&quot;</span>), <span class="at">regex =</span> pattern, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb492-3"><a href="string-processing-and-text-mining.html#cb492-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;feet&quot;</span>, <span class="st">&quot;inches&quot;</span>), <span class="sc">~</span><span class="fu">as.numeric</span>(.))) <span class="sc">|&gt;</span> </span>
<span id="cb492-4"><a href="string-processing-and-text-mining.html#cb492-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fixed_heights =</span> feet<span class="sc">*</span><span class="dv">12</span> <span class="sc">+</span> inches) <span class="sc">|&gt;</span> </span>
<span id="cb492-5"><a href="string-processing-and-text-mining.html#cb492-5" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">15</span>)</span>
<span id="cb492-6"><a href="string-processing-and-text-mining.html#cb492-6" tabindex="-1"></a><span class="co">#&gt; Warning: There was 1 warning in `mutate()`.</span></span>
<span id="cb492-7"><a href="string-processing-and-text-mining.html#cb492-7" tabindex="-1"></a><span class="co">#&gt; ℹ In argument: `across(c(&quot;height&quot;, &quot;feet&quot;, &quot;inches&quot;), ~as.numeric(.))`.</span></span>
<span id="cb492-8"><a href="string-processing-and-text-mining.html#cb492-8" tabindex="-1"></a><span class="co">#&gt; Caused by warning:</span></span>
<span id="cb492-9"><a href="string-processing-and-text-mining.html#cb492-9" tabindex="-1"></a><span class="co">#&gt; ! NAs introduced by coercion</span></span>
<span id="cb492-10"><a href="string-processing-and-text-mining.html#cb492-10" tabindex="-1"></a><span class="co">#&gt;             time_stamp    sex height feet inches fixed_heights</span></span>
<span id="cb492-11"><a href="string-processing-and-text-mining.html#cb492-11" tabindex="-1"></a><span class="co">#&gt; 1  2014-09-02 13:40:36   Male     75   NA     NA            NA</span></span>
<span id="cb492-12"><a href="string-processing-and-text-mining.html#cb492-12" tabindex="-1"></a><span class="co">#&gt; 2  2014-09-02 13:46:59   Male     70   NA     NA            NA</span></span>
<span id="cb492-13"><a href="string-processing-and-text-mining.html#cb492-13" tabindex="-1"></a><span class="co">#&gt; 3  2014-09-02 13:59:20   Male     68   NA     NA            NA</span></span>
<span id="cb492-14"><a href="string-processing-and-text-mining.html#cb492-14" tabindex="-1"></a><span class="co">#&gt; 4  2014-09-02 14:51:53   Male     74   NA     NA            NA</span></span>
<span id="cb492-15"><a href="string-processing-and-text-mining.html#cb492-15" tabindex="-1"></a><span class="co">#&gt; 5  2014-09-02 15:16:15   Male     61   NA     NA            NA</span></span>
<span id="cb492-16"><a href="string-processing-and-text-mining.html#cb492-16" tabindex="-1"></a><span class="co">#&gt; 6  2014-09-02 15:16:16 Female     65   NA     NA            NA</span></span>
<span id="cb492-17"><a href="string-processing-and-text-mining.html#cb492-17" tabindex="-1"></a><span class="co">#&gt; 7  2014-09-02 15:16:19 Female     66   NA     NA            NA</span></span>
<span id="cb492-18"><a href="string-processing-and-text-mining.html#cb492-18" tabindex="-1"></a><span class="co">#&gt; 8  2014-09-02 15:16:21 Female     62   NA     NA            NA</span></span>
<span id="cb492-19"><a href="string-processing-and-text-mining.html#cb492-19" tabindex="-1"></a><span class="co">#&gt; 9  2014-09-02 15:16:21 Female     66   NA     NA            NA</span></span>
<span id="cb492-20"><a href="string-processing-and-text-mining.html#cb492-20" tabindex="-1"></a><span class="co">#&gt; 10 2014-09-02 15:16:22   Male     67   NA     NA            NA</span></span>
<span id="cb492-21"><a href="string-processing-and-text-mining.html#cb492-21" tabindex="-1"></a><span class="co">#&gt; 11 2014-09-02 15:16:22   Male     72   NA     NA            NA</span></span>
<span id="cb492-22"><a href="string-processing-and-text-mining.html#cb492-22" tabindex="-1"></a><span class="co">#&gt; 12 2014-09-02 15:16:23   Male     NA    6      0            72</span></span>
<span id="cb492-23"><a href="string-processing-and-text-mining.html#cb492-23" tabindex="-1"></a><span class="co">#&gt; 13 2014-09-02 15:16:23   Male     69   NA     NA            NA</span></span>
<span id="cb492-24"><a href="string-processing-and-text-mining.html#cb492-24" tabindex="-1"></a><span class="co">#&gt; 14 2014-09-02 15:16:26   Male     68   NA     NA            NA</span></span>
<span id="cb492-25"><a href="string-processing-and-text-mining.html#cb492-25" tabindex="-1"></a><span class="co">#&gt; 15 2014-09-02 15:16:26   Male     69   NA     NA            NA</span></span></code></pre></div>
<p>Finally, we will do a validation of whether the height is in an interval and/or if it was expressed in centimeters or meters.</p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="string-processing-and-text-mining.html#cb493-1" tabindex="-1"></a><span class="co"># We assume for a person a minimum 50&quot; (1.2m) and max 84&quot; (2.1m)</span></span>
<span id="cb493-2"><a href="string-processing-and-text-mining.html#cb493-2" tabindex="-1"></a>min <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb493-3"><a href="string-processing-and-text-mining.html#cb493-3" tabindex="-1"></a>max <span class="ot">&lt;-</span> <span class="dv">84</span></span>
<span id="cb493-4"><a href="string-processing-and-text-mining.html#cb493-4" tabindex="-1"></a></span>
<span id="cb493-5"><a href="string-processing-and-text-mining.html#cb493-5" tabindex="-1"></a>heights <span class="ot">&lt;-</span> heights <span class="sc">|&gt;</span> </span>
<span id="cb493-6"><a href="string-processing-and-text-mining.html#cb493-6" tabindex="-1"></a>  <span class="fu">extract</span>(height, <span class="fu">c</span>(<span class="st">&quot;feet&quot;</span>, <span class="st">&quot;inches&quot;</span>), <span class="at">regex =</span> pattern, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb493-7"><a href="string-processing-and-text-mining.html#cb493-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;feet&quot;</span>, <span class="st">&quot;inches&quot;</span>), <span class="sc">~</span><span class="fu">as.numeric</span>(.))) <span class="sc">|&gt;</span> </span>
<span id="cb493-8"><a href="string-processing-and-text-mining.html#cb493-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fixed_heights =</span> feet<span class="sc">*</span><span class="dv">12</span> <span class="sc">+</span> inches) <span class="sc">|&gt;</span> </span>
<span id="cb493-9"><a href="string-processing-and-text-mining.html#cb493-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">final_height =</span> <span class="fu">case_when</span>(</span>
<span id="cb493-10"><a href="string-processing-and-text-mining.html#cb493-10" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(height) <span class="sc">&amp;</span> <span class="fu">between</span>(height, min, max) <span class="sc">~</span> height, <span class="co">#inches </span></span>
<span id="cb493-11"><a href="string-processing-and-text-mining.html#cb493-11" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(height) <span class="sc">&amp;</span> <span class="fu">between</span>(height<span class="sc">/</span><span class="fl">2.54</span>, min, max) <span class="sc">~</span> height<span class="sc">/</span><span class="fl">2.54</span>, <span class="co">#cm</span></span>
<span id="cb493-12"><a href="string-processing-and-text-mining.html#cb493-12" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(height) <span class="sc">&amp;</span> <span class="fu">between</span>(height<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span><span class="fl">2.54</span>, min, max) <span class="sc">~</span> height<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span><span class="fl">2.54</span>, <span class="co">#meters</span></span>
<span id="cb493-13"><a href="string-processing-and-text-mining.html#cb493-13" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(fixed_heights) <span class="sc">&amp;</span> inches <span class="sc">&lt;</span> <span class="dv">12</span> <span class="sc">&amp;</span> </span>
<span id="cb493-14"><a href="string-processing-and-text-mining.html#cb493-14" tabindex="-1"></a>      <span class="fu">between</span>(fixed_heights, min, max) <span class="sc">~</span> fixed_heights, <span class="co">#feet&#39;inches</span></span>
<span id="cb493-15"><a href="string-processing-and-text-mining.html#cb493-15" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="cn">NA</span>)))</span>
<span id="cb493-16"><a href="string-processing-and-text-mining.html#cb493-16" tabindex="-1"></a><span class="co">#&gt; Warning: There was 1 warning in `mutate()`.</span></span>
<span id="cb493-17"><a href="string-processing-and-text-mining.html#cb493-17" tabindex="-1"></a><span class="co">#&gt; ℹ In argument: `across(c(&quot;height&quot;, &quot;feet&quot;, &quot;inches&quot;), ~as.numeric(.))`.</span></span>
<span id="cb493-18"><a href="string-processing-and-text-mining.html#cb493-18" tabindex="-1"></a><span class="co">#&gt; Caused by warning:</span></span>
<span id="cb493-19"><a href="string-processing-and-text-mining.html#cb493-19" tabindex="-1"></a><span class="co">#&gt; ! NAs introduced by coercion</span></span>
<span id="cb493-20"><a href="string-processing-and-text-mining.html#cb493-20" tabindex="-1"></a></span>
<span id="cb493-21"><a href="string-processing-and-text-mining.html#cb493-21" tabindex="-1"></a><span class="co"># Random Sample:</span></span>
<span id="cb493-22"><a href="string-processing-and-text-mining.html#cb493-22" tabindex="-1"></a>random_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(heights)) </span>
<span id="cb493-23"><a href="string-processing-and-text-mining.html#cb493-23" tabindex="-1"></a>heights[random_indices, ] <span class="sc">|&gt;</span> </span>
<span id="cb493-24"><a href="string-processing-and-text-mining.html#cb493-24" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>time_stamp) <span class="sc">|&gt;</span> <span class="co"># Shows all columns except time_stamp</span></span>
<span id="cb493-25"><a href="string-processing-and-text-mining.html#cb493-25" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb493-26"><a href="string-processing-and-text-mining.html#cb493-26" tabindex="-1"></a><span class="co">#&gt;         sex height feet inches fixed_heights final_height</span></span>
<span id="cb493-27"><a href="string-processing-and-text-mining.html#cb493-27" tabindex="-1"></a><span class="co">#&gt; 856  Female  63.00   NA     NA            NA     63.00000</span></span>
<span id="cb493-28"><a href="string-processing-and-text-mining.html#cb493-28" tabindex="-1"></a><span class="co">#&gt; 1003   Male  68.00   NA     NA            NA     68.00000</span></span>
<span id="cb493-29"><a href="string-processing-and-text-mining.html#cb493-29" tabindex="-1"></a><span class="co">#&gt; 1059   Male 210.00   NA     NA            NA     82.67717</span></span>
<span id="cb493-30"><a href="string-processing-and-text-mining.html#cb493-30" tabindex="-1"></a><span class="co">#&gt; 405    Male  71.00   NA     NA            NA     71.00000</span></span>
<span id="cb493-31"><a href="string-processing-and-text-mining.html#cb493-31" tabindex="-1"></a><span class="co">#&gt; 888  Female  62.00   NA     NA            NA     62.00000</span></span>
<span id="cb493-32"><a href="string-processing-and-text-mining.html#cb493-32" tabindex="-1"></a><span class="co">#&gt; 300    Male  72.00   NA     NA            NA     72.00000</span></span>
<span id="cb493-33"><a href="string-processing-and-text-mining.html#cb493-33" tabindex="-1"></a><span class="co">#&gt; 470    Male  71.00   NA     NA            NA     71.00000</span></span>
<span id="cb493-34"><a href="string-processing-and-text-mining.html#cb493-34" tabindex="-1"></a><span class="co">#&gt; 274    Male  66.00   NA     NA            NA     66.00000</span></span>
<span id="cb493-35"><a href="string-processing-and-text-mining.html#cb493-35" tabindex="-1"></a><span class="co">#&gt; 427    Male  53.77   NA     NA            NA     53.77000</span></span>
<span id="cb493-36"><a href="string-processing-and-text-mining.html#cb493-36" tabindex="-1"></a><span class="co">#&gt; 1087 Female  34.00   NA     NA            NA           NA</span></span></code></pre></div>
<p>We already have our sample validated, we would only have to take the columns we need and start using the object for the analyses we need.</p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="string-processing-and-text-mining.html#cb494-1" tabindex="-1"></a>final_heights <span class="ot">&lt;-</span> heights <span class="sc">|&gt;</span> </span>
<span id="cb494-2"><a href="string-processing-and-text-mining.html#cb494-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">gender =</span> sex, <span class="at">heights =</span> final_height)</span>
<span id="cb494-3"><a href="string-processing-and-text-mining.html#cb494-3" tabindex="-1"></a></span>
<span id="cb494-4"><a href="string-processing-and-text-mining.html#cb494-4" tabindex="-1"></a>final_heights <span class="sc">|&gt;</span> </span>
<span id="cb494-5"><a href="string-processing-and-text-mining.html#cb494-5" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb494-6"><a href="string-processing-and-text-mining.html#cb494-6" tabindex="-1"></a><span class="co">#&gt;    gender heights</span></span>
<span id="cb494-7"><a href="string-processing-and-text-mining.html#cb494-7" tabindex="-1"></a><span class="co">#&gt; 1    Male      75</span></span>
<span id="cb494-8"><a href="string-processing-and-text-mining.html#cb494-8" tabindex="-1"></a><span class="co">#&gt; 2    Male      70</span></span>
<span id="cb494-9"><a href="string-processing-and-text-mining.html#cb494-9" tabindex="-1"></a><span class="co">#&gt; 3    Male      68</span></span>
<span id="cb494-10"><a href="string-processing-and-text-mining.html#cb494-10" tabindex="-1"></a><span class="co">#&gt; 4    Male      74</span></span>
<span id="cb494-11"><a href="string-processing-and-text-mining.html#cb494-11" tabindex="-1"></a><span class="co">#&gt; 5    Male      61</span></span>
<span id="cb494-12"><a href="string-processing-and-text-mining.html#cb494-12" tabindex="-1"></a><span class="co">#&gt; 6  Female      65</span></span>
<span id="cb494-13"><a href="string-processing-and-text-mining.html#cb494-13" tabindex="-1"></a><span class="co">#&gt; 7  Female      66</span></span>
<span id="cb494-14"><a href="string-processing-and-text-mining.html#cb494-14" tabindex="-1"></a><span class="co">#&gt; 8  Female      62</span></span>
<span id="cb494-15"><a href="string-processing-and-text-mining.html#cb494-15" tabindex="-1"></a><span class="co">#&gt; 9  Female      66</span></span>
<span id="cb494-16"><a href="string-processing-and-text-mining.html#cb494-16" tabindex="-1"></a><span class="co">#&gt; 10   Male      67</span></span></code></pre></div>
</div>
</div>
<div id="from-strings-to-dates" class="section level2 hasAnchor" number="11.3">
<h2><span class="header-section-number">11.3</span> From strings to dates<a href="string-processing-and-text-mining.html#from-strings-to-dates" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Regularly when we import data, we are not only going to want to transform numeric data. We will also have multiple cases where we need to transform our string to a date in some particular format. For this, we will use the <code>lubridate</code> library, included in <code>tidyverse</code>, which provides us with diverse functions to make date treatment more accessible.</p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="string-processing-and-text-mining.html#cb495-1" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code></pre></div>
<p>When the text string is in the ISO 8601 date format (YYYY-MM-DD), we can directly use the <code>month()</code>, <code>day()</code>, <code>year()</code> function.</p>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="string-processing-and-text-mining.html#cb496-1" tabindex="-1"></a>dates_char <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;2010-05-19&quot;</span>, <span class="st">&quot;2020-05-06&quot;</span>, <span class="st">&quot;2010-02-03&quot;</span>)</span>
<span id="cb496-2"><a href="string-processing-and-text-mining.html#cb496-2" tabindex="-1"></a></span>
<span id="cb496-3"><a href="string-processing-and-text-mining.html#cb496-3" tabindex="-1"></a><span class="fu">str</span>(dates_char)</span>
<span id="cb496-4"><a href="string-processing-and-text-mining.html#cb496-4" tabindex="-1"></a><span class="co">#&gt;  chr [1:3] &quot;2010-05-19&quot; &quot;2020-05-06&quot; &quot;2010-02-03&quot;</span></span>
<span id="cb496-5"><a href="string-processing-and-text-mining.html#cb496-5" tabindex="-1"></a></span>
<span id="cb496-6"><a href="string-processing-and-text-mining.html#cb496-6" tabindex="-1"></a><span class="fu">month</span>(dates_char)</span>
<span id="cb496-7"><a href="string-processing-and-text-mining.html#cb496-7" tabindex="-1"></a><span class="co">#&gt; [1] 5 5 2</span></span></code></pre></div>
<p>However, we do not always have the date in that format and <code>lubridate()</code> gives other functions that are more flexible when coercing data. Look at this example:</p>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="string-processing-and-text-mining.html#cb497-1" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20090101</span>, <span class="st">&quot;2009-01-02&quot;</span>, <span class="st">&quot;2009 01 03&quot;</span>, <span class="st">&quot;2009-1-4&quot;</span>,</span>
<span id="cb497-2"><a href="string-processing-and-text-mining.html#cb497-2" tabindex="-1"></a>       <span class="st">&quot;2009-1, 5&quot;</span>, <span class="st">&quot;Created on 2009 1 6&quot;</span>, <span class="st">&quot;200901 !!! 07&quot;</span>)</span>
<span id="cb497-3"><a href="string-processing-and-text-mining.html#cb497-3" tabindex="-1"></a></span>
<span id="cb497-4"><a href="string-processing-and-text-mining.html#cb497-4" tabindex="-1"></a><span class="fu">str</span>(dates)</span>
<span id="cb497-5"><a href="string-processing-and-text-mining.html#cb497-5" tabindex="-1"></a><span class="co">#&gt;  chr [1:7] &quot;20090101&quot; &quot;2009-01-02&quot; &quot;2009 01 03&quot; &quot;2009-1-4&quot; &quot;2009-1, 5&quot; ...</span></span>
<span id="cb497-6"><a href="string-processing-and-text-mining.html#cb497-6" tabindex="-1"></a></span>
<span id="cb497-7"><a href="string-processing-and-text-mining.html#cb497-7" tabindex="-1"></a><span class="fu">ymd</span>(dates)</span>
<span id="cb497-8"><a href="string-processing-and-text-mining.html#cb497-8" tabindex="-1"></a><span class="co">#&gt; [1] &quot;2009-01-01&quot; &quot;2009-01-02&quot; &quot;2009-01-03&quot; &quot;2009-01-04&quot; &quot;2009-01-05&quot;</span></span>
<span id="cb497-9"><a href="string-processing-and-text-mining.html#cb497-9" tabindex="-1"></a><span class="co">#&gt; [6] &quot;2009-01-06&quot; &quot;2009-01-07&quot;</span></span></code></pre></div>
<p>The first data entered was a number, but we already know that it coerces it to text. Then, we have different values entered, but all follow the same pattern. First is the year, then the month and then the day. When we know that first is the year, then month and then day we will use the <code>ymd()</code> function to convert all dates to ISO 8601 format.</p>
<p>In the same way, we will have the following functions that we can use depending on the form in which we have the date from our source. In all cases it will be convenient for us to convert to ISO 8601 format. For example here we can see when it correctly recognizes the format and when the formatting fails.</p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="string-processing-and-text-mining.html#cb498-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="st">&quot;28/03/89&quot;</span></span>
<span id="cb498-2"><a href="string-processing-and-text-mining.html#cb498-2" tabindex="-1"></a><span class="fu">ymd</span>(x)</span>
<span id="cb498-3"><a href="string-processing-and-text-mining.html#cb498-3" tabindex="-1"></a><span class="co">#&gt; [1] NA</span></span>
<span id="cb498-4"><a href="string-processing-and-text-mining.html#cb498-4" tabindex="-1"></a><span class="fu">mdy</span>(x)</span>
<span id="cb498-5"><a href="string-processing-and-text-mining.html#cb498-5" tabindex="-1"></a><span class="co">#&gt; [1] NA</span></span>
<span id="cb498-6"><a href="string-processing-and-text-mining.html#cb498-6" tabindex="-1"></a><span class="fu">ydm</span>(x)</span>
<span id="cb498-7"><a href="string-processing-and-text-mining.html#cb498-7" tabindex="-1"></a><span class="co">#&gt; [1] NA</span></span>
<span id="cb498-8"><a href="string-processing-and-text-mining.html#cb498-8" tabindex="-1"></a><span class="fu">myd</span>(x)</span>
<span id="cb498-9"><a href="string-processing-and-text-mining.html#cb498-9" tabindex="-1"></a><span class="co">#&gt; [1] NA</span></span>
<span id="cb498-10"><a href="string-processing-and-text-mining.html#cb498-10" tabindex="-1"></a><span class="fu">dmy</span>(x)</span>
<span id="cb498-11"><a href="string-processing-and-text-mining.html#cb498-11" tabindex="-1"></a><span class="co">#&gt; [1] &quot;1989-03-28&quot;</span></span>
<span id="cb498-12"><a href="string-processing-and-text-mining.html#cb498-12" tabindex="-1"></a><span class="fu">dym</span>(x)</span>
<span id="cb498-13"><a href="string-processing-and-text-mining.html#cb498-13" tabindex="-1"></a><span class="co">#&gt; [1] NA</span></span></code></pre></div>
<p>Finally, in the same way that we can use these functions of days, months and years, we can also use to refer to hours, minutes and seconds.</p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="string-processing-and-text-mining.html#cb499-1" tabindex="-1"></a><span class="co"># Format with hours, minutes and seconds</span></span>
<span id="cb499-2"><a href="string-processing-and-text-mining.html#cb499-2" tabindex="-1"></a>date_val <span class="ot">&lt;-</span> <span class="st">&quot;Feb/2/2012 12:34:56&quot;</span></span>
<span id="cb499-3"><a href="string-processing-and-text-mining.html#cb499-3" tabindex="-1"></a><span class="fu">mdy_hms</span>(date_val)</span>
<span id="cb499-4"><a href="string-processing-and-text-mining.html#cb499-4" tabindex="-1"></a><span class="co">#&gt; [1] &quot;2012-02-02 12:34:56 UTC&quot;</span></span>
<span id="cb499-5"><a href="string-processing-and-text-mining.html#cb499-5" tabindex="-1"></a></span>
<span id="cb499-6"><a href="string-processing-and-text-mining.html#cb499-6" tabindex="-1"></a><span class="co"># Additional data: Showing system date:</span></span>
<span id="cb499-7"><a href="string-processing-and-text-mining.html#cb499-7" tabindex="-1"></a><span class="fu">now</span>()</span>
<span id="cb499-8"><a href="string-processing-and-text-mining.html#cb499-8" tabindex="-1"></a><span class="co">#&gt; [1] &quot;2025-12-23 23:46:14 GMT&quot;</span></span></code></pre></div>
</div>
<div id="exercises-16" class="section level2 hasAnchor" number="11.4">
<h2><span class="header-section-number">11.4</span> Exercises<a href="string-processing-and-text-mining.html#exercises-16" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before solving the following exercise run this Script:</p>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="string-processing-and-text-mining.html#cb500-1" tabindex="-1"></a>ventas <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb500-2"><a href="string-processing-and-text-mining.html#cb500-2" tabindex="-1"></a>  <span class="at">mes =</span> <span class="fu">c</span>(<span class="st">&quot;Abril&quot;</span>, <span class="st">&quot;Mayo&quot;</span>, <span class="st">&quot;Junio&quot;</span>),</span>
<span id="cb500-3"><a href="string-processing-and-text-mining.html#cb500-3" tabindex="-1"></a>  <span class="at">ventas =</span> <span class="fu">c</span>(<span class="st">&quot;s/32,124&quot;</span>, <span class="st">&quot;s/35,465&quot;</span>, <span class="st">&quot;S/38,332&quot;</span>),</span>
<span id="cb500-4"><a href="string-processing-and-text-mining.html#cb500-4" tabindex="-1"></a>  <span class="at">ganancias =</span> <span class="fu">c</span>(<span class="st">&quot;s/8,120&quot;</span>, <span class="st">&quot;s/9,432&quot;</span>, <span class="st">&quot;s/10,543&quot;</span>)</span>
<span id="cb500-5"><a href="string-processing-and-text-mining.html#cb500-5" tabindex="-1"></a>)</span></code></pre></div>
<ol start="99" style="list-style-type: decimal">
<li>From the <code>ventas</code> object convert the sales and profits columns to numeric values.</li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="string-processing-and-text-mining.html#cb501-1" tabindex="-1"></a><span class="co"># Solution 1</span></span>
<span id="cb501-2"><a href="string-processing-and-text-mining.html#cb501-2" tabindex="-1"></a>ventas <span class="sc">|&gt;</span> </span>
<span id="cb501-3"><a href="string-processing-and-text-mining.html#cb501-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="sc">~</span><span class="fu">parse_number</span>(.)))</span>
<span id="cb501-4"><a href="string-processing-and-text-mining.html#cb501-4" tabindex="-1"></a></span>
<span id="cb501-5"><a href="string-processing-and-text-mining.html#cb501-5" tabindex="-1"></a><span class="co"># Alternative solution, longer</span></span>
<span id="cb501-6"><a href="string-processing-and-text-mining.html#cb501-6" tabindex="-1"></a>ventas <span class="sc">|&gt;</span></span>
<span id="cb501-7"><a href="string-processing-and-text-mining.html#cb501-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="sc">~</span><span class="fu">str_replace_all</span>(., <span class="st">&quot;</span><span class="sc">\\</span><span class="st">S/|,&quot;</span>, <span class="st">&quot;&quot;</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb501-8"><a href="string-processing-and-text-mining.html#cb501-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="sc">~</span><span class="fu">as.numeric</span>(.)))</span></code></pre></div>
</details>
<ol start="100" style="list-style-type: decimal">
<li>Given the vector universities:</li>
</ol>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="string-processing-and-text-mining.html#cb502-1" tabindex="-1"></a>universidades <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;U. Católica de Chile&quot;</span>, <span class="st">&quot;Univ Nacional Autónoma de México&quot;</span>, </span>
<span id="cb502-2"><a href="string-processing-and-text-mining.html#cb502-2" tabindex="-1"></a>                   <span class="st">&quot;Univ. Nacional de Ingeniería&quot;</span>, <span class="st">&quot;Universidad de los Andes&quot;</span>, </span>
<span id="cb502-3"><a href="string-processing-and-text-mining.html#cb502-3" tabindex="-1"></a>                   <span class="st">&quot;U de Barcelona&quot;</span>, <span class="st">&quot;California State University&quot;</span>)</span></code></pre></div>
<p>Clean the data to obtain the full name as shown below:</p>
<pre><code>#&gt; [1] &quot;Universidad Católica de Chile&quot;          
#&gt; [2] &quot;Universidad Nacional Autónoma de México&quot;
#&gt; [3] &quot;Universidad Nacional de Ingeniería&quot;     
#&gt; [4] &quot;Universidad de los Andes&quot;               
#&gt; [5] &quot;Universidad de Barcelona&quot;               
#&gt; [6] &quot;California State University&quot;</code></pre>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="string-processing-and-text-mining.html#cb504-1" tabindex="-1"></a>universidades <span class="sc">|&gt;</span> </span>
<span id="cb504-2"><a href="string-processing-and-text-mining.html#cb504-2" tabindex="-1"></a>    <span class="fu">str_replace</span>(<span class="st">&quot;^Univ</span><span class="sc">\\</span><span class="st">.?</span><span class="sc">\\</span><span class="st">s|^U</span><span class="sc">\\</span><span class="st">.?</span><span class="sc">\\</span><span class="st">s&quot;</span>, <span class="st">&quot;Universidad &quot;</span>)</span></code></pre></div>
</details>
<p>For the following exercises, we are going to work on the survey data conducted prior to Brexit in the UK. Run the Script first:</p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="string-processing-and-text-mining.html#cb505-1" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb505-2"><a href="string-processing-and-text-mining.html#cb505-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb505-3"><a href="string-processing-and-text-mining.html#cb505-3" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://en.wikipedia.org/w/index.php?title=Opinion_polling_for_the_United_Kingdom_European_Union_membership_referendum&amp;oldid=896735054&quot;</span></span>
<span id="cb505-4"><a href="string-processing-and-text-mining.html#cb505-4" tabindex="-1"></a>tabla <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url) <span class="sc">|&gt;</span> <span class="fu">html_nodes</span>(<span class="st">&quot;table&quot;</span>)</span>
<span id="cb505-5"><a href="string-processing-and-text-mining.html#cb505-5" tabindex="-1"></a>encuestas <span class="ot">&lt;-</span> tabla[[<span class="dv">5</span>]] <span class="sc">|&gt;</span> <span class="fu">html_table</span>(<span class="at">fill =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ol start="101" style="list-style-type: decimal">
<li>Update the <code>encuestas</code> object with the following names <code>c("fecha", "permanecer", "salir", "no_decide", "spread", "muestra", "encuestadora", "tipo", "notas")</code>. Not all polls have a percentage value in the <code>permanecer</code> (remain) column. Filter the columns so that only values containing the <code>%</code> symbol are shown.</li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="string-processing-and-text-mining.html#cb506-1" tabindex="-1"></a><span class="fu">names</span>(encuestas) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;fecha&quot;</span>, <span class="st">&quot;permanecer&quot;</span>, <span class="st">&quot;salir&quot;</span>, <span class="st">&quot;no_decide&quot;</span>, <span class="st">&quot;spread&quot;</span>,</span>
<span id="cb506-2"><a href="string-processing-and-text-mining.html#cb506-2" tabindex="-1"></a>                  <span class="st">&quot;muestra&quot;</span>, <span class="st">&quot;encuestadora&quot;</span>, <span class="st">&quot;tipo&quot;</span>, <span class="st">&quot;notas&quot;</span>)</span>
<span id="cb506-3"><a href="string-processing-and-text-mining.html#cb506-3" tabindex="-1"></a>encuestas <span class="ot">&lt;-</span> encuestas[<span class="fu">str_detect</span>(encuestas<span class="sc">$</span>permanecer, <span class="st">&quot;%&quot;</span>), ]</span>
<span id="cb506-4"><a href="string-processing-and-text-mining.html#cb506-4" tabindex="-1"></a>encuestas </span>
<span id="cb506-5"><a href="string-processing-and-text-mining.html#cb506-5" tabindex="-1"></a></span>
<span id="cb506-6"><a href="string-processing-and-text-mining.html#cb506-6" tabindex="-1"></a><span class="co"># If we want to validate the number of surveys:</span></span>
<span id="cb506-7"><a href="string-processing-and-text-mining.html#cb506-7" tabindex="-1"></a><span class="fu">nrow</span>(encuestas)</span></code></pre></div>
</details>
<ol start="102" style="list-style-type: decimal">
<li>Store the values of the <code>permanecer</code> column to the <code>permanecer</code> vector and convert the values to the numerical value of the percentage. That is, values from 0 to 1 (0.5 instead of 50%).</li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="string-processing-and-text-mining.html#cb507-1" tabindex="-1"></a>permanecer <span class="ot">&lt;-</span> encuestas<span class="sc">$</span>permanecer</span>
<span id="cb507-2"><a href="string-processing-and-text-mining.html#cb507-2" tabindex="-1"></a></span>
<span id="cb507-3"><a href="string-processing-and-text-mining.html#cb507-3" tabindex="-1"></a><span class="co"># Solution 1:</span></span>
<span id="cb507-4"><a href="string-processing-and-text-mining.html#cb507-4" tabindex="-1"></a>porcentajes <span class="ot">&lt;-</span> <span class="fu">parse_number</span>(permanecer)<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb507-5"><a href="string-processing-and-text-mining.html#cb507-5" tabindex="-1"></a></span>
<span id="cb507-6"><a href="string-processing-and-text-mining.html#cb507-6" tabindex="-1"></a><span class="co"># Solution 1:</span></span>
<span id="cb507-7"><a href="string-processing-and-text-mining.html#cb507-7" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">str_replace</span>(permanecer, <span class="st">&quot;%&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb507-8"><a href="string-processing-and-text-mining.html#cb507-8" tabindex="-1"></a>porcentajes <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(temp)<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb507-9"><a href="string-processing-and-text-mining.html#cb507-9" tabindex="-1"></a></span>
<span id="cb507-10"><a href="string-processing-and-text-mining.html#cb507-10" tabindex="-1"></a><span class="co"># Solution 2:</span></span>
<span id="cb507-11"><a href="string-processing-and-text-mining.html#cb507-11" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">str_remove</span>(permanecer, <span class="st">&quot;%&quot;</span>)</span>
<span id="cb507-12"><a href="string-processing-and-text-mining.html#cb507-12" tabindex="-1"></a>porcentajes <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(temp)<span class="sc">/</span><span class="dv">100</span></span></code></pre></div>
</details>
<ol start="103" style="list-style-type: decimal">
<li>We find in the <code>no_decide</code> column the value of “N/A” when by percentages of <code>permanecer</code> plus <code>salir</code> sum 100%. Therefore, <code>no_decide</code> should be zero in those cases and not “N/A”. Store the values of <code>no_decide</code> in the <code>no_decide</code> vector and transform the “N/A” values to 0%</li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="string-processing-and-text-mining.html#cb508-1" tabindex="-1"></a>no_decide <span class="ot">&lt;-</span> encuestas<span class="sc">$</span>no_decide</span>
<span id="cb508-2"><a href="string-processing-and-text-mining.html#cb508-2" tabindex="-1"></a></span>
<span id="cb508-3"><a href="string-processing-and-text-mining.html#cb508-3" tabindex="-1"></a><span class="fu">str_replace</span>(no_decide, <span class="st">&quot;N/A&quot;</span>, <span class="st">&quot;0%&quot;</span>)</span></code></pre></div>
</details>
<ol start="104" style="list-style-type: decimal">
<li>Create the function <code>formato_porcentaje(cadena)</code> where you consolidate the transformations performed in the previous exercises. Then test the function with the vector: <code>c("13.5%", "N/A", "10%")</code></li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="string-processing-and-text-mining.html#cb509-1" tabindex="-1"></a></span>
<span id="cb509-2"><a href="string-processing-and-text-mining.html#cb509-2" tabindex="-1"></a>formato_porcentaje <span class="ot">&lt;-</span> <span class="cf">function</span>(cadena){</span>
<span id="cb509-3"><a href="string-processing-and-text-mining.html#cb509-3" tabindex="-1"></a>  cadena <span class="sc">|&gt;</span> </span>
<span id="cb509-4"><a href="string-processing-and-text-mining.html#cb509-4" tabindex="-1"></a>    <span class="fu">str_replace</span>(<span class="st">&quot;N/A&quot;</span>, <span class="st">&quot;0%&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb509-5"><a href="string-processing-and-text-mining.html#cb509-5" tabindex="-1"></a>    <span class="fu">parse_number</span>()<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb509-6"><a href="string-processing-and-text-mining.html#cb509-6" tabindex="-1"></a>}</span>
<span id="cb509-7"><a href="string-processing-and-text-mining.html#cb509-7" tabindex="-1"></a></span>
<span id="cb509-8"><a href="string-processing-and-text-mining.html#cb509-8" tabindex="-1"></a><span class="co"># Function test:</span></span>
<span id="cb509-9"><a href="string-processing-and-text-mining.html#cb509-9" tabindex="-1"></a>prueba <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;13.5%&quot;</span>, <span class="st">&quot;N/A&quot;</span>, <span class="st">&quot;10%&quot;</span>)</span>
<span id="cb509-10"><a href="string-processing-and-text-mining.html#cb509-10" tabindex="-1"></a></span>
<span id="cb509-11"><a href="string-processing-and-text-mining.html#cb509-11" tabindex="-1"></a><span class="fu">formato_porcentaje</span>(prueba)</span></code></pre></div>
</details>
<ol start="105" style="list-style-type: decimal">
<li>Modify the columns of the <code>encuestas</code> table to change the necessary values from text to numbers.</li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="string-processing-and-text-mining.html#cb510-1" tabindex="-1"></a>encuestas <span class="ot">&lt;-</span> encuestas <span class="sc">|&gt;</span> </span>
<span id="cb510-2"><a href="string-processing-and-text-mining.html#cb510-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">&quot;permanecer&quot;</span>, <span class="st">&quot;salir&quot;</span>, <span class="st">&quot;no_decide&quot;</span>, <span class="st">&quot;spread&quot;</span>), <span class="sc">~</span><span class="fu">formato_porcentaje</span>(.))) <span class="sc">|&gt;</span> </span>
<span id="cb510-3"><a href="string-processing-and-text-mining.html#cb510-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">&quot;muestra&quot;</span>), <span class="sc">~</span><span class="fu">parse_number</span>(.)))</span></code></pre></div>
</details>
<ol start="106" style="list-style-type: decimal">
<li>Import the following file containing covid cases reported by the Ministry of Health of Peru from the following route: “<a href="https://www.datosabiertos.gob.pe/sites/default/files/DATOSABIERTOS_SISCOVID.csv" class="uri">https://www.datosabiertos.gob.pe/sites/default/files/DATOSABIERTOS_SISCOVID.csv</a>” into the <code>covidPeru</code> object. Convert the birth date column to date type and create a histogram with the ages of the infected.</li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="string-processing-and-text-mining.html#cb511-1" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://www.datosabiertos.gob.pe/sites/default/files/DATOSABIERTOS_SISCOVID.csv&quot;</span></span>
<span id="cb511-2"><a href="string-processing-and-text-mining.html#cb511-2" tabindex="-1"></a>covidPeru <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(url)</span>
<span id="cb511-3"><a href="string-processing-and-text-mining.html#cb511-3" tabindex="-1"></a></span>
<span id="cb511-4"><a href="string-processing-and-text-mining.html#cb511-4" tabindex="-1"></a><span class="co"># We look for those that do not follow the ISO 8601 standard:</span></span>
<span id="cb511-5"><a href="string-processing-and-text-mining.html#cb511-5" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(covidPeru<span class="sc">$</span>FECHA_NACIMIENTO, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d{4}-</span><span class="sc">\\</span><span class="st">d{2}-</span><span class="sc">\\</span><span class="st">d{2}&quot;</span>)</span>
<span id="cb511-6"><a href="string-processing-and-text-mining.html#cb511-6" tabindex="-1"></a>covidPeru<span class="sc">$</span>FECHA_NACIMIENTO[<span class="sc">!</span>index]</span>
<span id="cb511-7"><a href="string-processing-and-text-mining.html#cb511-7" tabindex="-1"></a></span>
<span id="cb511-8"><a href="string-processing-and-text-mining.html#cb511-8" tabindex="-1"></a><span class="co"># We see dates in DD/MM/YYYY format</span></span>
<span id="cb511-9"><a href="string-processing-and-text-mining.html#cb511-9" tabindex="-1"></a><span class="co"># Reemplazamos a formato ISO 8601:</span></span>
<span id="cb511-10"><a href="string-processing-and-text-mining.html#cb511-10" tabindex="-1"></a>covidPeru <span class="ot">&lt;-</span> covidPeru <span class="sc">|&gt;</span> </span>
<span id="cb511-11"><a href="string-processing-and-text-mining.html#cb511-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="st">&quot;FECHA_NACIMIENTO&quot;</span>, </span>
<span id="cb511-12"><a href="string-processing-and-text-mining.html#cb511-12" tabindex="-1"></a>            <span class="sc">~</span><span class="fu">str_replace</span>(., <span class="st">&quot;(</span><span class="sc">\\</span><span class="st">d{2})/(</span><span class="sc">\\</span><span class="st">d{2})/(</span><span class="sc">\\</span><span class="st">d{4})&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">3-</span><span class="sc">\\</span><span class="st">2-</span><span class="sc">\\</span><span class="st">1&quot;</span>)</span>
<span id="cb511-13"><a href="string-processing-and-text-mining.html#cb511-13" tabindex="-1"></a>            ))</span>
<span id="cb511-14"><a href="string-processing-and-text-mining.html#cb511-14" tabindex="-1"></a></span>
<span id="cb511-15"><a href="string-processing-and-text-mining.html#cb511-15" tabindex="-1"></a><span class="co"># We search again for those that do not follow ISO 8601 standard:</span></span>
<span id="cb511-16"><a href="string-processing-and-text-mining.html#cb511-16" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(covidPeru<span class="sc">$</span>FECHA_NACIMIENTO, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d{4}-</span><span class="sc">\\</span><span class="st">d{2}-</span><span class="sc">\\</span><span class="st">d{2}&quot;</span>)</span>
<span id="cb511-17"><a href="string-processing-and-text-mining.html#cb511-17" tabindex="-1"></a>covidPeru<span class="sc">$</span>FECHA_NACIMIENTO[<span class="sc">!</span>index]</span>
<span id="cb511-18"><a href="string-processing-and-text-mining.html#cb511-18" tabindex="-1"></a></span>
<span id="cb511-19"><a href="string-processing-and-text-mining.html#cb511-19" tabindex="-1"></a><span class="co"># Convert column to date:</span></span>
<span id="cb511-20"><a href="string-processing-and-text-mining.html#cb511-20" tabindex="-1"></a>covidPeru <span class="ot">&lt;-</span> covidPeru <span class="sc">|&gt;</span> </span>
<span id="cb511-21"><a href="string-processing-and-text-mining.html#cb511-21" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="st">&quot;FECHA_NACIMIENTO&quot;</span>, <span class="sc">~</span><span class="fu">ymd</span>(.)))</span>
<span id="cb511-22"><a href="string-processing-and-text-mining.html#cb511-22" tabindex="-1"></a></span>
<span id="cb511-23"><a href="string-processing-and-text-mining.html#cb511-23" tabindex="-1"></a><span class="co"># Now that it is date format we create histogram:</span></span>
<span id="cb511-24"><a href="string-processing-and-text-mining.html#cb511-24" tabindex="-1"></a>covidPeru <span class="sc">|&gt;</span> </span>
<span id="cb511-25"><a href="string-processing-and-text-mining.html#cb511-25" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">edad =</span> <span class="fu">year</span>(<span class="fu">now</span>()) <span class="sc">-</span> <span class="fu">year</span>(FECHA_NACIMIENTO)) <span class="sc">|&gt;</span> </span>
<span id="cb511-26"><a href="string-processing-and-text-mining.html#cb511-26" tabindex="-1"></a>  <span class="fu">pull</span>(edad) <span class="sc">|&gt;</span> </span>
<span id="cb511-27"><a href="string-processing-and-text-mining.html#cb511-27" tabindex="-1"></a>  <span class="fu">hist</span>()</span></code></pre></div>
</details>
</div>
<div id="text-mining-word-cloud" class="section level2 hasAnchor" number="11.5">
<h2><span class="header-section-number">11.5</span> Text Mining: Word Cloud<a href="string-processing-and-text-mining.html#text-mining-word-cloud" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Text mining is the discovery by computer of new information, previously unknown, by automatically extracting information from different written resources. Written resources can be websites, books, chats, comments, emails, reviews, articles, etc. Thus, text mining, also known as text data mining, approximately equivalent to text analysis, is the process of deriving high-quality information from text.</p>
<p>The first text mining technique we will learn will be the construction of word clouds. For this, we will need to install packages developed exclusively for text mining and some libraries for text treatment that we had already used like <code>readr</code> or <code>stringr</code>:</p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="string-processing-and-text-mining.html#cb512-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;syuzhet&quot;</span>)</span>
<span id="cb512-2"><a href="string-processing-and-text-mining.html#cb512-2" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tm&quot;</span>)</span>
<span id="cb512-3"><a href="string-processing-and-text-mining.html#cb512-3" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;wordcloud&quot;</span>)</span>
<span id="cb512-4"><a href="string-processing-and-text-mining.html#cb512-4" tabindex="-1"></a></span>
<span id="cb512-5"><a href="string-processing-and-text-mining.html#cb512-5" tabindex="-1"></a><span class="fu">library</span>(syuzhet) <span class="co"># Functions get_</span></span>
<span id="cb512-6"><a href="string-processing-and-text-mining.html#cb512-6" tabindex="-1"></a><span class="fu">library</span>(stringr) <span class="co"># Functions str_</span></span>
<span id="cb512-7"><a href="string-processing-and-text-mining.html#cb512-7" tabindex="-1"></a><span class="fu">library</span>(tm) <span class="co"># text mining functions</span></span>
<span id="cb512-8"><a href="string-processing-and-text-mining.html#cb512-8" tabindex="-1"></a><span class="fu">library</span>(wordcloud) <span class="co"># Create cloud map</span></span></code></pre></div>
<div id="importing-data" class="section level3 hasAnchor" number="11.5.1">
<h3><span class="header-section-number">11.5.1</span> Importing data<a href="string-processing-and-text-mining.html#importing-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Word maps or word clouds allow us to quickly identify which are the words that are repeated most in a text. They are very useful when we have fields that come from a form, for example, filled out by customers and we want to know what is being talked about more. It also helps us to analyze content in some book, magazine, etc.</p>
<p>We are going to analyze the work “Niebla” written by the author Miguel de Unamuno. We will obtain the text from the <a href="www.gutenberg.org">Project Gutenberg</a><a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a> website, which gives us access to a library of around 60 thousand free books. We will import the text using the <code>get_text_as_string()</code> function from the <code>syuzhet</code> library to import all the text as a string. This function is very useful if we wish to import large files. Then, we will use the <code>get_sentences()</code> function, to create a vector of sentences from the initial text.</p>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="string-processing-and-text-mining.html#cb513-1" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;http://www.gutenberg.org/files/49836/49836-0.txt&quot;</span></span>
<span id="cb513-2"><a href="string-processing-and-text-mining.html#cb513-2" tabindex="-1"></a></span>
<span id="cb513-3"><a href="string-processing-and-text-mining.html#cb513-3" tabindex="-1"></a>work <span class="ot">&lt;-</span> <span class="fu">get_text_as_string</span>(url)</span>
<span id="cb513-4"><a href="string-processing-and-text-mining.html#cb513-4" tabindex="-1"></a></span>
<span id="cb513-5"><a href="string-processing-and-text-mining.html#cb513-5" tabindex="-1"></a>sentences <span class="ot">&lt;-</span> <span class="fu">get_sentences</span>(work)</span></code></pre></div>
</div>
<div id="text-cleaning" class="section level3 hasAnchor" number="11.5.2">
<h3><span class="header-section-number">11.5.2</span> Text cleaning<a href="string-processing-and-text-mining.html#text-cleaning" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As we have learned previously, we do not have to go straight to analyze. Instead, we have to clean our data. The first thing we will do is eliminate the first rows that do not correspond to the work.</p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="string-processing-and-text-mining.html#cb514-1" tabindex="-1"></a><span class="co"># We eliminate first rows of notes, prologue, post-prologue</span></span>
<span id="cb514-2"><a href="string-processing-and-text-mining.html#cb514-2" tabindex="-1"></a>total_lines <span class="ot">&lt;-</span> <span class="fu">length</span>(sentences)</span>
<span id="cb514-3"><a href="string-processing-and-text-mining.html#cb514-3" tabindex="-1"></a>start_line <span class="ot">&lt;-</span> <span class="dv">115</span></span>
<span id="cb514-4"><a href="string-processing-and-text-mining.html#cb514-4" tabindex="-1"></a>end_line <span class="ot">&lt;-</span> total_lines <span class="sc">-</span> start_line</span>
<span id="cb514-5"><a href="string-processing-and-text-mining.html#cb514-5" tabindex="-1"></a></span>
<span id="cb514-6"><a href="string-processing-and-text-mining.html#cb514-6" tabindex="-1"></a>clean_text <span class="ot">&lt;-</span> sentences[start_line<span class="sc">:</span>end_line]</span></code></pre></div>
<p>Next we will use a regex to detect special encoding characters, such as line breaks and tabulations. For this we will use the regex <code>[[:cntrl:]]</code>. Likewise, we will convert all words to lower case to facilitate comparisons between words. Finally, as we want to analyze the words, we eliminate all punctuation marks.</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="string-processing-and-text-mining.html#cb515-1" tabindex="-1"></a>clean_text <span class="ot">&lt;-</span> clean_text <span class="sc">|&gt;</span> </span>
<span id="cb515-2"><a href="string-processing-and-text-mining.html#cb515-2" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(<span class="st">&quot;[[:cntrl:]]&quot;</span>, <span class="st">&quot; &quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb515-3"><a href="string-processing-and-text-mining.html#cb515-3" tabindex="-1"></a>  <span class="fu">str_to_lower</span>() <span class="sc">|&gt;</span> </span>
<span id="cb515-4"><a href="string-processing-and-text-mining.html#cb515-4" tabindex="-1"></a>  <span class="fu">removePunctuation</span>() <span class="sc">|&gt;</span> </span>
<span id="cb515-5"><a href="string-processing-and-text-mining.html#cb515-5" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(<span class="st">&quot;—&quot;</span>, <span class="st">&quot; &quot;</span>)</span></code></pre></div>
<p>On the other hand, the “tm” library, from <em>text mining</em>, provides us with functions and vectors to clean our data. We already used the <code>removePunctuation()</code> function. However, we also have the <code>stopwords("spanish")</code> function that calls a vector with <em>empty words</em>, that is, those with little value for analysis, such as some prepositions and fillers. In addition, we will use the <code>removeWords()</code> function to remove all words found in our <em>empty words</em> vector.</p>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="string-processing-and-text-mining.html#cb516-1" tabindex="-1"></a>clean_text <span class="ot">&lt;-</span> <span class="fu">removeWords</span>(clean_text, <span class="at">words =</span> <span class="fu">stopwords</span>(<span class="st">&quot;spanish&quot;</span>))</span></code></pre></div>
<p>Finally, we eliminate excessive empty spaces, some of them created by the previous transformations.</p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="string-processing-and-text-mining.html#cb517-1" tabindex="-1"></a>clean_text <span class="ot">&lt;-</span> <span class="fu">stripWhitespace</span>(clean_text)</span></code></pre></div>
</div>
<div id="creating-the-corpus" class="section level3 hasAnchor" number="11.5.3">
<h3><span class="header-section-number">11.5.3</span> Creating the Corpus<a href="string-processing-and-text-mining.html#creating-the-corpus" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To be able to create a word map we need to apply the <code>VectorSource()</code> function to convert each row to a document and the <code>Corpus()</code> function that will allow us to create these documents as a data collection.</p>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="string-processing-and-text-mining.html#cb518-1" tabindex="-1"></a>collection <span class="ot">&lt;-</span> clean_text <span class="sc">|&gt;</span> </span>
<span id="cb518-2"><a href="string-processing-and-text-mining.html#cb518-2" tabindex="-1"></a>  <span class="fu">VectorSource</span>() <span class="sc">|&gt;</span></span>
<span id="cb518-3"><a href="string-processing-and-text-mining.html#cb518-3" tabindex="-1"></a>  <span class="fu">Corpus</span>()</span></code></pre></div>
<p>We are ready to create our word map. For this we will use the <code>wordcloud()</code> library and the function of the same name.</p>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="string-processing-and-text-mining.html#cb519-1" tabindex="-1"></a><span class="fu">wordcloud</span>(collection, </span>
<span id="cb519-2"><a href="string-processing-and-text-mining.html#cb519-2" tabindex="-1"></a>          <span class="at">min.freq =</span> <span class="dv">5</span>,</span>
<span id="cb519-3"><a href="string-processing-and-text-mining.html#cb519-3" tabindex="-1"></a>          <span class="at">max.words =</span> <span class="dv">80</span>, </span>
<span id="cb519-4"><a href="string-processing-and-text-mining.html#cb519-4" tabindex="-1"></a>          <span class="at">random.order =</span> <span class="cn">FALSE</span>, </span>
<span id="cb519-5"><a href="string-processing-and-text-mining.html#cb519-5" tabindex="-1"></a>          <span class="at">colors =</span> <span class="fu">brewer.pal</span>(<span class="at">name =</span> <span class="st">&quot;Dark2&quot;</span>, <span class="at">n =</span> <span class="dv">8</span>)</span>
<span id="cb519-6"><a href="string-processing-and-text-mining.html#cb519-6" tabindex="-1"></a>          )</span></code></pre></div>
<p><img src="Data-Science-with-R_files/figure-html/unnamed-chunk-667-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="nd-data-cleaning" class="section level3 hasAnchor" number="11.5.4">
<h3><span class="header-section-number">11.5.4</span> 2nd Data Cleaning<a href="string-processing-and-text-mining.html#nd-data-cleaning" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In text mining we will frequently obtain a result that still requires cleaning more data. For example, we still see words like pronouns of little interest for analysis. We will use the <code>removeWords()</code> function again, but this time with a custom vector of the words we wish to remove.</p>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="string-processing-and-text-mining.html#cb520-1" tabindex="-1"></a>to_remove <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;usted&quot;</span>, <span class="st">&quot;pues&quot;</span>, <span class="st">&quot;tal&quot;</span>, <span class="st">&quot;tan&quot;</span>, <span class="st">&quot;así&quot;</span>, <span class="st">&quot;dijo&quot;</span>, </span>
<span id="cb520-2"><a href="string-processing-and-text-mining.html#cb520-2" tabindex="-1"></a>               <span class="st">&quot;cómo&quot;</span>, <span class="st">&quot;sino&quot;</span>, <span class="st">&quot;entonces&quot;</span>, <span class="st">&quot;aunque&quot;</span>, <span class="st">&quot;don&quot;</span>, <span class="st">&quot;doña&quot;</span>)</span>
<span id="cb520-3"><a href="string-processing-and-text-mining.html#cb520-3" tabindex="-1"></a></span>
<span id="cb520-4"><a href="string-processing-and-text-mining.html#cb520-4" tabindex="-1"></a>clean_text <span class="ot">&lt;-</span> <span class="fu">removeWords</span>(clean_text, <span class="at">words =</span> to_remove)</span>
<span id="cb520-5"><a href="string-processing-and-text-mining.html#cb520-5" tabindex="-1"></a></span>
<span id="cb520-6"><a href="string-processing-and-text-mining.html#cb520-6" tabindex="-1"></a>collection <span class="ot">&lt;-</span> clean_text <span class="sc">|&gt;</span> </span>
<span id="cb520-7"><a href="string-processing-and-text-mining.html#cb520-7" tabindex="-1"></a>  <span class="fu">VectorSource</span>() <span class="sc">|&gt;</span></span>
<span id="cb520-8"><a href="string-processing-and-text-mining.html#cb520-8" tabindex="-1"></a>  <span class="fu">Corpus</span>()</span>
<span id="cb520-9"><a href="string-processing-and-text-mining.html#cb520-9" tabindex="-1"></a></span>
<span id="cb520-10"><a href="string-processing-and-text-mining.html#cb520-10" tabindex="-1"></a><span class="fu">wordcloud</span>(collection, </span>
<span id="cb520-11"><a href="string-processing-and-text-mining.html#cb520-11" tabindex="-1"></a>          <span class="at">min.freq =</span> <span class="dv">5</span>,</span>
<span id="cb520-12"><a href="string-processing-and-text-mining.html#cb520-12" tabindex="-1"></a>          <span class="at">max.words =</span> <span class="dv">80</span>, </span>
<span id="cb520-13"><a href="string-processing-and-text-mining.html#cb520-13" tabindex="-1"></a>          <span class="at">random.order =</span> <span class="cn">FALSE</span>, </span>
<span id="cb520-14"><a href="string-processing-and-text-mining.html#cb520-14" tabindex="-1"></a>          <span class="at">colors =</span> <span class="fu">brewer.pal</span>(<span class="at">name =</span> <span class="st">&quot;Dark2&quot;</span>, <span class="at">n =</span> <span class="dv">8</span>)</span>
<span id="cb520-15"><a href="string-processing-and-text-mining.html#cb520-15" tabindex="-1"></a>          )</span></code></pre></div>
<p><img src="Data-Science-with-R_files/figure-html/unnamed-chunk-668-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>Augusto and Eugenia, as we can assume, are the protagonists of <strong>Niebla</strong> and much of the action in this book occurs in the “house” of one or another protagonist, discussing relationships between “man” and “woman”.</p>
</div>
<div id="word-frequency" class="section level3 hasAnchor" number="11.5.5">
<h3><span class="header-section-number">11.5.5</span> Word frequency<a href="string-processing-and-text-mining.html#word-frequency" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We already have a visual idea of the most used words. However, we could also know exactly how many times a certain word appeared. For this we have to convert our collection to a matrix. For this we use the functions together <code>TermDocumentMatrix()</code>, <code>as.matrix()</code> and <code>rowSums()</code> which will leave us with a vector with the word frequency.</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="string-processing-and-text-mining.html#cb521-1" tabindex="-1"></a>words_vec <span class="ot">&lt;-</span> collection <span class="sc">|&gt;</span> </span>
<span id="cb521-2"><a href="string-processing-and-text-mining.html#cb521-2" tabindex="-1"></a>  <span class="fu">TermDocumentMatrix</span>() <span class="sc">|&gt;</span> </span>
<span id="cb521-3"><a href="string-processing-and-text-mining.html#cb521-3" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">|&gt;</span> </span>
<span id="cb521-4"><a href="string-processing-and-text-mining.html#cb521-4" tabindex="-1"></a>  <span class="fu">rowSums</span>() <span class="sc">|&gt;</span> </span>
<span id="cb521-5"><a href="string-processing-and-text-mining.html#cb521-5" tabindex="-1"></a>  <span class="fu">sort</span>(<span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb521-6"><a href="string-processing-and-text-mining.html#cb521-6" tabindex="-1"></a></span>
<span id="cb521-7"><a href="string-processing-and-text-mining.html#cb521-7" tabindex="-1"></a>words_vec <span class="sc">|&gt;</span> </span>
<span id="cb521-8"><a href="string-processing-and-text-mining.html#cb521-8" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>)</span>
<span id="cb521-9"><a href="string-processing-and-text-mining.html#cb521-9" tabindex="-1"></a><span class="co">#&gt; augusto eugenia   mujer    casa   ahora    bien  hombre     ser   mismo     vez </span></span>
<span id="cb521-10"><a href="string-processing-and-text-mining.html#cb521-10" tabindex="-1"></a><span class="co">#&gt;     361     200     183     126     120     119     119      98      98      90 </span></span>
<span id="cb521-11"><a href="string-processing-and-text-mining.html#cb521-11" tabindex="-1"></a><span class="co">#&gt;    ojos    vida      sé   cosas     fué   madre después   pobre   luego     dos </span></span>
<span id="cb521-12"><a href="string-processing-and-text-mining.html#cb521-12" tabindex="-1"></a><span class="co">#&gt;      86      84      82      71      71      71      71      69      69      69</span></span></code></pre></div>
<p>With this vector it is easy to convert it to data frame, given that we have the names and values, and visualize it.</p>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="string-processing-and-text-mining.html#cb522-1" tabindex="-1"></a>frequencies <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb522-2"><a href="string-processing-and-text-mining.html#cb522-2" tabindex="-1"></a>  <span class="at">palabra =</span> <span class="fu">names</span>(words_vec),</span>
<span id="cb522-3"><a href="string-processing-and-text-mining.html#cb522-3" tabindex="-1"></a>  <span class="at">frecuencia =</span> words_vec</span>
<span id="cb522-4"><a href="string-processing-and-text-mining.html#cb522-4" tabindex="-1"></a>)</span>
<span id="cb522-5"><a href="string-processing-and-text-mining.html#cb522-5" tabindex="-1"></a></span>
<span id="cb522-6"><a href="string-processing-and-text-mining.html#cb522-6" tabindex="-1"></a><span class="co"># Visualization of top 10 words:</span></span>
<span id="cb522-7"><a href="string-processing-and-text-mining.html#cb522-7" tabindex="-1"></a>frequencies[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,] <span class="sc">|&gt;</span> </span>
<span id="cb522-8"><a href="string-processing-and-text-mining.html#cb522-8" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb522-9"><a href="string-processing-and-text-mining.html#cb522-9" tabindex="-1"></a>  <span class="fu">aes</span>(frecuencia, <span class="at">y =</span> <span class="fu">reorder</span>(palabra, frecuencia)) <span class="sc">+</span></span>
<span id="cb522-10"><a href="string-processing-and-text-mining.html#cb522-10" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb522-11"><a href="string-processing-and-text-mining.html#cb522-11" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> frecuencia, <span class="at">hjust =</span> <span class="fl">1.5</span>), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb522-12"><a href="string-processing-and-text-mining.html#cb522-12" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb522-13"><a href="string-processing-and-text-mining.html#cb522-13" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb522-14"><a href="string-processing-and-text-mining.html#cb522-14" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Most used words in the work&quot;</span></span>
<span id="cb522-15"><a href="string-processing-and-text-mining.html#cb522-15" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="Data-Science-with-R_files/figure-html/unnamed-chunk-670-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="text-mining-sentiment-analysis" class="section level2 hasAnchor" number="11.6">
<h2><span class="header-section-number">11.6</span> Text Mining: Sentiment Analysis<a href="string-processing-and-text-mining.html#text-mining-sentiment-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When we analyze texts we are not only going to want to know which are the words that are most utilized in texts, whether these are comments left by our customers, complaint requests, etc. It is also very useful to know the tone of the messages. This technique is known as sentiment analysis, which can be done very easily with the library that we have already used <code>syuzhet</code>.</p>
<p>And what better place to analyze message tones than on Twitter. For this, we are going to download a history of Tweets from some Spanish-speaking character from the page vicinitas.io. This page allows us to download an excel given a public account:</p>
<p><a href="https://www.vicinitas.io/free-tools/download-user-tweets" class="uri">https://www.vicinitas.io/free-tools/download-user-tweets</a>.</p>
<div align="center">
<p><img src="_assets/images/05-wrangling/download-user-tweets.png" alt="Vicinitas.io interface for downloading user tweets from Twitter" width="80%" style="display: block; margin: auto;" /></p>
</div>
<p>For our example, we will use tweets from the account of the lawyer <a href="https://twitter.com/rmapalacios">Rosa María Palacios</a><a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a>. For this example the excel has already been uploaded to Github. We will download that excel directly from there to our computer to a temporary file and then we will read it using <code>read_excel()</code>.</p>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="string-processing-and-text-mining.html#cb523-1" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://dparedesi.github.io/DS-con-R/rmapalacios_user_tweets.xlsx&quot;</span></span>
<span id="cb523-2"><a href="string-processing-and-text-mining.html#cb523-2" tabindex="-1"></a></span>
<span id="cb523-3"><a href="string-processing-and-text-mining.html#cb523-3" tabindex="-1"></a><span class="co"># Create a temporary name &amp; path for our file.</span></span>
<span id="cb523-4"><a href="string-processing-and-text-mining.html#cb523-4" tabindex="-1"></a>temp_file <span class="ot">&lt;-</span> <span class="fu">tempfile</span>()</span>
<span id="cb523-5"><a href="string-processing-and-text-mining.html#cb523-5" tabindex="-1"></a></span>
<span id="cb523-6"><a href="string-processing-and-text-mining.html#cb523-6" tabindex="-1"></a><span class="co"># Download the file to our temp</span></span>
<span id="cb523-7"><a href="string-processing-and-text-mining.html#cb523-7" tabindex="-1"></a><span class="fu">download.file</span>(url, temp_file)</span>
<span id="cb523-8"><a href="string-processing-and-text-mining.html#cb523-8" tabindex="-1"></a></span>
<span id="cb523-9"><a href="string-processing-and-text-mining.html#cb523-9" tabindex="-1"></a><span class="co"># Import the excel</span></span>
<span id="cb523-10"><a href="string-processing-and-text-mining.html#cb523-10" tabindex="-1"></a>posts <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(temp_file)</span>
<span id="cb523-11"><a href="string-processing-and-text-mining.html#cb523-11" tabindex="-1"></a></span>
<span id="cb523-12"><a href="string-processing-and-text-mining.html#cb523-12" tabindex="-1"></a><span class="co"># Remove the temporary file</span></span>
<span id="cb523-13"><a href="string-processing-and-text-mining.html#cb523-13" tabindex="-1"></a><span class="fu">file.remove</span>(temp_file)</span>
<span id="cb523-14"><a href="string-processing-and-text-mining.html#cb523-14" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>We have created our object <code>posts</code>, which has in the column <code>Text</code> the different <em>tweets</em>, <em>retweets</em> and <em>replies</em>, performed. Although we could do a data analysis using the other columns, we are going to focus on the content and tone of the Tweets. For this, we are going to eliminate Retweets and replies, keeping only Tweets.</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="string-processing-and-text-mining.html#cb524-1" tabindex="-1"></a>tweets <span class="ot">&lt;-</span> posts <span class="sc">|&gt;</span> </span>
<span id="cb524-2"><a href="string-processing-and-text-mining.html#cb524-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Tweet Type</span><span class="st">`</span> <span class="sc">==</span> <span class="st">&quot;Tweet&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb524-3"><a href="string-processing-and-text-mining.html#cb524-3" tabindex="-1"></a>  <span class="fu">pull</span>(Text)</span></code></pre></div>
<p>With what was learned doing word maps, let’s create a map with the content of the publications.</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="string-processing-and-text-mining.html#cb525-1" tabindex="-1"></a>tweets_limpio <span class="ot">&lt;-</span> tweets <span class="sc">|&gt;</span> </span>
<span id="cb525-2"><a href="string-processing-and-text-mining.html#cb525-2" tabindex="-1"></a>  <span class="fu">removePunctuation</span>() <span class="sc">|&gt;</span> </span>
<span id="cb525-3"><a href="string-processing-and-text-mining.html#cb525-3" tabindex="-1"></a>  <span class="fu">str_to_lower</span>() <span class="sc">|&gt;</span> </span>
<span id="cb525-4"><a href="string-processing-and-text-mining.html#cb525-4" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(<span class="st">&quot;[[:cntrl:]]&quot;</span>, <span class="st">&quot; &quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb525-5"><a href="string-processing-and-text-mining.html#cb525-5" tabindex="-1"></a>  <span class="fu">removeWords</span>(<span class="at">words =</span> <span class="fu">stopwords</span>(<span class="st">&quot;spanish&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb525-6"><a href="string-processing-and-text-mining.html#cb525-6" tabindex="-1"></a>  <span class="fu">removeWords</span>(<span class="at">words =</span> <span class="fu">c</span>(<span class="st">&quot;usted&quot;</span>, <span class="st">&quot;pues&quot;</span>, <span class="st">&quot;tal&quot;</span>, <span class="st">&quot;tan&quot;</span>,</span>
<span id="cb525-7"><a href="string-processing-and-text-mining.html#cb525-7" tabindex="-1"></a>                                      <span class="st">&quot;así&quot;</span>, <span class="st">&quot;dijo&quot;</span>, <span class="st">&quot;cómo&quot;</span>, <span class="st">&quot;sino&quot;</span>, </span>
<span id="cb525-8"><a href="string-processing-and-text-mining.html#cb525-8" tabindex="-1"></a>                                      <span class="st">&quot;entonces&quot;</span>, <span class="st">&quot;aunque&quot;</span>, <span class="st">&quot;que&quot;</span>))</span>
<span id="cb525-9"><a href="string-processing-and-text-mining.html#cb525-9" tabindex="-1"></a></span>
<span id="cb525-10"><a href="string-processing-and-text-mining.html#cb525-10" tabindex="-1"></a>collection <span class="ot">&lt;-</span> tweets_limpio <span class="sc">|&gt;</span> </span>
<span id="cb525-11"><a href="string-processing-and-text-mining.html#cb525-11" tabindex="-1"></a>  <span class="fu">VectorSource</span>() <span class="sc">|&gt;</span></span>
<span id="cb525-12"><a href="string-processing-and-text-mining.html#cb525-12" tabindex="-1"></a>  <span class="fu">Corpus</span>()</span>
<span id="cb525-13"><a href="string-processing-and-text-mining.html#cb525-13" tabindex="-1"></a></span>
<span id="cb525-14"><a href="string-processing-and-text-mining.html#cb525-14" tabindex="-1"></a><span class="fu">wordcloud</span>(collection, </span>
<span id="cb525-15"><a href="string-processing-and-text-mining.html#cb525-15" tabindex="-1"></a>          <span class="at">min.freq =</span> <span class="dv">5</span>,</span>
<span id="cb525-16"><a href="string-processing-and-text-mining.html#cb525-16" tabindex="-1"></a>          <span class="at">max.words =</span> <span class="dv">80</span>, </span>
<span id="cb525-17"><a href="string-processing-and-text-mining.html#cb525-17" tabindex="-1"></a>          <span class="at">random.order =</span> <span class="cn">FALSE</span>, </span>
<span id="cb525-18"><a href="string-processing-and-text-mining.html#cb525-18" tabindex="-1"></a>          <span class="at">colors =</span> <span class="fu">brewer.pal</span>(<span class="at">name =</span> <span class="st">&quot;Dark2&quot;</span>, <span class="at">n =</span> <span class="dv">8</span>)</span>
<span id="cb525-19"><a href="string-processing-and-text-mining.html#cb525-19" tabindex="-1"></a>          )</span></code></pre></div>
<p><img src="Data-Science-with-R_files/figure-html/unnamed-chunk-674-1.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>She is a lawyer, which makes a lot of sense that she posts content of what can or cannot be done. We could be more rigorous and seek to achieve this combination by adding underscores if the pattern is detected, but for the moment we are going to focus on the tone.</p>
<p>With our object <code>tweets_limpio</code> we can obtain what the tone is using the function <code>get_nrc_sentiment()</code>, which gives us a score for each row of the vector according to the <a href="https://saifmohammad.com/WebPages/NRC-Emotion-Lexicon.htm">NRC Emotion Lexicon</a><a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a>. The NRC Emotion Lexicon is a list of words and their associations with eight basic emotions (anger, fear, anticipation, trust, surprise, sadness, joy, and disgust) and two sentiments (negative and positive).</p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="string-processing-and-text-mining.html#cb526-1" tabindex="-1"></a></span>
<span id="cb526-2"><a href="string-processing-and-text-mining.html#cb526-2" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">get_nrc_sentiment</span>(tweets_limpio, <span class="at">language =</span> <span class="st">&quot;spanish&quot;</span>)</span>
<span id="cb526-3"><a href="string-processing-and-text-mining.html#cb526-3" tabindex="-1"></a></span>
<span id="cb526-4"><a href="string-processing-and-text-mining.html#cb526-4" tabindex="-1"></a>result <span class="sc">|&gt;</span> </span>
<span id="cb526-5"><a href="string-processing-and-text-mining.html#cb526-5" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb526-6"><a href="string-processing-and-text-mining.html#cb526-6" tabindex="-1"></a><span class="co">#&gt;    anger anticipation disgust fear joy sadness surprise trust negative positive</span></span>
<span id="cb526-7"><a href="string-processing-and-text-mining.html#cb526-7" tabindex="-1"></a><span class="co">#&gt; 1      0            1       0    2   1       3        0     3        5        3</span></span>
<span id="cb526-8"><a href="string-processing-and-text-mining.html#cb526-8" tabindex="-1"></a><span class="co">#&gt; 2      4            0       3    5   0       3        0     0        7        0</span></span>
<span id="cb526-9"><a href="string-processing-and-text-mining.html#cb526-9" tabindex="-1"></a><span class="co">#&gt; 3      0            0       0    0   0       0        0     0        0        0</span></span>
<span id="cb526-10"><a href="string-processing-and-text-mining.html#cb526-10" tabindex="-1"></a><span class="co">#&gt; 4      0            1       1    1   1       1        1     1        1        2</span></span>
<span id="cb526-11"><a href="string-processing-and-text-mining.html#cb526-11" tabindex="-1"></a><span class="co">#&gt; 5      0            2       0    1   3       1        0     4        0        4</span></span>
<span id="cb526-12"><a href="string-processing-and-text-mining.html#cb526-12" tabindex="-1"></a><span class="co">#&gt; 6      0            0       0    0   0       0        0     0        0        0</span></span>
<span id="cb526-13"><a href="string-processing-and-text-mining.html#cb526-13" tabindex="-1"></a><span class="co">#&gt; 7      1            1       0    3   0       1        0     1        3        0</span></span>
<span id="cb526-14"><a href="string-processing-and-text-mining.html#cb526-14" tabindex="-1"></a><span class="co">#&gt; 8      0            0       0    0   0       1        0     0        2        3</span></span>
<span id="cb526-15"><a href="string-processing-and-text-mining.html#cb526-15" tabindex="-1"></a><span class="co">#&gt; 9      1            0       1    1   0       1        0     0        1        0</span></span>
<span id="cb526-16"><a href="string-processing-and-text-mining.html#cb526-16" tabindex="-1"></a><span class="co">#&gt; 10     0            0       0    0   0       0        0     0        0        0</span></span></code></pre></div>
<p>We can perform some transformations to this data frame, but first we are going to create a translation function. Given that, we still have to translate the headers.</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="string-processing-and-text-mining.html#cb527-1" tabindex="-1"></a>translate_emotions <span class="ot">&lt;-</span> <span class="cf">function</span>(cadena){</span>
<span id="cb527-2"><a href="string-processing-and-text-mining.html#cb527-2" tabindex="-1"></a>  <span class="fu">case_when</span>(</span>
<span id="cb527-3"><a href="string-processing-and-text-mining.html#cb527-3" tabindex="-1"></a>    cadena <span class="sc">==</span> <span class="st">&quot;anger&quot;</span> <span class="sc">~</span> <span class="st">&quot;Ira&quot;</span>,</span>
<span id="cb527-4"><a href="string-processing-and-text-mining.html#cb527-4" tabindex="-1"></a>    cadena <span class="sc">==</span> <span class="st">&quot;anticipation&quot;</span> <span class="sc">~</span> <span class="st">&quot;Anticipación&quot;</span>,</span>
<span id="cb527-5"><a href="string-processing-and-text-mining.html#cb527-5" tabindex="-1"></a>    cadena <span class="sc">==</span> <span class="st">&quot;disgust&quot;</span> <span class="sc">~</span> <span class="st">&quot;Aversión&quot;</span>,</span>
<span id="cb527-6"><a href="string-processing-and-text-mining.html#cb527-6" tabindex="-1"></a>    cadena <span class="sc">==</span> <span class="st">&quot;fear&quot;</span> <span class="sc">~</span> <span class="st">&quot;Miedo&quot;</span>,</span>
<span id="cb527-7"><a href="string-processing-and-text-mining.html#cb527-7" tabindex="-1"></a>    cadena <span class="sc">==</span> <span class="st">&quot;joy&quot;</span> <span class="sc">~</span> <span class="st">&quot;Alegría&quot;</span>,</span>
<span id="cb527-8"><a href="string-processing-and-text-mining.html#cb527-8" tabindex="-1"></a>    cadena <span class="sc">==</span> <span class="st">&quot;sadness&quot;</span> <span class="sc">~</span> <span class="st">&quot;Tristeza&quot;</span>,</span>
<span id="cb527-9"><a href="string-processing-and-text-mining.html#cb527-9" tabindex="-1"></a>    cadena <span class="sc">==</span> <span class="st">&quot;surprise&quot;</span> <span class="sc">~</span> <span class="st">&quot;Asombro&quot;</span>,</span>
<span id="cb527-10"><a href="string-processing-and-text-mining.html#cb527-10" tabindex="-1"></a>    cadena <span class="sc">==</span> <span class="st">&quot;trust&quot;</span> <span class="sc">~</span> <span class="st">&quot;Confianza&quot;</span>,</span>
<span id="cb527-11"><a href="string-processing-and-text-mining.html#cb527-11" tabindex="-1"></a>    cadena <span class="sc">==</span> <span class="st">&quot;negative&quot;</span> <span class="sc">~</span> <span class="st">&quot;Negativo&quot;</span>,</span>
<span id="cb527-12"><a href="string-processing-and-text-mining.html#cb527-12" tabindex="-1"></a>    cadena <span class="sc">==</span> <span class="st">&quot;positive&quot;</span> <span class="sc">~</span> <span class="st">&quot;Positivo&quot;</span>,</span>
<span id="cb527-13"><a href="string-processing-and-text-mining.html#cb527-13" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> cadena</span>
<span id="cb527-14"><a href="string-processing-and-text-mining.html#cb527-14" tabindex="-1"></a>  )</span>
<span id="cb527-15"><a href="string-processing-and-text-mining.html#cb527-15" tabindex="-1"></a>}</span></code></pre></div>
<p>Now, with our function ready, we can transform our object <code>result</code> to obtain the frequencies of each emotion and sentiment.</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="string-processing-and-text-mining.html#cb528-1" tabindex="-1"></a><span class="co"># Summary of emotions/sentiments</span></span>
<span id="cb528-2"><a href="string-processing-and-text-mining.html#cb528-2" tabindex="-1"></a>sentiments <span class="ot">&lt;-</span> result <span class="sc">|&gt;</span> </span>
<span id="cb528-3"><a href="string-processing-and-text-mining.html#cb528-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;sentimiento&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;count&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb528-4"><a href="string-processing-and-text-mining.html#cb528-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sentimiento =</span> <span class="fu">translate_emotions</span>(sentimiento)) <span class="sc">|&gt;</span> </span>
<span id="cb528-5"><a href="string-processing-and-text-mining.html#cb528-5" tabindex="-1"></a>  <span class="fu">group_by</span>(sentimiento) <span class="sc">|&gt;</span> </span>
<span id="cb528-6"><a href="string-processing-and-text-mining.html#cb528-6" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(count))</span>
<span id="cb528-7"><a href="string-processing-and-text-mining.html#cb528-7" tabindex="-1"></a></span>
<span id="cb528-8"><a href="string-processing-and-text-mining.html#cb528-8" tabindex="-1"></a>sentiments</span>
<span id="cb528-9"><a href="string-processing-and-text-mining.html#cb528-9" tabindex="-1"></a><span class="co">#&gt; # A tibble: 10 × 2</span></span>
<span id="cb528-10"><a href="string-processing-and-text-mining.html#cb528-10" tabindex="-1"></a><span class="co">#&gt;    sentimiento  total</span></span>
<span id="cb528-11"><a href="string-processing-and-text-mining.html#cb528-11" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;        &lt;dbl&gt;</span></span>
<span id="cb528-12"><a href="string-processing-and-text-mining.html#cb528-12" tabindex="-1"></a><span class="co">#&gt;  1 Alegría        547</span></span>
<span id="cb528-13"><a href="string-processing-and-text-mining.html#cb528-13" tabindex="-1"></a><span class="co">#&gt;  2 Anticipación   903</span></span>
<span id="cb528-14"><a href="string-processing-and-text-mining.html#cb528-14" tabindex="-1"></a><span class="co">#&gt;  3 Asombro        421</span></span>
<span id="cb528-15"><a href="string-processing-and-text-mining.html#cb528-15" tabindex="-1"></a><span class="co">#&gt;  4 Aversión       810</span></span>
<span id="cb528-16"><a href="string-processing-and-text-mining.html#cb528-16" tabindex="-1"></a><span class="co">#&gt;  5 Confianza     1369</span></span>
<span id="cb528-17"><a href="string-processing-and-text-mining.html#cb528-17" tabindex="-1"></a><span class="co">#&gt;  6 Ira            803</span></span>
<span id="cb528-18"><a href="string-processing-and-text-mining.html#cb528-18" tabindex="-1"></a><span class="co">#&gt;  7 Miedo         1342</span></span>
<span id="cb528-19"><a href="string-processing-and-text-mining.html#cb528-19" tabindex="-1"></a><span class="co">#&gt;  8 Negativo      2334</span></span>
<span id="cb528-20"><a href="string-processing-and-text-mining.html#cb528-20" tabindex="-1"></a><span class="co">#&gt;  9 Positivo      2117</span></span>
<span id="cb528-21"><a href="string-processing-and-text-mining.html#cb528-21" tabindex="-1"></a><span class="co">#&gt; 10 Tristeza      1177</span></span></code></pre></div>
<p>We see that we have the 8 emotions plus the 2 sentiments. Let’s get the indices of the positive and negative sentiments:</p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="string-processing-and-text-mining.html#cb529-1" tabindex="-1"></a>index <span class="ot">&lt;-</span> sentiments<span class="sc">$</span>sentimiento <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Positivo&quot;</span>, <span class="st">&quot;Negativo&quot;</span>) </span></code></pre></div>
<p>This vector will serve us to be able to visualize separately the emotions and sentiments.</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="string-processing-and-text-mining.html#cb530-1" tabindex="-1"></a><span class="co"># Visualization of emotions</span></span>
<span id="cb530-2"><a href="string-processing-and-text-mining.html#cb530-2" tabindex="-1"></a>sentiments[<span class="sc">!</span>index,] <span class="sc">|&gt;</span> </span>
<span id="cb530-3"><a href="string-processing-and-text-mining.html#cb530-3" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb530-4"><a href="string-processing-and-text-mining.html#cb530-4" tabindex="-1"></a>  <span class="fu">aes</span>(sentimiento, total) <span class="sc">+</span></span>
<span id="cb530-5"><a href="string-processing-and-text-mining.html#cb530-5" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill =</span> sentimiento), <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb530-6"><a href="string-processing-and-text-mining.html#cb530-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb530-7"><a href="string-processing-and-text-mining.html#cb530-7" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb530-8"><a href="string-processing-and-text-mining.html#cb530-8" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Total&quot;</span>) <span class="sc">+</span></span>
<span id="cb530-9"><a href="string-processing-and-text-mining.html#cb530-9" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Emotions in the Tweets of Rosa María Palacios&quot;</span>)</span>
<span id="cb530-10"><a href="string-processing-and-text-mining.html#cb530-10" tabindex="-1"></a></span>
<span id="cb530-11"><a href="string-processing-and-text-mining.html#cb530-11" tabindex="-1"></a><span class="co"># Visualization of whether they are positive or negative sentiments:</span></span>
<span id="cb530-12"><a href="string-processing-and-text-mining.html#cb530-12" tabindex="-1"></a>sentiments[index,] <span class="sc">|&gt;</span> </span>
<span id="cb530-13"><a href="string-processing-and-text-mining.html#cb530-13" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb530-14"><a href="string-processing-and-text-mining.html#cb530-14" tabindex="-1"></a>  <span class="fu">aes</span>(sentimiento, total) <span class="sc">+</span></span>
<span id="cb530-15"><a href="string-processing-and-text-mining.html#cb530-15" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill =</span> sentimiento), <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb530-16"><a href="string-processing-and-text-mining.html#cb530-16" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb530-17"><a href="string-processing-and-text-mining.html#cb530-17" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Total&quot;</span>) <span class="sc">+</span></span>
<span id="cb530-18"><a href="string-processing-and-text-mining.html#cb530-18" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Sentiments of the Tweets of Rosa María Palacios&quot;</span>)</span></code></pre></div>
<p><img src="Data-Science-with-R_files/figure-html/unnamed-chunk-679-1.png" alt="" width="80%" style="display: block; margin: auto;" /><img src="Data-Science-with-R_files/figure-html/unnamed-chunk-679-2.png" alt="" width="80%" style="display: block; margin: auto;" /></p>
<p>This technique is very useful to us as a starting point for future analyses on the tonality of some determined text.</p>
</div>
<div id="exercises-17" class="section level2 hasAnchor" number="11.7">
<h2><span class="header-section-number">11.7</span> Exercises<a href="string-processing-and-text-mining.html#exercises-17" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For these exercises we will use more books from Project Gutenberg. However, we will extract the text with an R library, the <code>gutenbergr</code> library.</p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="string-processing-and-text-mining.html#cb531-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;gutenbergr&quot;</span>)</span>
<span id="cb531-2"><a href="string-processing-and-text-mining.html#cb531-2" tabindex="-1"></a></span>
<span id="cb531-3"><a href="string-processing-and-text-mining.html#cb531-3" tabindex="-1"></a><span class="fu">library</span>(gutenbergr)</span>
<span id="cb531-4"><a href="string-processing-and-text-mining.html#cb531-4" tabindex="-1"></a></span>
<span id="cb531-5"><a href="string-processing-and-text-mining.html#cb531-5" tabindex="-1"></a><span class="co"># Tibble: list of books in Gutenberg.org</span></span>
<span id="cb531-6"><a href="string-processing-and-text-mining.html#cb531-6" tabindex="-1"></a>gutenberg_metadata</span>
<span id="cb531-7"><a href="string-processing-and-text-mining.html#cb531-7" tabindex="-1"></a></span>
<span id="cb531-8"><a href="string-processing-and-text-mining.html#cb531-8" tabindex="-1"></a><span class="co"># List of books in Spanish</span></span>
<span id="cb531-9"><a href="string-processing-and-text-mining.html#cb531-9" tabindex="-1"></a><span class="fu">gutenberg_works</span>(<span class="at">languages =</span> <span class="st">&quot;es&quot;</span>)</span></code></pre></div>
<ol start="107" style="list-style-type: decimal">
<li>The <code>gutenberg_download(id)</code> function downloads the text in a tibble type object with one row for each line. Download the book “El ingenioso hidalgo don Quijote de la Mancha” to the <code>descarga</code> object. Store the <code>text</code> column in the <code>obra</code> object and report the first 50 lines of the object.</li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="string-processing-and-text-mining.html#cb532-1" tabindex="-1"></a>descarga <span class="ot">&lt;-</span> <span class="fu">gutenberg_download</span>(<span class="dv">2000</span>)</span>
<span id="cb532-2"><a href="string-processing-and-text-mining.html#cb532-2" tabindex="-1"></a></span>
<span id="cb532-3"><a href="string-processing-and-text-mining.html#cb532-3" tabindex="-1"></a>obra <span class="ot">&lt;-</span> descarga<span class="sc">$</span>text</span>
<span id="cb532-4"><a href="string-processing-and-text-mining.html#cb532-4" tabindex="-1"></a></span>
<span id="cb532-5"><a href="string-processing-and-text-mining.html#cb532-5" tabindex="-1"></a>obra[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>]</span></code></pre></div>
</details>
<ol start="108" style="list-style-type: decimal">
<li>Due to the number of lines in this work, take a random sample of 1,000 lines and store it in the <code>muestra</code> object. Remove words, punctuation marks, line breaks and other elements learned during this chapter. Store this transformation in the <code>muestra_limpia</code> object.</li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="string-processing-and-text-mining.html#cb533-1" tabindex="-1"></a></span>
<span id="cb533-2"><a href="string-processing-and-text-mining.html#cb533-2" tabindex="-1"></a>muestra <span class="ot">&lt;-</span> <span class="fu">sample</span>(obra, <span class="dv">1000</span>)</span>
<span id="cb533-3"><a href="string-processing-and-text-mining.html#cb533-3" tabindex="-1"></a></span>
<span id="cb533-4"><a href="string-processing-and-text-mining.html#cb533-4" tabindex="-1"></a>muestra_limpia <span class="ot">&lt;-</span> muestra <span class="sc">|&gt;</span> </span>
<span id="cb533-5"><a href="string-processing-and-text-mining.html#cb533-5" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">&quot;</span><span class="sc">\xe1</span><span class="st">&quot;</span>, <span class="st">&quot;a&quot;</span>) <span class="sc">|&gt;</span> <span class="co"># We remove accents</span></span>
<span id="cb533-6"><a href="string-processing-and-text-mining.html#cb533-6" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">&quot;</span><span class="sc">\xe9</span><span class="st">&quot;</span>, <span class="st">&quot;e&quot;</span>) <span class="sc">|&gt;</span> <span class="co"># We remove accents</span></span>
<span id="cb533-7"><a href="string-processing-and-text-mining.html#cb533-7" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">&quot;</span><span class="sc">\xed</span><span class="st">&quot;</span>, <span class="st">&quot;i&quot;</span>) <span class="sc">|&gt;</span> <span class="co"># We remove accents</span></span>
<span id="cb533-8"><a href="string-processing-and-text-mining.html#cb533-8" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">&quot;</span><span class="sc">\xf3</span><span class="st">&quot;</span>, <span class="st">&quot;o&quot;</span>) <span class="sc">|&gt;</span> <span class="co"># We remove accents</span></span>
<span id="cb533-9"><a href="string-processing-and-text-mining.html#cb533-9" tabindex="-1"></a>  <span class="fu">removePunctuation</span>() <span class="sc">|&gt;</span> </span>
<span id="cb533-10"><a href="string-processing-and-text-mining.html#cb533-10" tabindex="-1"></a>  <span class="fu">str_to_lower</span>() <span class="sc">|&gt;</span> </span>
<span id="cb533-11"><a href="string-processing-and-text-mining.html#cb533-11" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(<span class="st">&quot;[[:cntrl:]]&quot;</span>, <span class="st">&quot; &quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb533-12"><a href="string-processing-and-text-mining.html#cb533-12" tabindex="-1"></a>  <span class="fu">removeWords</span>(<span class="at">words =</span> <span class="fu">stopwords</span>(<span class="st">&quot;spanish&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb533-13"><a href="string-processing-and-text-mining.html#cb533-13" tabindex="-1"></a>  <span class="fu">removeWords</span>(<span class="at">words =</span> <span class="fu">c</span>(<span class="st">&quot;usted&quot;</span>, <span class="st">&quot;pues&quot;</span>, <span class="st">&quot;tal&quot;</span>, <span class="st">&quot;tan&quot;</span>,</span>
<span id="cb533-14"><a href="string-processing-and-text-mining.html#cb533-14" tabindex="-1"></a>                                      <span class="st">&quot;así&quot;</span>, <span class="st">&quot;dijo&quot;</span>, <span class="st">&quot;cómo&quot;</span>, <span class="st">&quot;sino&quot;</span>, </span>
<span id="cb533-15"><a href="string-processing-and-text-mining.html#cb533-15" tabindex="-1"></a>                                      <span class="st">&quot;entonces&quot;</span>, <span class="st">&quot;aunque&quot;</span>, <span class="st">&quot;que&quot;</span>))</span></code></pre></div>
</details>
<ol start="109" style="list-style-type: decimal">
<li>Create a word map from the <code>muestra_limpia</code> object.</li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="string-processing-and-text-mining.html#cb534-1" tabindex="-1"></a></span>
<span id="cb534-2"><a href="string-processing-and-text-mining.html#cb534-2" tabindex="-1"></a>coleccion <span class="ot">&lt;-</span> muestra_limpia <span class="sc">|&gt;</span> </span>
<span id="cb534-3"><a href="string-processing-and-text-mining.html#cb534-3" tabindex="-1"></a>  <span class="fu">VectorSource</span>() <span class="sc">|&gt;</span></span>
<span id="cb534-4"><a href="string-processing-and-text-mining.html#cb534-4" tabindex="-1"></a>  <span class="fu">Corpus</span>()</span>
<span id="cb534-5"><a href="string-processing-and-text-mining.html#cb534-5" tabindex="-1"></a></span>
<span id="cb534-6"><a href="string-processing-and-text-mining.html#cb534-6" tabindex="-1"></a><span class="fu">wordcloud</span>(coleccion, </span>
<span id="cb534-7"><a href="string-processing-and-text-mining.html#cb534-7" tabindex="-1"></a>          <span class="at">min.freq =</span> <span class="dv">5</span>,</span>
<span id="cb534-8"><a href="string-processing-and-text-mining.html#cb534-8" tabindex="-1"></a>          <span class="at">max.words =</span> <span class="dv">80</span>, </span>
<span id="cb534-9"><a href="string-processing-and-text-mining.html#cb534-9" tabindex="-1"></a>          <span class="at">random.order =</span> <span class="cn">FALSE</span>, </span>
<span id="cb534-10"><a href="string-processing-and-text-mining.html#cb534-10" tabindex="-1"></a>          <span class="at">colors =</span> <span class="fu">brewer.pal</span>(<span class="at">name =</span> <span class="st">&quot;Dark2&quot;</span>, <span class="at">n =</span> <span class="dv">8</span>)</span>
<span id="cb534-11"><a href="string-processing-and-text-mining.html#cb534-11" tabindex="-1"></a>          )</span></code></pre></div>
</details>
<ol start="110" style="list-style-type: decimal">
<li>Perform a sentiment analysis of the sample obtained.</li>
</ol>
<details>
<summary type="button">
Solution
</summary>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="string-processing-and-text-mining.html#cb535-1" tabindex="-1"></a>resultado <span class="ot">&lt;-</span> <span class="fu">get_nrc_sentiment</span>(muestra_limpia, <span class="at">language =</span> <span class="st">&quot;spanish&quot;</span>)</span>
<span id="cb535-2"><a href="string-processing-and-text-mining.html#cb535-2" tabindex="-1"></a></span>
<span id="cb535-3"><a href="string-processing-and-text-mining.html#cb535-3" tabindex="-1"></a>sentimientos <span class="ot">&lt;-</span> resultado <span class="sc">|&gt;</span> </span>
<span id="cb535-4"><a href="string-processing-and-text-mining.html#cb535-4" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;sentimiento&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;cantidad&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb535-5"><a href="string-processing-and-text-mining.html#cb535-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sentimiento =</span> <span class="fu">trad_emociones</span>(sentimiento)) <span class="sc">|&gt;</span> </span>
<span id="cb535-6"><a href="string-processing-and-text-mining.html#cb535-6" tabindex="-1"></a>  <span class="fu">group_by</span>(sentimiento) <span class="sc">|&gt;</span> </span>
<span id="cb535-7"><a href="string-processing-and-text-mining.html#cb535-7" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(cantidad))</span>
<span id="cb535-8"><a href="string-processing-and-text-mining.html#cb535-8" tabindex="-1"></a></span>
<span id="cb535-9"><a href="string-processing-and-text-mining.html#cb535-9" tabindex="-1"></a>index <span class="ot">&lt;-</span> sentimientos<span class="sc">$</span>sentimiento <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Positivo&quot;</span>, <span class="st">&quot;Negativo&quot;</span>) </span>
<span id="cb535-10"><a href="string-processing-and-text-mining.html#cb535-10" tabindex="-1"></a></span>
<span id="cb535-11"><a href="string-processing-and-text-mining.html#cb535-11" tabindex="-1"></a><span class="co"># Visualization of emotions</span></span>
<span id="cb535-12"><a href="string-processing-and-text-mining.html#cb535-12" tabindex="-1"></a>sentimientos[<span class="sc">!</span>index,] <span class="sc">|&gt;</span> </span>
<span id="cb535-13"><a href="string-processing-and-text-mining.html#cb535-13" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb535-14"><a href="string-processing-and-text-mining.html#cb535-14" tabindex="-1"></a>  <span class="fu">aes</span>(sentimiento, total) <span class="sc">+</span></span>
<span id="cb535-15"><a href="string-processing-and-text-mining.html#cb535-15" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill =</span> sentimiento), <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb535-16"><a href="string-processing-and-text-mining.html#cb535-16" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb535-17"><a href="string-processing-and-text-mining.html#cb535-17" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb535-18"><a href="string-processing-and-text-mining.html#cb535-18" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Total&quot;</span>) <span class="sc">+</span></span>
<span id="cb535-19"><a href="string-processing-and-text-mining.html#cb535-19" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Emociones en El Quijote&quot;</span>)</span>
<span id="cb535-20"><a href="string-processing-and-text-mining.html#cb535-20" tabindex="-1"></a></span>
<span id="cb535-21"><a href="string-processing-and-text-mining.html#cb535-21" tabindex="-1"></a><span class="co"># Visualization of whether they are positive or negative sentiments:</span></span>
<span id="cb535-22"><a href="string-processing-and-text-mining.html#cb535-22" tabindex="-1"></a>sentimientos[index,] <span class="sc">|&gt;</span> </span>
<span id="cb535-23"><a href="string-processing-and-text-mining.html#cb535-23" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb535-24"><a href="string-processing-and-text-mining.html#cb535-24" tabindex="-1"></a>  <span class="fu">aes</span>(sentimiento, total) <span class="sc">+</span></span>
<span id="cb535-25"><a href="string-processing-and-text-mining.html#cb535-25" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill =</span> sentimiento), <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb535-26"><a href="string-processing-and-text-mining.html#cb535-26" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb535-27"><a href="string-processing-and-text-mining.html#cb535-27" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Total&quot;</span>) <span class="sc">+</span></span>
<span id="cb535-28"><a href="string-processing-and-text-mining.html#cb535-28" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Sentimientos en El Quijote&quot;</span>)</span></code></pre></div>
</details>

</div>
</div>



<div class="footnotes">
<hr />
<ol start="10">
<li id="fn10"><p><a href="https://stringr.tidyverse.org/articles/regular-expressions.html" class="uri">https://stringr.tidyverse.org/articles/regular-expressions.html</a><a href="string-processing-and-text-mining.html#fnref10" class="footnote-back">↩︎</a></p></li>
<li id="fn11"><p>www.gutenberg.org<a href="string-processing-and-text-mining.html#fnref11" class="footnote-back">↩︎</a></p></li>
<li id="fn12"><p><a href="https://twitter.com/rmapalacios" class="uri">https://twitter.com/rmapalacios</a><a href="string-processing-and-text-mining.html#fnref12" class="footnote-back">↩︎</a></p></li>
<li id="fn13"><p><a href="https://saifmohammad.com/WebPages/NRC-Emotion-Lexicon.htm" class="uri">https://saifmohammad.com/WebPages/NRC-Emotion-Lexicon.htm</a><a href="string-processing-and-text-mining.html#fnref13" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-import-and-consolidation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="introduction-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": true,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": null
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": null,
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
